#+AUTHOR:Melvin Wevers
#+TITLE: Markov Chain Monte Carlo
#+PROPERTY: header-args :session :results value :cache no :exports both

*Markov Chain Monte Carlo*: the estimation of posterior probability distributions using a
 stochastic process (MCMC)

Here we will produce samples from the joint posterior of a model without maximizing
anything. Sample directly from the posteior without assuming a Guassian, or any other,
shape for it. 

Cost: estimation takes much longer, and more work specifying the model. 
Benefit: not having to assume multivariate normality & ability to directly estimate models
(GLM and Multi-level). 

* 8.1. Good King Markov and His island Kingdom

#+BEGIN_SRC R
num_weeks <- 1e5
positions <- rep(0, num_weeks)
current <- 10

for (i in 1:num_weeks) {
                                        # record current position
    positions[i] <- current

                                        #flip coin to generate proposal
    proposal <- current + sample(c(-1, 1), size=1)

                                        # make sure he loops around the archipelago
    if (proposal < 1) proposal <- 10
    if (proposal > 10) proposal <- 1

                                        # move?
    prob_move <- proposal / current
    current <- ifelse(runif(1) < prob_move, proposal, currnet)
}

#+END_SRC

Use the ratio of the proposal island's population to the current island's population as
the probability of moving. 

* 8.2. Markov Chain Monte Carlo
*Metropolis Algorithm* > real goal is to draw samples from an unknown and usually complex
 target distributions, like a posterior probability distribution. 

- The 'islands' are parameter values, and they need not be discrete, but an take on a
  continuous range of values
- The 'population sizes' are the posterior probabilities at each parameter value
- The 'weeks' are the samples taken from the joint posterior of the parameters in the
  model. 

The way we choose our parameter values at each step is symmetric---equal chance of
proposing from A to B and from B to A, will give us a collection of samples from the joint
posterior. 

** 8.2.1. Gibbs sampling
Metropolis-Hastings also allows for assymetric proposals. 
This makes it easier to deal with parameters (sd) that have boundaries at zero. 
Better reason, it allows use to generate proposals that explore the posterior distribution
more efficiently. 

One of these techniques is *Gibbs Sampling*. 
Limitations: Conjugate priors are needed, maybe you don't want to use those. 2. With large
numbers of parameters Gibbs becomes very inefficient. 

** 8.2.2. Hamiltonian Monte Carlo
Less random way often more efficient, but this requires more thought. 
The objective is to sweep across the the log-posterior (bowl) adjusting speed in
proportion to how high up we are.

HMC requires continuous parameters
STAN automates much of the model tuning for HMC. 

* 8.3. Easy HMC: map2stan

#+BEGIN_SRC R
library(rethinking)
data(rugged)
d <- rugged
d$log_gdp <- log(d$rgdppc_2000)
dd <- d[complete.cases(d$rgdppc_2000), ]

#+END_SRC

#+RESULTS:
| AGO |  24 | Angola                                               | 0.858 | 0.714 |  2.274 | 0.228 |  4.906 |  124670 | -12.299 |   17.551 | 26.676 |  0.425 | 44.346 | 0.428 |  13.1587 |  47756 |  1794.729 |  1051.822 |  1073.036 |   765.215 |  1106.763 | -1.567 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 |   3610000 | 5.669  | 6.981  | 4.926 | 3.872 |  1223208 |      2 | 7.49260931459416 |
| ALB |   8 | Albania                                              | 3.427 | 1.597 | 10.451 | 1.006 | 62.133 |    2740 |  41.143 |    20.07 | 68.088 |      0 |      0 | 0.048 |  94.6919 |      0 |  3703.113 |  1001.339 |  2289.472 |   2741.42 |  1931.784 |  -0.82 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   200000 |    100 | 8.21692909624602 |
| ARE | 784 | United Arab Emirates                                 | 0.769 | 0.316 |  2.112 | 0.191 |  6.142 |    8360 |  23.913 |   54.331 |      0 |  77.28 |      0 | 0.065 |  75.7464 |      0 |  20604.46 | 15797.558 | 25465.002 | 17567.883 | 20119.992 |  0.913 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    19200 |      0 | 9.93326283619825 |
| ARG |  32 | Argentina                                            | 0.775 |  0.22 |  2.268 | 0.226 |  9.407 |  273669 | -35.396 |   -65.17 | 35.678 |      0 |      0 | 0.352 |  13.0167 |      0 |  12173.68 |  4986.725 |  8122.497 |  8543.558 |   6926.81 |  0.033 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   276632 | 89.889 | 9.40703152318187 |
| ARM |  51 | Armenia                                              | 2.688 | 0.934 |  8.178 | 0.799 | 50.556 |    2820 |  40.294 |   44.938 | 30.148 |      0 |      0 | 0.348 |        0 |      0 |  2421.985 |       nil |       nil |  4565.035 |       nil | -0.453 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   105743 |    0.5 | 7.79234273086512 |
| ATG |  28 | Antigua and Barbuda                                  | 0.006 | 0.003 |  0.012 | 0.003 |      0 |      44 |  17.271 |    -61.8 |    100 |      0 |    100 | 0.001 |      100 |      0 |  10022.03 |       nil |       nil |       nil |       nil |   0.99 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |      747 |    nil | 9.21254094892968 |
| AUS |  36 | Australia                                            | 0.143 | 0.183 |  0.405 | 0.045 |  0.685 |  768230 | -25.733 |  134.487 | 14.248 | 10.889 |  14.68 | 0.336 |  20.9399 | 264154 |  25417.44 |  7411.577 |  13169.83 | 21605.334 | 13184.232 |  1.773 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   200000 | 89.954 | 10.1431908315682 |
| AUT |  40 | Austria                                              | 3.513 | 1.152 | 11.095 | 1.008 | 54.307 |    8245 |  47.589 |    14.14 | 55.098 |      0 |      0 | 0.242 |  2.25634 |      0 |  28987.84 |  3706.075 | 11646.408 | 20691.416 | 11601.704 |  1.853 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1250000 |   98.4 | 10.2746317106886 |
| AZE |  31 | Azerbaijan                                           | 1.672 | 0.534 |   5.08 |  0.49 | 27.713 |  8260.5 |  40.288 |   47.528 | 60.957 |      0 |      0 | 0.584 |        0 |      0 |  2570.944 |       nil |       nil |   2538.14 |       nil | -1.007 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   226250 |      4 | 7.85202842562066 |
| BDI | 108 | Burundi                                              |  1.78 | 1.586 |  4.721 |   0.5 | 27.519 |    2568 |  -3.365 |   29.887 | 24.049 |      0 | 75.354 | 0.906 |        0 |      0 |   621.652 |   360.142 |   534.858 |   495.977 |   530.763 |  -1.25 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 |    86.997 | 10.626 | 2.57   | 3.719 | 2.215 |   239693 |      0 |  6.4323804506382 |
| BEL |  56 | Belgium                                              | 0.388 | 0.261 |  1.239 | 0.109 |  0.178 |    3023 |  50.642 |    4.661 | 48.967 |      0 |      0 | 0.113 |  45.9637 |      0 |  27302.99 |  5462.205 | 12440.785 | 20656.459 | 12223.306 |  1.413 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   773466 |     98 | 10.2147514989853 |
| BEN | 204 | Benin                                                | 0.141 | 0.099 |  0.377 | 0.045 |  0.014 |   11062 |    9.65 |    2.339 | 74.973 |      0 | 97.489 | 0.367 |  10.2806 |      0 |   959.222 |  1083.628 |   969.318 |  1282.898 |  1082.474 |  -0.23 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |    457000 | 5.121  | 9.234  | 2.835 | 3.902 |   348867 |      0 |  6.8661225392301 |
| BFA | 854 | Burkina Faso                                         | 0.236 | 0.214 |  0.638 | 0.066 |  0.051 |   27360 |  12.274 |   -1.747 | 56.909 |      0 |  49.82 | 0.735 |        0 |      0 |   998.416 |   474.313 |   669.515 |    921.09 |   719.511 |  -0.52 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |    167000 | 4.775  | 9.299  | 2.764 | 4.239 |   692976 |      0 | 6.90617002312778 |
| BGD |  50 | Bangladesh                                           | 0.186 | 0.065 |  0.502 | 0.053 |  1.817 |   13017 |  23.848 |    90.27 | 41.883 |      0 | 75.038 | 0.071 |  71.3844 |      0 |  1479.086 |   539.544 |   528.607 |     861.7 |   599.122 | -0.807 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  9103705 |      0 |  7.2991796084172 |
| BGR | 100 | Bulgaria                                             | 1.479 | 0.711 |  4.498 | 0.427 | 20.196 |   11063 |  42.765 |   25.239 | 82.101 |      0 |      0 | 0.149 |  31.4395 |      0 |  5979.171 |  1651.031 |  5830.809 |  5349.921 |  4567.501 |  -0.16 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   894427 |  98.85 | 8.69603720857228 |
| BHR |  48 | Bahrain                                              | 0.231 | 0.163 |  0.627 | 0.063 |      0 |      71 |  26.025 |   50.565 |      0 |      0 |      0 | 0.002 |      100 |      0 |  15928.09 |  2104.454 |  3922.257 |  5058.844 |  3776.897 |  0.457 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    31897 |      0 | 9.67583949615499 |
| BHS |  44 | Bahamas                                              | 0.055 |   0.1 |  0.144 | 0.017 |      0 |    1001 |  24.255 |   -76.61 | 13.924 |      0 |    100 | 0.003 |      100 |      0 |   16977.2 |       nil |       nil |       nil |       nil |  1.063 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |     1276 |    nil | 9.73962654638564 |
| BIH |  70 | Bosnia and Herzegovina                               | 2.311 | 1.288 |  7.075 | 0.665 | 40.253 |    5120 |  44.175 |   17.784 | 76.888 |      0 |      0 | 0.117 |  42.7623 |      0 |  5294.975 |       nil |       nil |  5572.282 |       nil |  -0.44 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   366341 |    100 | 8.57451353658904 |
| BLR | 112 | Belarus                                              | 0.164 | 0.208 |   0.54 | 0.046 |      0 |   20748 |  53.542 |   28.054 | 50.611 |      0 |      0 | 0.598 |        0 |      0 |   4802.11 |       nil |       nil |  6264.544 |       nil |   -0.9 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   487364 |    100 | 8.47681068364087 |
| BLZ |  84 | Belize                                               | 0.607 | 0.226 |  1.616 | 0.174 |  6.568 |    2281 |  17.205 |  -88.687 |  35.49 |      0 |    100 | 0.026 |      100 |      0 |  5869.233 |       nil |       nil |       nil |       nil |  0.257 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |     5326 |  39.91 | 8.67747923988958 |
| BOL |  68 | Bolivia                                              | 0.853 | 0.911 |  2.343 | 0.258 |  13.57 |  108438 |  -16.71 |  -64.662 | 31.807 |      0 | 64.878 | 0.655 |        0 |      0 |  2398.855 |  1919.359 |  2515.915 |  2574.755 |  2153.277 | -0.327 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   829897 | 26.732 | 7.78274681916224 |
| BRA |  76 | Brazil                                               |  0.24 |  0.25 |  0.654 | 0.076 |  0.558 |  845942 | -10.775 |  -53.085 | 18.783 |      0 | 88.567 | 0.642 |  9.68309 |  12159 |  7300.865 |  1671.723 |  4189.509 |  5556.415 |  3761.573 | -0.257 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   931150 |  74.43 | 8.89574811326741 |
| BRB |  52 | Barbados                                             | 0.963 | 0.695 |  2.581 | 0.289 |  3.823 |      43 |  13.167 |  -59.555 | 30.588 |      0 |    100 | 0.002 |      100 |      0 | 15290.579 |       nil |       nil |       nil |       nil |   0.76 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |     3403 |    nil | 9.63499216609365 |
| BWA |  72 | Botswana                                             | 0.181 | 0.478 |  0.488 | 0.048 |  0.301 |   56673 | -22.189 |   23.814 | 15.249 |  1.455 |      0 | 0.764 |        0 | 208687 |  7702.508 |   348.507 |   1223.49 |  4268.641 |  1631.317 |   0.58 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |         0 | 5.686  | 5.765  | 5.857 | 4.3   |    80312 |    1.5 | 8.94930126909411 |
| CAF | 140 | Central African Republic                             | 0.197 | 0.257 |  0.528 |  0.06 |  0.033 |   62300 |   6.574 |   20.487 | 10.967 |      0 | 97.382 | 1.081 |        0 |  10802 |  1148.051 |   771.577 |   781.799 |   575.543 |   757.838 |  -1.07 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  2009.941 | 5.642  | 8.772  | 2.84  | 2.293 |   387580 |    0.6 | 7.04582100097985 |
| CAN | 124 | Canada                                               | 0.775 |  0.37 |  2.695 |  0.23 |  9.122 |  909351 |  61.495 |  -98.334 | 16.794 |      0 |      0 |  1.43 |   4.4433 |   5166 |  27289.26 |   7291.48 | 14316.263 | 22360.119 | 14002.496 |  1.757 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   174110 |  85.33 |  10.214248497175 |
| CHE | 756 | Switzerland                                          | 4.761 |  1.45 | 14.999 | 1.388 |  66.06 |    4000 |  46.806 |    8.226 | 39.341 |      0 |      0 | 0.278 |        0 |      0 |  30161.29 |  9063.698 | 17224.018 | 22474.859 | 16696.838 |  2.023 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   600000 |   98.5 | 10.3143145930905 |
| CHL | 152 | Chile                                                | 2.481 | 0.677 |  7.365 | 0.731 | 38.199 |   74880 | -37.937 |  -71.384 | 22.158 | 15.489 |      0 | 0.074 |  68.3825 |      0 |  9115.475 |  3669.742 |  4273.292 | 10310.834 |  5636.808 |  1.183 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   553265 |  59.19 | 9.11772879765844 |
| CHN | 156 | China                                                | 1.878 | 0.708 |  5.493 | 0.537 | 28.648 |  932748 |  36.564 |  103.836 | 22.836 |   5.77 |  0.301 | 0.987 |  5.76513 |   4410 |  3928.315 |   448.022 |   871.181 |  3420.866 |  1268.328 | -0.357 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   | 80943756 |      0 | 8.27596585974172 |
| CIV | 384 | Cote d'Ivoire                                        | 0.224 | 0.159 |  0.594 | 0.069 |  0.493 |   31800 |   7.623 |   -5.554 | 26.151 |      0 |    100 | 0.284 |   16.359 |   3239 |  1575.628 |  1040.878 |  1800.013 |  1352.019 |   1536.27 |  -0.86 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 52645.949 | 4.186  | 9.457  | 3.353 | 4.794 |   435857 |      0 | 7.36240920194672 |
| CMR | 120 | Cameroon                                             | 0.515 | 0.545 |  1.374 | 0.157 |  4.031 |   46540 |   5.697 |   12.743 | 27.829 |      0 |  94.12 | 0.389 |  10.9018 |      0 |  1882.687 |   670.951 |  1051.615 |  1082.339 |  1036.539 | -1.287 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 66718.812 | 5.642  | 8.772  | 3.003 | 3.051 |  1317285 |      0 | 7.54045529072993 |
| COD | 180 | Democratic Republic of the Congo                     | 0.443 | 0.531 |  1.177 | 0.126 |  2.763 |  226705 |  -2.879 |   23.658 | 16.001 |      0 | 94.866 | 1.016 | 0.686405 |  87149 |   668.663 |   569.742 |   760.789 |    216.95 |   611.093 |  -2.05 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 |    767000 | 5.712  | 7.643  | 3.748 | 2.687 |  3593277 |   0.46 | 6.50528019628938 |
| COG | 178 | Congo                                                | 0.152 | 0.411 |  0.406 | 0.049 |  0.243 |   34150 |  -0.831 |   15.246 |  4.063 |      0 |    100 | 0.457 |  4.83001 |      0 |   957.403 |  1198.207 |  2191.133 |  2005.219 |  1914.573 | -1.413 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 94662.922 | 5.527  | 7.924  | 3.697 | 3.227 |   238219 |      0 | 6.86422441044003 |
| COL | 170 | Colombia                                             | 0.885 |  0.89 |  2.376 | 0.277 | 14.366 |  110950 |   3.838 |  -72.866 | 30.444 |      0 | 89.763 | 0.379 |  16.7275 |      0 |  6243.656 |  2152.841 |  3622.226 |  5095.796 |  3661.919 | -0.767 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   902880 |   45.6 | 8.73932118722848 |
| COM | 174 | Comoros                                              | 3.328 | 2.172 |  9.049 | 1.063 | 64.479 |   186.1 | -11.888 |   43.671 | 56.043 |      0 |    100 | 0.003 |      100 |      0 |  1770.218 |   560.305 |   804.062 |   580.913 |   730.933 |  -1.28 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |         0 | 10.131 | 1.754  | 4.846 | 2.61  |        0 |      0 | 7.47885798182564 |
| CPV | 132 | Cape Verde                                           | 2.367 | 1.399 |  6.502 | 0.759 | 40.048 |     403 |  15.942 |  -23.981 | 11.663 |      0 |      0 | 0.004 |      100 |      0 |  4859.108 |   449.648 |   524.742 |  1776.535 |   809.993 |   0.71 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 |         0 | 3.647  | 11.6   | 3.482 | 6.465 |        0 |   41.4 | 8.48861016095453 |
| CRI | 188 | Costa Rica                                           | 2.112 | 1.044 |  5.708 | 0.623 |  36.61 |    5106 |   9.969 |  -84.199 | 52.082 |      0 | 94.017 | 0.031 |      100 |      0 |  8621.291 |  1963.132 |  4396.007 |  6173.734 |  3955.164 |  0.637 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    74647 |  60.39 | 9.06199012042507 |
| CYP | 196 | Cyprus                                               | 2.718 | 0.909 |  7.867 | 0.706 | 44.072 |     924 |  35.049 |   33.235 | 26.866 |      0 |      0 | 0.012 |      100 |      0 |     20318 |       nil |       nil |       nil |       nil |  0.817 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   150000 |      1 | 9.91926247165149 |
| CZE | 203 | Czech Republic                                       | 0.884 | 0.578 |  2.845 | 0.252 |  4.154 |    7727 |  49.739 |   15.334 | 88.653 |      0 |      0 | 0.426 |        0 |      0 |  15373.23 |       nil |       nil |  9155.582 |       nil |  0.793 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1801067 |    100 | 9.64038296409646 |
| DEU | 276 | Germany                                              | 0.597 | 0.405 |  1.906 | 0.168 |  3.001 |   34877 |   51.11 |   10.392 | 61.338 |      0 |      0 | 0.246 |  19.7358 |      0 |  25481.43 |  3880.887 | 12040.607 | 18943.516 | 11932.706 |   1.71 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  6500000 |   97.6 | 10.1457052305603 |
| DJI | 262 | Djibouti                                             | 2.432 | 0.804 |  6.416 | 0.627 | 39.024 |    2318 |  11.735 |    42.58 |      0 |      0 |      0 | 0.038 |      100 |      0 |  1881.967 |  1499.582 |  2065.445 |  1102.543 |  1647.355 | -0.577 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |     4.176 | 14.408 | 2.682  | 2.351 | 0.064 |    34822 |    nil | 7.54007278545387 |
| DMA | 212 | Dominica                                             | 0.003 | 0.008 |  0.005 | 0.001 |      0 |      75 |  15.427 |  -61.356 | 36.405 |      0 |    100 | 0.003 |      100 |      0 |  5931.715 |       nil |       nil |       nil |       nil |  0.495 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |      824 |    nil | 8.68806865759927 |
| DNK | 208 | Denmark                                              | 0.189 | 0.191 |  0.611 | 0.054 |      0 |    4243 |  55.987 |   10.027 | 56.165 |      0 |      0 | 0.019 |      100 |      0 |  28750.61 |  6943.104 | 13621.125 | 22975.162 | 13991.603 |  1.837 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   600000 |   99.2 | 10.2664142633917 |
| DOM | 214 | Dominican Republic                                   | 1.641 | 0.519 |  4.495 | 0.484 | 26.179 |    4838 |  18.895 |  -70.493 | 39.479 |      0 | 87.817 | 0.029 |      100 |      0 |  6410.803 |  1026.788 |  2111.321 |  3649.014 |  1989.486 |  -0.52 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    39145 |     52 | 8.76573981507963 |
| DZA |  12 | Algeria                                              |  0.51 | 1.368 |  1.445 |  0.14 |  4.885 |  238174 |  28.168 |    2.647 |   9.59 | 23.277 |      0 | 0.752 |  4.17952 |      0 |   5417.91 |   1364.74 |  2521.953 |  2864.551 |  2389.185 | -1.153 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 61834.148 | 6.559  | 14.912 | 0.985 | 3.654 |  1588836 |      0 | 8.59746541121139 |
| ECU | 218 | Ecuador                                              | 1.278 | 0.766 |  3.446 | 0.405 |  20.09 |   27684 |  -1.434 |   -78.77 | 44.308 |      0 | 73.165 | 0.157 |  37.3544 |      0 |  3373.415 |  1862.933 |  3459.407 |  3203.386 |  3209.836 | -0.587 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   553265 | 31.976 | 8.12368086336647 |
| EGY | 818 | Egypt                                                | 0.723 | 0.274 |  2.001 | 0.186 |  5.764 |   99545 |  26.562 |   29.782 |  0.007 | 16.498 |      0 | 0.325 |  22.7899 |      0 |  3598.329 |   909.903 |  1420.783 |  2936.674 |   1711.68 |  -0.03 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 |  1491.701 | 16.393 | 4.667  | 0.43  | 1.113 |  4182558 |      0 | 8.18822485001884 |
| ERI | 232 | Eritrea                                              | 2.481 | 1.911 |  6.663 | 0.658 | 37.141 |   10100 |  15.365 |   38.848 | 20.146 |  1.764 |      0 | 0.104 |  56.1576 |      0 |   911.884 |       nil |       nil |       nil |       nil | -0.307 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |    133000 | 12.967 | 3.146  | 1.814 | 0.07  |   101512 |    1.9 | 6.81551278900216 |
| ESP | 724 | Spain                                                | 1.689 |  0.81 |  5.062 | 0.472 | 23.372 |   49900 |  40.231 |   -3.644 | 64.134 |      0 |      0 | 0.131 |  42.9055 |      0 |  21764.83 |   2188.97 |  8346.302 |  15621.72 |  7811.794 |  1.333 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  5500000 |  99.24 | 9.98805064325063 |
| EST | 233 | Estonia                                              | 0.123 | 0.188 |  0.414 | 0.035 |      0 |    4239 |  58.673 |   25.549 | 62.517 |      0 |      0 | 0.135 |  37.0373 |      0 |   9762.76 |       nil |       nil |  11710.01 |       nil |  0.527 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    69282 |    100 | 9.18633042631571 |
| ETH | 231 | Ethiopia                                             |  1.57 | 1.725 |  4.193 | 0.443 | 20.128 |   1e+05 |   8.622 |   39.636 | 46.128 |  1.008 | 29.455 | 0.466 |  2.26331 |      0 |   635.794 |       nil |       nil |       nil |       nil | -0.823 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |   1310000 | 12.589 | 2.706  | 2.543 | 0.51  |  1639589 |      0 | 6.45487461150232 |
| FIN | 246 | Finland                                              | 0.328 | 0.268 |  1.202 | 0.092 |  0.137 |   30459 |  64.481 |    26.24 |  2.097 |      0 |      0 | 0.324 |  8.79128 |      0 |  25553.88 |  4253.287 | 11441.303 | 19770.363 | 11059.542 |  1.897 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   100000 |    100 | 10.1485444432022 |
| FJI | 242 | Fiji                                                 | 1.396 | 0.582 |  3.723 | 0.421 | 14.011 |    1827 | -17.447 |  161.988 | 98.293 |      0 |    100 | 0.009 |      100 |      0 |  4949.898 |       nil |       nil |       nil |       nil | -0.093 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   139322 |    2.2 | 8.50712224928982 |
| FRA | 250 | France                                               | 1.098 | 0.496 |  3.406 | 0.313 |  12.07 |   55010 |   46.56 |    2.551 | 59.939 |      0 |      0 | 0.172 |  34.6184 |      0 |  25698.01 |  5271.312 | 13251.077 | 21025.375 | 12907.095 |  1.397 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   | 11000000 |   93.4 | 10.1541688359787 |
| GAB | 266 | Gabon                                                | 0.218 | 0.582 |  0.583 |  0.07 |  0.434 |   25767 |  -0.623 |   11.784 | 11.978 |      0 |    100 | 0.195 |  28.1246 |   5200 |  6118.662 |  3108.377 |  9405.868 |  3847.075 |  5359.929 | -0.553 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 27402.172 | 5.531  | 8.367  | 3.703 | 3.529 |   138320 |      1 | 8.71909872415293 |
| GBR | 826 | United Kingdom of Great Britain and Northern Ireland | 0.568 |  0.21 |  1.878 | 0.175 |  3.643 |   24269 |   54.15 |   -2.901 | 48.239 |      0 |      0 | 0.034 |  96.3607 |      0 |  26332.05 |  6939.374 | 11847.087 | 20352.869 | 12332.872 |  1.783 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  3306643 |   94.6 | 10.1785421074163 |
| GEO | 268 | Georgia                                              | 3.659 | 0.859 | 11.258 | 1.067 |  59.17 |    6949 |  42.179 |   43.513 | 34.021 |      0 |      0 | 0.181 |  33.1835 |      0 |   1880.45 |       nil |       nil |  3243.627 |       nil | -1.033 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   275547 |      3 | 7.53926638888368 |
| GHA | 288 | Ghana                                                | 0.228 |  0.25 |  0.601 | 0.071 |  0.371 |   22754 |   7.963 |   -1.208 | 65.738 |      0 |    100 | 0.283 |  19.3048 |  13275 |  1892.808 |  1121.794 |  1246.881 |  1269.883 |  1217.556 | -0.297 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |   1610000 | 4.773  | 9.3    | 3.174 | 4.332 |   912300 |      0 | 7.54581671975788 |
| GIN | 324 | Guinea                                               |  0.74 |  1.03 |  1.969 | 0.213 |  3.952 |   24572 |  10.435 |  -10.939 | 17.761 |      0 |    100 | 0.263 |  14.9423 |   4864 |  1975.794 |   303.321 |   512.136 |   571.719 |   469.724 |  -1.32 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |    350000 | 3.72   | 10.269 | 3.245 | 5.259 |   455699 |      0 | 7.58872562186115 |
| GMB | 270 | Gambia                                               | 0.353 | 0.384 |  0.915 | 0.091 |      0 |    1000 |  13.447 |  -15.388 | 81.699 |      0 | 89.355 | 0.053 |  77.3706 |      0 |  1728.198 |   607.365 |  1049.606 |   894.813 |   866.362 |    0.1 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 21730.895 | 3.889  | 10.793 | 3.172 | 5.638 |    51104 |    0.5 | 7.45483452613317 |
| GNB | 624 | Guinea-Bissau                                        | 0.491 | 0.534 |  1.302 | 0.123 |  0.098 |    2812 |  12.013 |  -14.987 | 43.253 |      0 |    100 | 0.045 |  87.3195 |      0 |   782.477 |   289.153 |   925.067 |   680.606 |   707.146 |  -1.65 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 |    181000 | 3.796  | 10.631 | 3.285 | 5.633 |    87833 |      3 | 6.66246452901108 |
| GNQ | 226 | Equatorial Guinea                                    | 0.559 | 1.405 |  1.449 | 0.177 |   5.54 |    2805 |   1.703 |   10.335 |  6.829 |      0 |    100 | 0.069 |  69.3531 |      0 |  15189.54 |   539.763 |  1294.001 |  7973.103 |   1623.25 | -1.263 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |      10.5 | 5.577  | 8.556  | 3.462 | 3.515 |    66516 |   5.75 |  9.6283623120503 |
| GRC | 300 | Greece                                               | 3.103 | 1.295 |  9.166 | 0.867 | 52.841 |   12890 |  39.043 |   22.989 | 48.588 |      0 |      0 | 0.029 |  96.2131 |      0 |  17391.74 |  1915.007 |  7721.514 | 12110.869 |  6959.675 |   0.81 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1118034 |    100 | 9.76375065984722 |
| GRD | 308 | Grenada                                              | 2.088 | 1.538 |  5.655 | 0.606 | 39.913 |      34 |  12.157 |  -61.654 | 67.646 |      0 |    100 | 0.001 |      100 |      0 |  7536.395 |       nil |       nil |       nil |       nil |   0.27 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |     1237 |    nil | 8.92749922995689 |
| GTM | 320 | Guatemala                                            | 1.807 | 1.369 |  4.893 | 0.538 |  30.85 |   10843 |  15.697 |  -90.356 | 58.058 |      0 | 78.376 | 0.099 |  48.2159 |      0 |  3974.407 |  2084.894 |  3683.875 |  4096.941 |  3228.048 | -0.897 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   243109 | 21.965 |  8.2876308335697 |
| GUY | 328 | Guyana                                               | 0.273 | 0.052 |  0.744 | 0.089 |   0.36 |   19685 |   4.794 |  -58.976 | 19.594 |      0 |    100 | 0.215 |   28.642 |   1023 |  4072.166 |       nil |       nil |       nil |       nil |  -0.23 | 0 | 0 | 0 | 0 | 0 | 1 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |      nil |    1.3 | 8.31193032360769 |
| HKG | 344 | Hong Kong Special Administrative Region of China     | 2.501 | 1.558 |  6.692 | 0.698 | 51.197 |     110 |  22.381 |  114.134 | 96.076 |      0 |      0 | 0.002 |      100 |      0 |  25795.83 |  2218.149 |  6990.537 | 23328.385 |  9882.841 |  1.037 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    42611 |      0 | 10.1579681299395 |
| HND | 340 | Honduras                                             |  2.15 | 1.207 |  5.824 | 0.631 | 39.971 |   11189 |  14.822 |    -86.6 | 55.945 |      0 | 94.636 | 0.077 |  66.5159 |      0 |  2506.231 |  1313.356 |  1731.909 |  1911.571 |  1690.379 | -0.837 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   114924 |     46 | 7.82653530997876 |
| HRV | 191 | Croatia                                              | 1.267 | 0.678 |  3.842 | 0.366 | 17.588 |    5592 |  45.026 |   16.419 | 48.395 |      0 |      0 | 0.113 |  51.0571 |      0 |  9545.475 |       nil |       nil |  6438.607 |       nil | -0.203 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   530014 |  99.55 | 9.16382249919614 |
| HTI | 332 | Haiti                                                | 2.362 | 1.318 |  6.448 | 0.697 | 42.462 |    2756 |  18.936 |  -72.686 |  42.05 |      0 |    100 | 0.019 |      100 |      0 |  1798.406 |   1050.62 |  1034.517 |   796.162 |  1007.399 | -1.463 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    51954 |    2.5 | 7.49465599599274 |
| HUN | 348 | Hungary                                              | 0.346 | 0.289 |   1.09 | 0.098 |  0.921 |    8962 |  47.166 |   19.418 | 65.095 |      0 |      0 | 0.467 |        0 |      0 |  13223.63 |  2479.958 |  5804.766 |  7132.268 |   5178.71 |    0.8 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1000000 |   99.3 | 9.48976065967809 |
| IDN | 360 | Indonesia                                            | 0.967 | 0.435 |  2.587 | 0.304 | 13.405 |  181157 |  -2.226 |  117.277 | 43.306 |      0 | 99.835 | 0.062 |  77.0687 |    287 |  3028.274 |   839.518 |  1507.126 |  3258.498 |   1752.64 | -0.653 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  6987225 |      0 | 8.01574809923494 |
| IND | 356 | India                                                | 1.013 | 0.237 |  2.842 | 0.295 | 12.824 |  297319 |  22.876 |   79.627 | 51.042 |  4.495 | 39.447 | 0.407 |  18.0434 |    489 |  2415.093 |   619.003 |   897.336 |  1885.008 |  1006.152 |  0.213 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   | 77226807 |      0 | 7.78949307466198 |
| IRL | 372 | Ireland                                              | 0.513 |  0.28 |  1.676 | 0.158 |  2.864 |    6889 |  53.181 |   -8.153 | 59.095 |      0 |      0 | 0.035 |  95.8615 |      0 |  30532.31 |  3452.898 |  7316.275 |  21551.34 |  8281.263 |  1.643 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   193357 | 99.885 | 10.3265407461486 |
| IRN | 364 | Iran; Islamic Republic of                            | 2.445 | 0.929 |  6.962 | 0.651 | 33.616 |  162855 |   32.56 |   54.305 | 21.824 |  0.543 |      0 | 0.461 |  11.4317 |      0 |  5826.672 |  1719.611 |  5862.488 |  4662.057 |  3593.365 |   -0.6 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  3741657 |      0 | 8.67020127587281 |
| ISL | 352 | Iceland                                              | 1.472 | 0.557 |  5.318 | 0.435 | 20.729 |   10025 |   64.99 |  -18.594 |  3.403 |  9.086 |      0 |  0.04 |  93.2095 |      0 |  28929.43 |       nil |       nil |       nil |       nil |  1.753 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    60000 |    nil | 10.2726146950454 |
| ISR | 376 | Israel                                               | 1.705 | 1.002 |  4.808 | 0.439 | 23.277 |    2164 |  31.353 |   34.967 | 27.477 |  0.709 |      0 | 0.052 |  90.3822 |      0 |  23857.94 |  2817.303 | 10147.871 | 16925.594 |   9250.91 |   1.07 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   229955 | 30.698 |  10.079872354959 |
| ITA | 380 | Italy                                                | 2.458 | 0.755 |  7.506 | 0.711 | 38.884 |   29411 |  42.789 |   12.075 |  51.78 |      0 |      0 | 0.058 |  80.9226 |      0 |  24994.66 |    3501.9 | 10741.869 |  18773.57 | 11048.927 |  0.893 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  7000000 |   99.8 | 10.1264174810346 |
| JAM | 388 | Jamaica                                              | 1.788 | 0.934 |  4.837 | 0.528 | 24.278 |    1083 |  18.156 |  -77.311 |  66.97 |      0 |    100 | 0.012 |      100 |      0 |   3650.39 |  1326.785 |  3844.877 |   3598.21 |   3139.55 | -0.377 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    22626 |      8 | 8.20258929018362 |
| JOR | 400 | Jordan                                               | 1.097 | 1.648 |  3.115 | 0.282 | 12.165 |    8824 |   31.25 |   36.788 | 15.479 | 15.332 |      0 | 0.189 |  16.2407 |      0 |  3846.694 |  1663.149 |  2582.962 |  4088.574 |  3248.945 |   0.39 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    86370 |      1 | 8.25496935708797 |
| JPN | 392 | Japan                                                | 2.132 | 0.463 |  6.275 | 0.604 | 37.173 |   36450 |   37.54 |  137.963 | 42.879 |      0 |  0.006 | 0.032 |  97.7372 |      0 |  26219.79 |  1920.721 | 11343.781 | 20742.387 | 11248.286 |  1.477 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   | 12500000 |      0 | 10.1742697481323 |
| KAZ | 398 | Kazakhstan                                           | 0.372 | 0.281 |  1.172 | 0.108 |  2.913 |  269970 |   48.18 |   67.313 |  9.877 |  9.747 |      0 | 2.206 |        0 |      0 |  4594.435 |       nil |       nil |  5648.025 |       nil | -0.877 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1253389 |   41.9 | 8.43260106749077 |
| KEN | 404 | Kenya                                                | 0.669 | 0.559 |  1.781 | 0.195 |  5.427 |   56914 |   0.534 |   37.861 | 33.657 | 11.629 | 51.028 | 0.409 |  9.38789 |      0 |  1018.731 |   650.601 |   941.848 |  1030.687 |   912.759 |  -1.05 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 86447.906 | 11.083 | 2.705  | 3.359 | 1.361 |  1322790 |      0 | 6.92631301407441 |
| KGZ | 417 | Kyrgyzstan                                           | 4.287 | 0.948 | 13.105 | 1.246 | 69.767 |   19180 |  41.464 |   74.556 | 12.534 |      0 |      0 | 1.918 |        0 |      0 |      1560 |       nil |       nil |  2167.491 |       nil |  -0.74 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   325361 |     15 | 7.35244110024358 |
| KHM | 116 | Cambodia                                             |  0.54 | 0.146 |  1.421 | 0.154 |  6.094 |   17652 |  12.707 |  104.921 | 22.213 |      0 |    100 |  0.17 |   25.378 |      0 |  1859.063 |   481.977 |   579.707 |      1141 |   766.583 | -1.013 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1383162 |      0 | 7.52782787633495 |
| KNA | 659 | Saint Kitts and Nevis                                | 0.006 |  0.01 |  0.012 | 0.003 |      0 |      26 |  17.274 |  -62.704 |    100 |      0 |    100 | 0.001 |      100 |      0 |   11224.7 |       nil |       nil |       nil |       nil |   0.06 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |      743 |    nil |  9.3258719861954 |
| KOR | 410 | Republic of Korea                                    |  1.96 | 0.747 |  5.807 | 0.546 | 33.976 |    9873 |  36.356 |  127.806 | 43.556 |      0 |      0 | 0.042 |  95.0484 |      0 |  16172.41 |    853.89 |  3161.702 | 14219.083 |  4725.635 |  0.717 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  2308243 |      0 | 9.69106198290034 |
| KWT | 414 | Kuwait                                               | 0.245 | 0.271 |  0.691 | 0.063 |      0 |    1782 |  29.354 |   47.613 |      0 |      0 |      0 |  0.04 |  98.6018 |      0 |  15958.92 | 28878.139 | 18161.664 | 10082.733 | 19359.766 |   0.77 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    42006 |      0 | 9.67777319954121 |
| LAO | 418 | Lao People's Democratic Republic                     | 2.553 | 1.218 |  6.976 | 0.723 | 49.807 |   23080 |  18.495 |  103.774 | 12.068 |      0 | 54.794 | 0.267 |   6.8206 |      0 |  1569.901 |   612.943 |   783.584 |  1203.223 |   826.834 |  -1.15 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   348220 |      0 | 7.35876783902932 |
| LBN | 422 | Lebanon                                              | 4.197 |  2.17 | 12.042 | 1.103 | 71.642 |    1023 |  33.922 |   35.897 | 72.415 |      0 |      0 | 0.027 |      100 |      0 |  4216.305 |   2428.74 |  3461.337 |   3405.22 |  2881.809 | -0.177 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   313584 |    0.5 | 8.34671443105805 |
| LCA | 662 | Saint Lucia                                          | 2.147 | 1.351 |  5.841 |  0.59 | 35.476 |      61 |  13.894 |  -60.965 | 32.527 |      0 |    100 | 0.002 |      100 |      0 |  5620.647 |       nil |       nil |       nil |       nil |   0.06 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |     1335 |    nil | 8.63420206081657 |
| LKA | 144 | Sri Lanka                                            |  0.65 | 0.446 |  1.712 | 0.197 |  7.786 |    6463 |    7.63 |   80.701 | 51.595 |      0 |    100 | 0.035 |      100 |      0 |  3625.534 |  1252.871 |  1540.745 |  3633.984 |  1891.942 | -0.067 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   956352 |      0 |  8.1957568667845 |
| LSO | 426 | Lesotho                                              | 6.202 | 4.165 | 17.595 | 1.559 | 90.249 |    3035 |  -29.58 |   28.254 | 54.695 |      0 |      0 | 0.246 |        0 |    308 |  2122.544 |   355.366 |   714.936 |  1490.346 |   824.398 | -0.083 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |         0 | 7.202  | 3.035  | 6.637 | 4.846 |    26096 |      0 | 7.66037064824154 |
| LTU | 440 | Lithuania                                            | 0.175 | 0.229 |  0.578 | 0.049 |      0 |    6268 |  55.336 |   23.905 | 62.064 |      0 |      0 | 0.256 |  13.8029 |      0 |  8767.231 |       nil |       nil |  6346.336 |       nil |   0.33 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   161557 |    100 | 9.07877630004949 |
| LUX | 442 | Luxembourg                                           | 0.881 | 0.581 |  2.844 | 0.242 |  1.654 |     259 |  49.778 |    6.095 | 25.662 |      0 |      0 | 0.259 |        0 |      0 |  57792.09 |       nil |       nil |       nil |       nil |  1.767 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    26534 |   99.2 | 10.9646071940844 |
| LVA | 428 | Latvia                                               | 0.154 | 0.136 |  0.522 | 0.044 |      0 |    6205 |  56.854 |   24.931 | 77.568 |      0 |      0 | 0.265 |  15.7566 |      0 |  7903.728 |       nil |       nil |  7693.585 |       nil |  0.177 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   122643 |    100 |  8.9750898258801 |
| MAC | 446 | Macao Special Administrative Region of China         | 0.732 | 0.527 |  1.921 | 0.185 |  4.168 |       3 |  22.169 |  113.555 |      0 |      0 |      0 |     0 |      100 |      0 |  18581.94 |       nil |       nil |       nil |       nil |  0.195 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    13636 |    nil | 9.82994542026482 |
| MAR | 504 | Morocco                                              | 2.413 | 1.291 |  6.853 | 0.629 | 36.083 |   44630 |  31.882 |   -6.302 | 43.968 |  0.614 |      0 | 0.164 |  35.4198 |      0 |  3513.834 |  1455.361 |  1830.967 |  2657.562 |  1952.039 |  0.133 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 |         0 | 5.794  | 13.676 | 1.023 | 4.571 |  1586397 |      8 | 8.16446302801824 |
| MDA | 498 | Republic of Moldova                                  | 0.799 | 0.573 |  2.527 | 0.222 |  0.403 |    3288 |  47.205 |   28.468 | 62.015 |      0 |      0 | 0.197 |  11.0077 |      0 |  1331.461 |       nil |       nil |  2127.236 |       nil | -0.317 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   147311 |   99.1 | 7.19403211455089 |
| MDG | 450 | Madagascar                                           | 1.169 | 0.738 |  3.185 | 0.328 | 12.672 |   58154 | -19.379 |     46.7 | 50.804 |      0 | 65.224 | 0.087 |  61.0618 |      0 |   825.244 |    951.01 |   1126.29 |   705.899 |   966.595 | -0.653 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |    125000 | 9.686  | 0.904  | 5.732 | 3.454 |   544859 |    0.6 | 6.71567910018279 |
| MEX | 484 | Mexico                                               | 1.732 | 0.825 |  4.795 | 0.491 | 27.341 |  194395 |  23.941 | -102.536 | 31.934 |  1.704 | 27.928 | 0.183 |  38.4165 |      0 |   9046.27 |  2365.019 |   5158.34 |  7274.678 |  4824.431 | -0.473 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  4514402 |     30 | 9.11010779703875 |
| MKD | 807 | The former Yugoslav Republic of Macedonia            | 2.665 | 0.885 |   8.19 | 0.783 | 49.405 |    2543 |    41.6 |   21.701 | 52.895 |      0 |      0 | 0.135 |  14.0538 |      0 |  6059.698 |       nil |       nil |  3340.784 |       nil | -0.433 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   169275 |  96.31 | 8.70941524283806 |
| MLI | 466 | Mali                                                 | 0.147 | 0.305 |  0.393 | 0.042 |  0.228 |  122019 |  17.355 |   -3.524 | 18.562 | 26.132 | 11.688 | 1.014 |        0 |      0 |   779.597 |   456.875 |   612.963 |   891.656 |   638.532 | -0.527 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |    842000 | 3.897  | 10.79  | 2.263 | 4.311 |  1063541 |      0 | 6.65877711949876 |
| MLT | 470 | Malta                                                | 1.527 | 1.171 |  4.292 | 0.381 | 14.699 |      32 |  35.925 |   14.407 |    100 |      0 |      0 | 0.002 |      100 |      0 |  18255.73 |       nil |       nil |       nil |       nil |  1.003 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    10000 |   99.5 | 9.81223428233429 |
| MNG | 496 | Mongolia                                             | 1.057 | 0.765 |  3.352 | 0.309 | 12.623 |  156650 |  46.836 |   103.07 | 44.883 |   1.49 |      0 | 1.694 |        0 |      0 |  1620.436 |   435.422 |   912.424 |  1084.652 |   891.187 |      0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   578516 |      1 | 7.39045052781836 |
| MOZ | 508 | Mozambique                                           | 0.612 | 0.438 |  1.653 |  0.17 |   4.54 |   78638 | -17.264 |   35.549 | 55.384 |      0 | 87.365 |  0.21 |   30.756 |      0 |   876.868 |   1133.42 |   1403.62 |  1364.891 |   1278.82 |  -0.85 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 |    626000 | 9.264  | 2.185  | 5.268 | 3.298 |   786003 |      0 | 6.77635646793106 |
| MRT | 478 | Mauritania                                           | 0.115 | 0.147 |  0.308 | 0.034 |  0.278 |  103070 |  20.264 |  -10.336 |  2.042 | 74.857 |      0 | 0.511 |   5.9946 |      0 |  1729.208 |   463.918 |   961.991 |   1016.92 |   856.331 | -0.523 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |    164000 | 4.424  | 11.914 | 2.255 | 4.973 |   221211 |      0 | 7.45541877919961 |
| MUS | 480 | Mauritius                                            | 0.949 | 0.788 |  2.436 | 0.283 |  9.101 |     203 | -20.131 |   57.879 | 52.217 |      0 |    100 | 0.006 |      100 |      0 |  9622.512 |  2489.759 |  3969.069 | 10652.315 |  4876.056 |  0.793 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |         0 | 10.31  | 0.032  | 6.274 | 3.884 |        0 |     16 | 9.17186063223429 |
| MWI | 454 | Malawi                                               | 1.027 | 0.821 |  2.759 |   0.3 | 10.542 |    9408 | -13.216 |   34.301 | 32.281 |      0 | 39.224 | 0.496 |        0 |      0 |   586.252 |   324.056 |    591.72 |   656.235 |   507.871 |  -0.53 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |    125000 | 9.267  | 2.183  | 4.821 | 2.922 |   348220 |      0 | 6.37374973126853 |
| MYS | 458 | Malaysia                                             | 1.009 | 0.374 |  2.684 | 0.316 |  12.87 |   32855 |   3.791 |  109.709 | 49.196 |      0 |    100 | 0.057 |  83.2625 |      0 |  8926.452 |  1559.265 |  2648.422 |   8165.59 |  3467.013 |  0.517 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   296322 |      0 | 9.09677428249104 |
| NAM | 516 | Namibia                                              | 0.913 | 0.423 |  2.489 | 0.235 |  9.723 |   82329 |  -22.14 |   17.219 | 25.173 | 13.861 |      0 | 0.305 |  17.6842 |  55728 |  6057.856 |  2159.705 |  3333.925 |  3637.062 |  3181.151 |  0.293 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |   190.351 | 5.683  | 5.792  | 5.981 | 4.685 |    93798 |  10.85 | 8.70911122108347 |
| NCL | 540 | New Caledonia                                        | 1.586 | 0.621 |  4.338 | 0.492 | 24.913 |    1828 | -21.299 |  165.663 | 54.444 |      0 | 94.292 | 0.008 |      100 |      0 |     22140 |       nil |       nil |       nil |       nil |  -0.86 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    31251 |    nil | 10.0051412062626 |
| NER | 562 | Niger                                                | 0.178 | 0.222 |  0.481 | 0.051 |  0.245 |  126670 |  17.424 |    9.401 |  8.236 |  39.21 |  0.032 | 1.186 |        0 |      0 |   703.141 |   617.031 |   658.875 |   486.397 |   683.153 | -0.837 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 19911.727 | 5.159  | 9.223  | 1.768 | 2.954 |   705385 |      0 | 6.55555744068944 |
| NGA | 566 | Nigeria                                              | 0.312 | 0.229 |  0.833 | 0.093 |  1.563 |   91077 |   9.585 |    8.092 | 56.263 |      0 |  73.44 | 0.491 |  9.17532 |      0 |    882.59 |   752.681 |  1416.623 |  1251.178 |  1109.575 |  -1.29 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |   2020000 | 5.224  | 9.151  | 2.642 | 3.314 |  5909180 |      0 | 6.78286076661037 |
| NIC | 558 | Nicaragua                                            | 0.992 | 0.768 |  2.671 | 0.286 | 11.923 |   12140 |  12.841 |  -85.033 | 33.249 |      0 |    100 | 0.077 |  65.2217 |      0 |   3277.64 |  1615.788 |  3128.881 |  1520.552 |  2131.895 | -0.657 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   100069 |     51 | 8.09487893020994 |
| NLD | 528 | Netherlands                                          | 0.037 | 0.042 |  0.108 | 0.012 |      0 |    3388 |   52.25 |    5.621 | 41.165 |      0 |      0 | 0.042 |  91.6192 |      0 |  28610.12 |  5996.128 | 13373.628 | 22161.445 | 12961.165 |   1.79 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   600000 |  95.95 |  10.261515780373 |
| NOR | 578 | Norway                                               | 2.409 | 1.245 |  8.516 | 0.692 | 37.013 |   30428 |  64.467 |   14.082 |  0.073 |      0 |      0 | 0.053 |  79.6415 |      0 |  34207.82 |   5429.51 | 12271.317 | 25101.949 | 13253.486 |   1.95 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   400000 |    100 | 10.4402095518839 |
| NPL | 524 | Nepal                                                | 5.043 |  1.26 | 14.458 | 1.493 | 75.265 |   14300 |  28.264 |   83.931 | 41.622 |      0 |      0 | 0.697 |        0 |      0 |  1322.873 |   496.334 |   641.508 |   999.145 |   691.527 | -0.177 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1852093 |      0 |  7.1875611655541 |
| NZL | 554 | New Zealand                                          | 2.038 | 0.451 |  6.233 | 0.606 |  31.49 |   26771 | -41.806 |  171.478 | 44.643 |      0 |      0 | 0.039 |   95.685 |      0 |  19614.94 |  8455.649 | 12488.613 | 16170.117 |  11982.21 |   1.87 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    15000 |   80.6 | 9.88404679975547 |
| OMN | 512 | Oman                                                 | 1.109 | 0.896 |  3.012 | 0.283 | 12.216 |   30950 |  20.595 |   56.104 |      0 | 19.027 |      0 | 0.113 |  47.7134 |      0 |  12729.71 |   623.095 |  4267.115 |  7115.765 |  3880.417 |  0.843 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   200000 |      0 | 9.45169391045929 |
| PAK | 586 | Pakistan                                             | 1.949 | 0.341 |  5.665 | 0.559 | 25.078 |   77088 |   29.97 |   69.395 |  6.988 | 11.184 |      0 | 0.589 |  11.0758 |      0 |  1925.391 |    643.02 |   977.667 |  1815.145 |  1110.924 | -0.727 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  7669487 |      0 | 7.56288434297956 |
| PAN | 591 | Panama                                               |  1.54 | 0.546 |  4.128 | 0.457 | 22.956 |    7443 |   8.513 |  -80.109 | 42.843 |      0 |    100 | 0.018 |      100 |      0 |  6164.348 |  1915.962 |  4198.462 |  5675.752 |  3954.735 | -0.143 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    66462 |   45.2 | 8.72653765169258 |
| PER | 604 | Peru                                                 | 1.347 | 0.991 |  3.653 | 0.427 |  20.01 |  128000 |  -9.173 |  -74.361 | 21.743 |   0.54 | 55.788 | 0.325 |  16.7165 |      0 |  4722.525 |  2307.632 |  4325.977 |   3832.72 |  3502.972 | -0.633 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1888175 | 28.043 |  8.4600988931679 |
| PHL | 608 | Philippines                                          | 2.028 | 0.574 |  5.428 | 0.583 | 34.183 |   29817 |  11.739 |  122.868 | 80.137 |      0 | 98.973 |  0.02 |      100 |      0 |  4027.548 |  1070.263 |  2033.298 |  2421.199 |  1893.012 | -0.237 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   362390 |      0 | 8.30091303304343 |
| PNG | 598 | Papua New Guinea                                     | 1.589 |  0.98 |  4.217 | 0.491 | 25.222 |   45286 |  -6.476 |  145.252 | 46.833 |      0 |    100 | 0.071 |  71.2843 |      0 |  2325.738 |       nil |       nil |       nil |       nil |  -0.68 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   866855 |      0 | 7.75179268700943 |
| POL | 616 | Poland                                               | 0.297 | 0.259 |  0.951 | 0.084 |    1.2 |   30436 |  52.124 |   19.401 |  48.41 |      0 |      0 | 0.283 |  14.8703 |      0 |  10401.36 |  2446.893 |   5807.87 |  7308.837 |  4706.412 |  0.643 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  2750000 |    100 | 9.24969184581068 |
| PRI | 630 | Puerto Rico                                          | 1.447 | 0.699 |  3.928 | 0.416 |  19.25 |     887 |  18.225 |  -66.464 | 59.186 |      0 |    100 | 0.012 |      100 |      0 |  22242.23 |  2143.823 |  6946.214 | 14105.683 |  7177.506 |  0.917 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    35772 |   66.3 |  10.009748013122 |
| PRT | 620 | Portugal                                             | 1.304 | 0.967 |  3.937 | 0.369 | 15.522 |    9150 |  39.593 |   -8.531 | 34.264 |      0 |      0 | 0.072 |  70.0621 |      0 |  18255.28 |  2086.406 |  6517.205 | 13813.426 |  6861.499 |  1.167 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   900000 |  98.27 |  9.8122096322356 |
| PRY | 600 | Paraguay                                             | 0.245 | 0.479 |  0.681 | 0.067 |  0.224 |   39730 | -23.245 |  -58.393 | 28.751 |      0 | 57.034 | 0.847 |        0 |      0 |  4553.069 |  1584.366 |  2220.024 |  3013.877 |  2405.144 | -0.817 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   174110 |  52.85 | 8.42355679006291 |
| PYF | 258 | French Polynesia                                     | 2.072 | 1.389 |  5.637 | 0.645 |  40.29 |     366 | -15.346 | -145.232 |  6.284 |      0 | 96.819 | 0.001 |      100 |      0 |  24538.31 |       nil |       nil |       nil |       nil |    nil | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    24449 |    nil | 10.1079908487378 |
| ROU | 642 | Romania                                              | 1.267 | 0.555 |  4.005 | 0.357 |  16.71 |   22971 |  45.843 |   24.986 | 69.642 |      0 |      0 | 0.367 |   6.7651 |      0 |  5889.324 |  1181.952 |   3761.37 |   3005.54 |  2935.706 |  -0.15 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1250000 |  99.43 |   8.680896499261 |
| RUS | 643 | Russian Federation                                   |  0.94 | 0.355 |  3.278 | 0.267 | 11.412 | 1638134 |   61.99 |   96.711 | 17.718 |  0.056 |      0 | 1.841 |  2.76605 | 205550 |  7095.689 |       nil |       nil |  5276.657 |       nil | -0.873 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  6481410 |   99.5 | 8.86724269552051 |
| RWA | 646 | Rwanda                                               | 3.309 | 3.178 |  8.748 | 0.855 | 64.627 |    2467 |  -2.003 |   29.923 |  42.97 |      0 |  68.88 | 0.946 |        0 |      0 |  1039.172 |   546.902 |   805.649 |   818.696 |   739.706 |   -1.4 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 |         0 | 10.754 | 2.623  | 3.568 | 2.102 |   211005 |      0 | 6.94617952119047 |
| SAU | 682 | Saudi Arabia                                         | 0.914 | 0.688 |  2.514 | 0.231 |  8.891 |  214969 |  24.097 |   44.562 |      0 | 37.258 |      0 | 0.304 |  13.6641 |      0 |  12374.11 |  2230.766 | 11787.042 |  7647.705 |  7612.613 |  0.343 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  2000000 |      0 | 9.42336166565866 |
| SDN | 736 | Sudan                                                | 0.442 | 0.292 |  1.186 | 0.116 |  2.891 |  237600 |  13.887 |    30.09 |   19.8 |   2.16 | 20.679 | 0.917 |  2.92113 |      0 |  1682.674 |   820.837 |   910.048 |   991.254 |   903.639 | -1.547 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |    864000 | 15.253 | 3.528  | 1.827 | 0.983 |  3776350 |      0 | 7.42813947370509 |
| SEN | 686 | Senegal                                              | 0.244 | 0.246 |  0.647 | 0.065 |  0.168 |   19253 |  14.361 |  -14.474 | 60.496 |      0 | 34.999 | 0.165 |  32.4713 |      0 |  1435.082 |  1258.898 |  1396.079 |  1358.175 |  1348.293 | -0.207 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |    377000 | 3.898  | 10.791 | 3.035 | 5.518 |   442565 |    1.3 | 7.26897726941827 |
| SGP | 702 | Singapore                                            | 0.016 | 0.004 |  0.036 | 0.005 |      0 |      67 |   1.361 |   103.82 |  3.488 |      0 |    100 | 0.003 |      100 |      0 |  23611.61 |  2218.961 |  6430.213 |  22518.17 |  8339.448 |  1.577 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    49570 |    0.5 | 10.0694938191989 |
| SLB |  90 | Solomon Islands                                      |  1.54 | 1.109 |  4.111 | 0.476 | 21.213 |    2799 |  -8.895 |  159.601 | 80.002 |      0 |    100 | 0.003 |      100 |      0 |   1862.47 |       nil |       nil |       nil |       nil | -1.195 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    43289 |    nil | 7.52965884274144 |
| SLE | 694 | Sierra Leone                                         | 0.498 | 0.574 |  1.317 | 0.144 |  1.943 |    7162 |   8.561 |  -11.791 |  7.546 |      0 |    100 |   0.1 |  51.5546 |  16819 |   466.647 |   656.268 |  1125.709 |   409.872 |   904.314 |  -1.29 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 69606.719 | 3.705  | 10.188 | 3.474 | 5.41  |   338261 |      0 | 6.14557308319006 |
| SLV | 222 | El Salvador                                          |  1.75 |     1 |  4.746 | 0.518 | 26.108 |    2072 |  13.724 |  -88.869 | 65.938 |      0 |    100 | 0.039 |  99.6575 |      0 |  4594.274 |  1488.813 |  2503.697 |  2715.551 |  2147.779 | -0.743 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   150732 |     50 | 8.43256602448309 |
| SVK | 703 | Slovakia                                             |  1.56 | 0.672 |  5.043 | 0.442 | 23.419 |    4810 |  48.707 |   19.487 | 60.924 |      0 |      0 | 0.554 |        0 |      0 |  11303.75 |       nil |       nil |  8219.698 |       nil |  0.263 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   698933 |  99.61 | 9.33288980805469 |
| SVN | 705 | Slovenia                                             | 2.496 | 0.746 |  7.713 | 0.711 | 39.108 |    2014 |  46.112 |   14.823 | 67.604 |      0 |      0 | 0.091 |  61.6056 |      0 |  16873.33 |       nil |       nil | 12876.633 |       nil |  0.973 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   202779 |    100 | 9.73348954788061 |
| SWE | 752 | Sweden                                               | 0.715 | 0.343 |   2.53 | 0.207 |  3.868 |   41033 |  62.777 |   16.759 | 15.853 |      0 |      0 | 0.223 |  21.2438 |      0 |  25899.88 |  6739.231 | 14183.347 | 20709.986 | 13259.333 |  1.813 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   800000 |   99.3 | 10.1619936144723 |
| SWZ | 748 | Swaziland                                            | 3.063 | 2.301 |  8.574 | 0.775 | 54.481 |    1720 | -26.565 |   31.501 | 54.413 |      0 |  2.876 | 0.113 |  36.2172 |    426 |  4681.445 |   721.089 |  2461.908 |  2630.322 |  1902.181 |  -0.16 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |         0 | 8.291  | 2.622  | 6.295 | 4.423 |     9707 |    2.8 | 8.45136210193868 |
| SYC | 690 | Seychelles                                           | 4.885 | 1.802 | 11.129 | 1.278 | 54.101 |      46 |  -6.723 |   51.924 | 13.043 |      0 |    100 |     0 |      100 |      0 |  17957.47 |  1912.258 |  3250.874 |  6353.528 |  3625.007 |   0.58 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |         0 | 11.457 | 1.742  | 4.635 | 2.253 |        0 |    nil |  9.7957614633364 |
| SYR | 760 | Syrian Arab Republic                                 | 0.756 | 0.741 |  2.174 | 0.198 |   6.63 |   18378 |  35.014 |   38.498 | 52.909 |  3.445 |      0 | 0.244 |  16.7091 |      0 |  3242.195 |  2408.502 |  5570.152 |  7368.301 |  4961.027 | -0.367 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1306601 |      0 | 8.08400584854355 |
| TCD | 148 | Chad                                                 | 0.419 | 0.197 |  1.135 | 0.112 |  3.605 |  125920 |  15.365 |   18.667 | 19.262 |  21.72 | 13.413 | 1.254 |        0 |      0 |    821.15 |   475.502 |     550.5 |   428.787 |   472.883 |  -0.92 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |    529000 | 5.581  | 8.876  | 1.879 | 2.026 |   776187 |      0 | 6.71070579678357 |
| TGO | 768 | Togo                                                 |  0.28 | 0.247 |  0.745 | 0.088 |  0.981 |    5439 |   8.528 |    0.977 | 56.646 |      0 |    100 | 0.263 |   16.778 |      0 |  1436.855 |   573.994 |  1055.553 |   614.222 |    833.23 | -0.893 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |    290000 | 4.926  | 9.258  | 3.009 | 4.085 |   231251 |      0 | 7.27021197632532 |
| THA | 764 | Thailand                                             | 1.051 | 0.189 |  2.826 | 0.302 | 16.408 |   51089 |  15.107 |  101.018 | 20.144 |      0 | 99.546 | 0.193 |  29.3876 |      0 |   6279.51 |   817.049 |   1958.72 |  6397.871 |  2729.121 |  0.477 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1741101 |      0 | 8.74504723094039 |
| TJK | 762 | Tajikistan                                           | 5.301 | 1.033 | 15.976 |  1.54 | 75.473 |   13996 |  38.527 |   71.038 | 17.449 |  0.025 |      0 | 1.505 |        0 |      0 |   785.469 |       nil |       nil |   883.162 |       nil |  -1.61 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   286375 |    3.9 | 6.66628099160818 |
| TKM | 795 | Turkmenistan                                         | 0.284 | 0.248 |  0.834 | 0.082 |  1.426 |   46993 |  39.194 |   59.178 |   3.97 | 55.087 |      0 | 1.286 |        0 |      0 |  3667.555 |       nil |       nil |  2324.556 |       nil |  -1.18 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   226444 |    5.5 | 8.20728050649637 |
| TON | 776 | Tonga                                                | 0.773 |  0.07 |  1.992 | 0.224 |  9.737 |      72 | -19.859 | -174.847 |    100 |      0 |    100 |     0 |      100 |      0 |  6568.724 |       nil |       nil |       nil |       nil |  -0.38 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    19021 |    nil | 8.79007487648232 |
| TTO | 780 | Trinidad and Tobago                                  | 0.603 | 0.521 |  1.611 | 0.184 |  5.099 |     513 |  10.469 |  -61.257 | 50.384 |      0 |    100 | 0.008 |      100 |      0 |  8969.766 |  3674.051 |  9117.805 | 13681.761 |  8591.538 |   0.42 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    10258 |    7.1 | 9.10161486775605 |
| TUN | 788 | Tunisia                                              | 0.726 | 0.585 |  2.079 | 0.198 |  7.434 |   15536 |   34.12 |    9.579 | 31.727 | 20.664 |      0 | 0.114 |  48.8258 |      0 |  6251.551 |  1114.596 |  2446.059 |  4552.262 |   2441.64 | -0.083 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 |         0 | 7.48   | 15.833 | 0.31  | 3.205 |   836512 |      0 | 8.74058487194385 |
| TUR | 792 | Turkey                                               |  2.62 | 1.192 |  7.773 | 0.732 | 40.909 |   76963 |  39.061 |   35.174 | 65.295 |      0 |      0 | 0.152 |  38.9877 |      0 |  6510.354 |  1622.933 |  3894.789 |  6609.014 |  3821.776 |  -0.04 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  6438306 |     10 | 8.78114911160438 |
| TZA | 834 | United Republic of Tanzania                          | 0.677 | 0.541 |  1.814 | 0.201 |  5.346 |   88580 |  -6.266 |   34.826 | 39.711 |      0 | 88.294 |  0.42 |  10.2759 |   9035 |   521.827 |   423.714 |   600.268 |   535.125 |    527.04 |  -0.43 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |    535000 | 10.595 | 2.558  | 4.056 | 2.187 |  1496403 |      0 | 6.25733611532716 |
| UGA | 800 | Uganda                                               | 0.913 | 0.779 |  2.424 | 0.251 |  8.765 |   19710 |   1.282 |   32.388 | 13.095 |   0.02 | 97.783 | 0.909 |        0 |      0 |  1243.514 |   686.854 |   784.287 |   796.523 |   699.696 |   -0.7 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  4553.603 | 10.996 | 2.699  | 3.204 | 1.65  |  1322790 |      0 | 7.12569652172451 |
| UKR | 804 | Ukraine                                              | 0.416 | 0.359 |  1.317 | 0.117 |  1.988 |   57935 |  49.009 |   31.411 | 69.003 |      0 |      0 | 0.365 |  13.6144 |      0 |   4108.69 |       nil |       nil |  2745.334 |       nil | -0.823 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  2347003 |    100 | 8.32085952189036 |
| URY | 858 | Uruguay                                              | 0.435 | 0.391 |  1.283 | 0.114 |  0.136 |   17502 | -32.802 |  -56.013 | 68.979 |      0 |      0 | 0.142 |  37.4727 |      0 |  8781.518 |  4659.398 |  5421.178 |  7883.267 |  5841.658 |   0.55 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |      nil |  91.89 |  9.0804045646234 |
| USA | 840 | United States of America                             | 1.073 | 0.333 |  3.384 | 0.304 | 14.317 |  916192 |  45.718 | -112.982 |   41.6 |  0.278 |  0.358 | 0.677 |  13.1656 |      0 |  33970.17 |  9561.348 | 16283.633 |  28448.85 | 17349.756 |  1.697 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   783496 |  76.02 | 10.4332380655578 |
| UZB | 860 | Uzbekistan                                           | 0.526 | 0.243 |  1.589 | 0.154 |  5.782 |   42540 |  41.633 |   63.341 |  11.72 | 32.152 |      0 | 1.645 |        0 |      0 |  1515.708 |       nil |       nil |  3478.961 |       nil | -1.023 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1180650 |    7.5 | 7.32363793551301 |
| VCT | 670 | Saint Vincent and the Grenadines                     | 3.071 | 1.878 |  8.401 | 0.892 | 61.286 |      39 |  13.185 |  -61.205 | 38.818 |      0 |    100 | 0.001 |      100 |      0 |  5334.509 |       nil |       nil |       nil |       nil |   0.06 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |     1081 |    nil | 8.58195212576103 |
| VEN | 862 | Venezuela (Bolivarian Republic of)                   | 0.634 | 0.594 |  1.716 | 0.202 |  5.994 |   88205 |   7.132 |  -66.153 | 21.567 |      0 | 96.752 | 0.306 |  25.2528 |   5124 |   5685.12 |  7461.959 | 10471.647 |  8414.729 |  9366.497 |  -0.73 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |   377635 |   54.5 | 8.64560751414128 |
| VNM | 704 | Viet Nam                                             | 2.054 | 0.439 |  5.603 | 0.583 | 36.775 |   31106 |  16.643 |  106.306 |  12.15 |      0 | 56.535 | 0.112 |  57.8169 |      0 |  2011.743 |   658.076 |   709.929 |  1808.773 |   932.382 | -0.553 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  1665106 |      0 | 7.60675678946259 |
| VUT | 548 | Vanuatu                                              | 1.729 | 1.041 |  4.709 | 0.545 | 24.993 |    1219 | -16.196 |  167.703 | 79.892 |      0 |    100 | 0.002 |      100 |      0 |   3172.14 |       nil |       nil |       nil |       nil | -0.455 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    22994 |    nil | 8.06216171797244 |
| WSM | 882 | Samoa                                                | 1.677 | 0.968 |  4.644 | 0.549 | 22.244 |     283 | -13.738 | -172.168 |    100 |      0 |    100 | 0.003 |      100 |      0 |  4860.269 |       nil |       nil |       nil |       nil |   0.36 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |    33072 |    nil | 8.48884906515704 |
| YEM | 887 | Yemen                                                | 2.323 | 2.197 |  6.155 | 0.591 |  33.06 |   52797 |  15.863 |    47.58 |      0 |  10.75 |      0 | 0.148 |  38.1163 |      0 |   787.749 |   911.231 |  1783.548 |  2619.284 |  1703.219 | -1.127 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |         0 | nil    | nil    | nil   | nil   |  2250000 |      0 |  6.6691795111983 |
| ZAF | 710 | South Africa                                         | 1.761 | 1.318 |  4.942 |  0.45 | 23.957 |  121447 | -29.004 |   25.094 | 27.647 |  4.386 |  0.179 | 0.306 |  18.9404 | 144785 |  9419.122 |  2534.946 |  4270.851 |  3978.219 |  3667.399 |  0.207 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |  2030.663 | 6.766  | 3.457  | 6.584 | 4.895 |   486527 |     18 | 9.15049715728167 |
| ZMB | 894 | Zambia                                               | 0.533 | 0.506 |  1.422 | 0.145 |  2.455 |   74339 | -13.458 |   27.794 | 23.114 |      0 | 17.132 |   0.9 |        0 |      0 |    774.01 |    660.91 |  1040.744 |   645.375 |   863.642 | -0.587 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 27957.102 | 9.027  | 2.389  | 4.849 | 3.253 |   348220 |      1 | 6.65158479340291 |
| ZWE | 716 | Zimbabwe                                             | 1.194 | 1.106 |  3.232 | 0.306 | 13.837 |   38685 |     -19 |   29.869 | 54.877 |      0 |  8.401 | 0.499 |        0 |    898 |  2499.215 |   700.979 |  1401.811 |   1327.85 |  1163.542 | -0.813 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |  1088.177 | 9.027  | 2.389  | 5.454 | 3.696 |   174110 |      1 | 7.82373196154797 |

** 8.3.1. Preparation
#+BEGIN_SRC R

dd.trim <- dd[, c("log_gdp", "rugged", "cont_africa")]

#+END_SRC

#+RESULTS:
| 7.49260931459416 | 0.858 | 1 |
| 8.21692909624602 | 3.427 | 0 |
| 9.93326283619825 | 0.769 | 0 |
| 9.40703152318187 | 0.775 | 0 |
| 7.79234273086512 | 2.688 | 0 |
| 9.21254094892968 | 0.006 | 0 |
| 10.1431908315682 | 0.143 | 0 |
| 10.2746317106886 | 3.513 | 0 |
| 7.85202842562066 | 1.672 | 0 |
|  6.4323804506382 |  1.78 | 1 |
| 10.2147514989853 | 0.388 | 0 |
|  6.8661225392301 | 0.141 | 1 |
| 6.90617002312778 | 0.236 | 1 |
|  7.2991796084172 | 0.186 | 0 |
| 8.69603720857228 | 1.479 | 0 |
| 9.67583949615499 | 0.231 | 0 |
| 9.73962654638564 | 0.055 | 0 |
| 8.57451353658904 | 2.311 | 0 |
| 8.47681068364087 | 0.164 | 0 |
| 8.67747923988958 | 0.607 | 0 |
| 7.78274681916224 | 0.853 | 0 |
| 8.89574811326741 |  0.24 | 0 |
| 9.63499216609365 | 0.963 | 0 |
| 8.94930126909411 | 0.181 | 1 |
| 7.04582100097985 | 0.197 | 1 |
|  10.214248497175 | 0.775 | 0 |
| 10.3143145930905 | 4.761 | 0 |
| 9.11772879765844 | 2.481 | 0 |
| 8.27596585974172 | 1.878 | 0 |
| 7.36240920194672 | 0.224 | 1 |
| 7.54045529072993 | 0.515 | 1 |
| 6.50528019628938 | 0.443 | 1 |
| 6.86422441044003 | 0.152 | 1 |
| 8.73932118722848 | 0.885 | 0 |
| 7.47885798182564 | 3.328 | 1 |
| 8.48861016095453 | 2.367 | 1 |
| 9.06199012042507 | 2.112 | 0 |
| 9.91926247165149 | 2.718 | 0 |
| 9.64038296409646 | 0.884 | 0 |
| 10.1457052305603 | 0.597 | 0 |
| 7.54007278545387 | 2.432 | 1 |
| 8.68806865759927 | 0.003 | 0 |
| 10.2664142633917 | 0.189 | 0 |
| 8.76573981507963 | 1.641 | 0 |
| 8.59746541121139 |  0.51 | 1 |
| 8.12368086336647 | 1.278 | 0 |
| 8.18822485001884 | 0.723 | 1 |
| 6.81551278900216 | 2.481 | 1 |
| 9.98805064325063 | 1.689 | 0 |
| 9.18633042631571 | 0.123 | 0 |
| 6.45487461150232 |  1.57 | 1 |
| 10.1485444432022 | 0.328 | 0 |
| 8.50712224928982 | 1.396 | 0 |
| 10.1541688359787 | 1.098 | 0 |
| 8.71909872415293 | 0.218 | 1 |
| 10.1785421074163 | 0.568 | 0 |
| 7.53926638888368 | 3.659 | 0 |
| 7.54581671975788 | 0.228 | 1 |
| 7.58872562186115 |  0.74 | 1 |
| 7.45483452613317 | 0.353 | 1 |
| 6.66246452901108 | 0.491 | 1 |
|  9.6283623120503 | 0.559 | 1 |
| 9.76375065984722 | 3.103 | 0 |
| 8.92749922995689 | 2.088 | 0 |
|  8.2876308335697 | 1.807 | 0 |
| 8.31193032360769 | 0.273 | 0 |
| 10.1579681299395 | 2.501 | 0 |
| 7.82653530997876 |  2.15 | 0 |
| 9.16382249919614 | 1.267 | 0 |
| 7.49465599599274 | 2.362 | 0 |
| 9.48976065967809 | 0.346 | 0 |
| 8.01574809923494 | 0.967 | 0 |
| 7.78949307466198 | 1.013 | 0 |
| 10.3265407461486 | 0.513 | 0 |
| 8.67020127587281 | 2.445 | 0 |
| 10.2726146950454 | 1.472 | 0 |
|  10.079872354959 | 1.705 | 0 |
| 10.1264174810346 | 2.458 | 0 |
| 8.20258929018362 | 1.788 | 0 |
| 8.25496935708797 | 1.097 | 0 |
| 10.1742697481323 | 2.132 | 0 |
| 8.43260106749077 | 0.372 | 0 |
| 6.92631301407441 | 0.669 | 1 |
| 7.35244110024358 | 4.287 | 0 |
| 7.52782787633495 |  0.54 | 0 |
|  9.3258719861954 | 0.006 | 0 |
| 9.69106198290034 |  1.96 | 0 |
| 9.67777319954121 | 0.245 | 0 |
| 7.35876783902932 | 2.553 | 0 |
| 8.34671443105805 | 4.197 | 0 |
| 8.63420206081657 | 2.147 | 0 |
|  8.1957568667845 |  0.65 | 0 |
| 7.66037064824154 | 6.202 | 1 |
| 9.07877630004949 | 0.175 | 0 |
| 10.9646071940844 | 0.881 | 0 |
|  8.9750898258801 | 0.154 | 0 |
| 9.82994542026482 | 0.732 | 0 |
| 8.16446302801824 | 2.413 | 1 |
| 7.19403211455089 | 0.799 | 0 |
| 6.71567910018279 | 1.169 | 1 |
| 9.11010779703875 | 1.732 | 0 |
| 8.70941524283806 | 2.665 | 0 |
| 6.65877711949876 | 0.147 | 1 |
| 9.81223428233429 | 1.527 | 0 |
| 7.39045052781836 | 1.057 | 0 |
| 6.77635646793106 | 0.612 | 1 |
| 7.45541877919961 | 0.115 | 1 |
| 9.17186063223429 | 0.949 | 1 |
| 6.37374973126853 | 1.027 | 1 |
| 9.09677428249104 | 1.009 | 0 |
| 8.70911122108347 | 0.913 | 1 |
| 10.0051412062626 | 1.586 | 0 |
| 6.55555744068944 | 0.178 | 1 |
| 6.78286076661037 | 0.312 | 1 |
| 8.09487893020994 | 0.992 | 0 |
|  10.261515780373 | 0.037 | 0 |
| 10.4402095518839 | 2.409 | 0 |
|  7.1875611655541 | 5.043 | 0 |
| 9.88404679975547 | 2.038 | 0 |
| 9.45169391045929 | 1.109 | 0 |
| 7.56288434297956 | 1.949 | 0 |
| 8.72653765169258 |  1.54 | 0 |
|  8.4600988931679 | 1.347 | 0 |
| 8.30091303304343 | 2.028 | 0 |
| 7.75179268700943 | 1.589 | 0 |
| 9.24969184581068 | 0.297 | 0 |
|  10.009748013122 | 1.447 | 0 |
|  9.8122096322356 | 1.304 | 0 |
| 8.42355679006291 | 0.245 | 0 |
| 10.1079908487378 | 2.072 | 0 |
|   8.680896499261 | 1.267 | 0 |
| 8.86724269552051 |  0.94 | 0 |
| 6.94617952119047 | 3.309 | 1 |
| 9.42336166565866 | 0.914 | 0 |
| 7.42813947370509 | 0.442 | 1 |
| 7.26897726941827 | 0.244 | 1 |
| 10.0694938191989 | 0.016 | 0 |
| 7.52965884274144 |  1.54 | 0 |
| 6.14557308319006 | 0.498 | 1 |
| 8.43256602448309 |  1.75 | 0 |
| 9.33288980805469 |  1.56 | 0 |
| 9.73348954788061 | 2.496 | 0 |
| 10.1619936144723 | 0.715 | 0 |
| 8.45136210193868 | 3.063 | 1 |
|  9.7957614633364 | 4.885 | 1 |
| 8.08400584854355 | 0.756 | 0 |
| 6.71070579678357 | 0.419 | 1 |
| 7.27021197632532 |  0.28 | 1 |
| 8.74504723094039 | 1.051 | 0 |
| 6.66628099160818 | 5.301 | 0 |
| 8.20728050649637 | 0.284 | 0 |
| 8.79007487648232 | 0.773 | 0 |
| 9.10161486775605 | 0.603 | 0 |
| 8.74058487194385 | 0.726 | 1 |
| 8.78114911160438 |  2.62 | 0 |
| 6.25733611532716 | 0.677 | 1 |
| 7.12569652172451 | 0.913 | 1 |
| 8.32085952189036 | 0.416 | 0 |
|  9.0804045646234 | 0.435 | 0 |
| 10.4332380655578 | 1.073 | 0 |
| 7.32363793551301 | 0.526 | 0 |
| 8.58195212576103 | 3.071 | 0 |
| 8.64560751414128 | 0.634 | 0 |
| 7.60675678946259 | 2.054 | 0 |
| 8.06216171797244 | 1.729 | 0 |
| 8.48884906515704 | 1.677 | 0 |
|  6.6691795111983 | 2.323 | 0 |
| 9.15049715728167 | 1.761 | 1 |
| 6.65158479340291 | 0.533 | 1 |
| 7.82373196154797 | 1.194 | 1 |

** 8.3.2. Estimation

#+BEGIN_SRC R
m8.1stan <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dcauchy(0,2)
    ), data=dd.trim)

precis(m8.1stan)

#+END_SRC

#+RESULTS:

1. The interval boundaries are HPDI and not PI. 
2. n_eff (estiamte of number of samples) and rhat (estimate of the convergence). The
   latter should approach 1. 

** 8.3.3. Sampling again, in parallel.  

#+BEGIN_SRC R
m8.1stan_4chains <- map2stan(m8.1stan, chains=4, cores=4)
precis(m8.1stan_4chains)

#+END_SRC

#+RESULTS:

#+BEGIN_SRC R :results output graphics :file 8.8.png
#post <- extract.samples(m8.1stan)
#pairs(post)
pairs(m8.1stan)

#+END_SRC

#+RESULTS:
[[file:8.8.png]]

** 8.3.5. Using the samples
#+BEGIN_SRC R :results output
show(m8.1stan)

#+END_SRC

#+RESULTS:
#+begin_example
map2stan model fit
1000 samples from 1 chain

Formula:
log_gdp ~ dnorm(mu, sigma)
mu <- a + bR * rugged + bA * cont_africa + bAR * rugged * cont_africa
a ~ dnorm(0, 100)
bR ~ dnorm(0, 10)
bA ~ dnorm(0, 10)
bAR ~ dnorm(0, 10)
sigma ~ dcauchy(0, 2)

Log-likelihood at expected values: -229.44 
Deviance: 458.87 
DIC: 468.44 
Effective number of parameters (pD): 4.79 

WAIC (SE): 468.76 (14.8)
pWAIC: 4.8
#+end_example

** 8.3.6 Checking the chain
#+BEGIN_SRC R :results output graphics :file trace.png
plot(m8.1stan)
#+END_SRC

#+RESULTS:
[[file:trace.png]]

* 8.4. Care and feeding of your Markov Chain

** 8.4.1. How many samples do you need?
control the number of sampels from the chain using the *iter* and *warmup* parameters.

How many samples do we need?
1. What matters is the /effective/ number of samples, not the raw number. 
2. Depends on what you want to know. If all you want are posterior means, it doesn't take
   many samples to get good estimates. For skewed posteriors, you have to think about the
   region of the distribution that interest you. 

Half of the total samples to the warmup. 

** 8.4.2. How many chains do you need?
Chains specific the number of independent Markov chains to sample from. 
All of the non-warmup samples from each chain will be automatically combined in the
resulting inferences. 

Three answers
1. When debugging a model, use a single chain.
2. When deciding whether the chains are valid, you need more than one chain
3. When you begin the final run that you'll make inferences from, you only really need one
   chain. 

/four short chains to check, one long chain for inference/

Bad chains tend to have conspicious behavior. 

** 8.4.3. Taming a wild chain
#+BEGIN_SRC R :results output
y <- c(-1, 1)
m8.2 <- map2stan(alist(
                 y ~ dnorm(mu, sigma),
                 mu <- alpha),
data=list(y=y), start=list(alpha=0, sigma=1),
chains=2, iter=4000, warmup=1000)

#+END_SRC

#+RESULTS:
#+begin_example


SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.1e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 1: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 1: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 1: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 1: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 1: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 1: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 1: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 1: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.119424 seconds (Warm-up)
Chain 1:                0.974984 seconds (Sampling)
Chain 1:                1.09441 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 6e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 2: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 2: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 2: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 2: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 2: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 2: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 2: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 2: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.194534 seconds (Warm-up)
Chain 2:                1.01888 seconds (Sampling)
Chain 2:                1.21341 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 6e-06 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1e-06 seconds (Warm-up)
Chain 1:                9e-05 seconds (Sampling)
Chain 1:                9.1e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 600 / 6000 ][ 1200 / 6000 ][ 1800 / 6000 ][ 2400 / 6000 ][ 3000 / 6000 ][ 3600 / 6000 ][ 4200 / 6000 ][ 4800 / 6000 ][ 5400 / 6000 ][ 6000 / 6000 ]
Warning messages:
1: There were 279 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: There were 553 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See
http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded 
3: There were 2 chains where the estimated Bayesian Fraction of Missing Information was low. See
http://mc-stan.org/misc/warnings.html#bfmi-low 
4: Examine the pairs() plot to diagnose sampling problems
 
5: In map2stan(alist(y ~ dnorm(mu, sigma), mu <- alpha), data = list(y = y),  :
  There were 279 divergent iterations during sampling.
Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.
#+end_example

#+BEGIN_SRC R :results output graphics :file 8.2.png
plot(m8.2)

#+END_SRC

#+RESULTS:
[[file:8.2.png]]

#+BEGIN_SRC R :results output
m8.3 <- map2stan(
    alist(
        y ~ dnorm(mu, sigma),
        mu <- alpha,
        alpha ~ dnorm(1, 10),
        sigm ~ dcauchy(0, 1)
    ), data=list(y=y), start=list(alpha=0, sigma=1),
    chains=2, iter=4000, warmup=1000)

precis(m8.3)

#+END_SRC

#+RESULTS:
#+begin_example


SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.2e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 1: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 1: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 1: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 1: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 1: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 1: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 1: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 1: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.08932 seconds (Warm-up)
Chain 1:                0.120772 seconds (Sampling)
Chain 1:                0.210092 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 6e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 2: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 2: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 2: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 2: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 2: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 2: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 2: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 2: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.052098 seconds (Warm-up)
Chain 2:                0.105392 seconds (Sampling)
Chain 2:                0.15749 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 5e-06 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1e-06 seconds (Warm-up)
Chain 1:                4.6e-05 seconds (Sampling)
Chain 1:                4.7e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 600 / 6000 ][ 1200 / 6000 ][ 1800 / 6000 ][ 2400 / 6000 ][ 3000 / 6000 ][ 3600 / 6000 ][ 4200 / 6000 ][ 4800 / 6000 ][ 5400 / 6000 ][ 6000 / 6000 ]
Warning messages:
1: There were 3 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: There were 1 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See
http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded 
3: Examine the pairs() plot to diagnose sampling problems
 
4: In map2stan(alist(y ~ dnorm(mu, sigma), mu <- alpha, alpha ~ dnorm(1,  :
  There were 3 divergent iterations during sampling.
Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.

       Mean StdDev lower 0.89 upper 0.89 n_eff Rhat
alpha  0.03   5.38      -7.84       8.99  1234 1.00
sigma 27.59 164.31       0.52      38.81  2870 1.00
sigm  -3.29  45.54      -6.33       7.26   153 1.01
Warning message:
In precis(m8.3) : There were 3 divergent iterations during sampling.
Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.
#+end_example

#+BEGIN_SRC R :results output
y <- rnorm(100, mean=0, sd=1)

m8.4 <- map2stan(
    alist(
        y ~ dnorm(mu, sigma),
        mu <- a1 + a2,
        sigma ~ dcauchy(0, 1)
    ), data=list(y=y), start=list(a1=0, a2=0, sigma=1),
    chains=2, iter=4000, warmup=1000)

precis(m8.4)

#+END_SRC

#+RESULTS:
#+begin_example


SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.14 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 1: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 1: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 1: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 1: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 1: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 1: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 1: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 1: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2.8875 seconds (Warm-up)
Chain 1:                10.0971 seconds (Sampling)
Chain 1:                12.9846 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 1.3e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 2: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 2: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 2: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 2: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 2: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 2: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 2: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 2: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 2.63023 seconds (Warm-up)
Chain 2:                9.25347 seconds (Sampling)
Chain 2:                11.8837 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 7e-06 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                3.4e-05 seconds (Sampling)
Chain 1:                3.6e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 600 / 6000 ][ 1200 / 6000 ][ 1800 / 6000 ][ 2400 / 6000 ][ 3000 / 6000 ][ 3600 / 6000 ][ 4200 / 6000 ][ 4800 / 6000 ][ 5400 / 6000 ][ 6000 / 6000 ]
Warning messages:
1: There were 5037 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See
http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded 
2: Examine the pairs() plot to diagnose sampling problems
 
3: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
4: Examine the pairs() plot to diagnose sampling problems

         Mean StdDev lower 0.89 upper 0.89 n_eff Rhat
a1     578.94 613.97    -517.63    1376.60     3 1.69
a2    -578.83 613.98   -1376.41     517.82     3 1.69
sigma    1.01   0.07       0.89       1.11    70 1.01
#+end_example

#+BEGIN_SRC R :results output
m8.5 <- map2stan(
    alist(
        y ~ dnorm(mu, sigma),
        mu <- a1 + a2,
        a1 ~ dnorm(0, 10),
        a2 ~ dnorm(0, 10),
        sigma ~ dcauchy(0, 1)
    ), data=list(y=y), start=list(a1=0, a2=0, sigma=1),
    chains=2, iter=4000, warmup=1000)

precis(m8.5)


#+END_SRC

#+RESULTS:
#+begin_example


SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.7e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.17 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 1: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 1: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 1: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 1: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 1: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 1: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 1: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 1: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.838714 seconds (Warm-up)
Chain 1:                2.74289 seconds (Sampling)
Chain 1:                3.5816 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 6e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)
Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)
Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)
Chain 2: Iteration: 1001 / 4000 [ 25%]  (Sampling)
Chain 2: Iteration: 1400 / 4000 [ 35%]  (Sampling)
Chain 2: Iteration: 1800 / 4000 [ 45%]  (Sampling)
Chain 2: Iteration: 2200 / 4000 [ 55%]  (Sampling)
Chain 2: Iteration: 2600 / 4000 [ 65%]  (Sampling)
Chain 2: Iteration: 3000 / 4000 [ 75%]  (Sampling)
Chain 2: Iteration: 3400 / 4000 [ 85%]  (Sampling)
Chain 2: Iteration: 3800 / 4000 [ 95%]  (Sampling)
Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.76497 seconds (Warm-up)
Chain 2:                2.82407 seconds (Sampling)
Chain 2:                3.58904 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'y ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 2.2e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.22 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1e-06 seconds (Warm-up)
Chain 1:                3.1e-05 seconds (Sampling)
Chain 1:                3.2e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 600 / 6000 ][ 1200 / 6000 ][ 1800 / 6000 ][ 2400 / 6000 ][ 3000 / 6000 ][ 3600 / 6000 ][ 4200 / 6000 ][ 4800 / 6000 ][ 5400 / 6000 ][ 6000 / 6000 ]
Warning messages:
1: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: Examine the pairs() plot to diagnose sampling problems

      Mean StdDev lower 0.89 upper 0.89 n_eff Rhat
a1    0.09   7.01     -10.88      11.43  1653    1
a2    0.02   7.01     -11.28      11.05  1652    1
sigma 1.02   0.08       0.90       1.13  1921    1
#+end_example


* 8.6. Practice


#+BEGIN_SRC R :results none
library(rethinking)

#+END_SRC

#+RESULTS:
| rethinking  |
| parallel    |
| rstan       |
| StanHeaders |
| ggplot2     |
| stats       |
| graphics    |
| grDevices   |
| utils       |
| datasets    |
| methods     |
| base        |

** 8E1  
3. The proposal distribution must be symmetric for a simple Metropolis algorithm

** 8E2
It does this because it is directed, and it is also more efficient because it uses
/adaptive proposals/

** 8E3
HMC requires continuous parameters. It cannot use 'glide' process to go through parameters
when they are discretized. 

** 8E4
The effective is the number of independent samples, meaning samples that are not
autocorrelated. 

** 8E5
It should approach 1, not higher. 

** 8E6


** 8M1

#+BEGIN_SRC R

m8m1_unif <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dunif(0, 10)
    ), data=dd.trim)


m8m1_exp <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dexp(1)
    ), data=dd.trim)
#+END_SRC

#+RESULTS:

#+BEGIN_SRC R :results output graphics :file posteriors.png

sigma_unif <- extract.samples(m8m1_unif)
sigma_exp <- extract.samples(m8m1_exp)

dens(sigma_unif$sigma, xlab="sigma", xlim=c(0.5,1.5), col="red")
dens(sigma_exp$sigma, add=TRUE, col="blue")

#+END_SRC

#+RESULTS:
[[file:posteriors.png]]

The posteriors are very similar between uniform and exponential prior.

#+BEGIN_SRC R :results output graphics :file 8m2_cauchy.png

m8m1_cauchy10 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dcauchy(0, 10)
    ), data=dd.trim)


m8m1_cauchy5 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dcauchy(0, 5)
    ), data=dd.trim)


m8m1_cauchy1 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dcauchy(0, 1)
    ), data=dd.trim)


m8m1_cauchy01 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dcauchy(0, .1)
    ), data=dd.trim)


sigma_cauchy10 <- extract.samples(m8m1_cauchy10)
sigma_cauchy5 <- extract.samples(m8m1_cauchy5)
sigma_cauchy1 <- extract.samples(m8m1_cauchy1)
sigma_cauchy01 <- extract.samples(m8m1_cauchy01)

dens(sigma_cauchy10$sigma, xlab="sigma", xlim=c(0.5,1.5), col="red")
dens(sigma_cauchy5$sigma, add=TRUE, col="blue")
dens(sigma_cauchy1$sigma, add=TRUE, col="green")
dens(sigma_cauchy01$sigma, add=TRUE, col="black")


#+END_SRC

#+RESULTS:
[[file:8m2_cauchy.png]]

#+BEGIN_SRC R :results output graphics :file 8m2_dexp.png

m8m1_dexp10 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dexp(10)
    ), data=dd.trim)


m8m1_dexp5 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dexp(5)
    ), data=dd.trim)


m8m1_dexp1 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dexp(1)
    ), data=dd.trim)


m8m1_dexp01 <- map2stan(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
        a ~ dnorm(0, 100),
        bR ~ dnorm(0, 10),
        bA ~ dnorm(0, 10),
        bAR ~ dnorm(0, 10),
        sigma ~ dexp(.1)
    ), data=dd.trim)


sigma_dexp10 <- extract.samples(m8m1_dexp10)
sigma_dexp5 <- extract.samples(m8m1_dexp5)
sigma_dexp1 <- extract.samples(m8m1_dexp1)
sigma_dexp01 <- extract.samples(m8m1_dexp01)

dens(sigma_dexp10$sigma, xlab="sigma", xlim=c(0.7,1.2), col="red")
dens(sigma_dexp5$sigma, add=TRUE, col="blue")
dens(sigma_dexp1$sigma, add=TRUE, col="green")
dens(sigma_dexp01$sigma, add=TRUE, col="black")

#+END_SRC

#+RESULTS:
[[file:8m2_dexp.png]]

The priors became more assymetric

** 8M3
#+BEGIN_SRC R :results output
m <- map2stan(
  alist(
    log_gdp ~ dnorm( mu , sigma ) ,
    mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa ,
    a ~ dnorm(0,100),
    bR ~ dnorm(0,10),
    bA ~ dnorm(0,10),
    bAR ~ dnorm(0,10),
    sigma ~ dcauchy(0,2)
), data=dd.trim )


m.warmup1 <- map2stan(m, chains=4, cores=4, warmup=1, iter=1000)
m.warmup5 <- map2stan(m, chains=4, cores=4, warmup=5, iter=1000)
m.warmup10 <- map2stan(m, chains=4, cores=4, warmup=10, iter=1000)
m.warmup20 <- map2stan(m, chain=4, cores=4, warmup=20, iter=1000)
m.warmup50 <- map2stan(m, chains=4, cores=4, warmup=50, iter=1000)
m.warmup100 <- map2stan(m, chains=4, cores=4, warmup=100, iter=1000)
m.warmup200 <- map2stan(m, chains=4, cores=4, warmup=200, iter=1000)
m.warmup1000 <- map2stan(m, chains=4, cores=4, warmup=1000, iter=1000)

precis(m.warmup1)

#+END_SRC
Compare the n_eff values. At 50 they begin the rise and rhat goes to 1.

#+RESULTS:
#+begin_example

recompiling to avoid crashing R session

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 3.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.34 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.223805 seconds (Warm-up)
Chain 1:                0.226093 seconds (Sampling)
Chain 1:                0.449898 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 2.2e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.22 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0 seconds (Warm-up)
Chain 1:                6.1e-05 seconds (Sampling)
Chain 1:                6.1e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 100 / 1000 ][ 200 / 1000 ][ 300 / 1000 ][ 400 / 1000 ][ 500 / 1000 ][ 600 / 1000 ][ 700 / 1000 ][ 800 / 1000 ][ 900 / 1000 ][ 1000 / 1000 ]
Warning messages:
1: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: Examine the pairs() plot to diagnose sampling problems

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 2).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 3).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 4).
Chain 1: 
Chain 1: Gradient evaluation took 0.000116 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.16 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 3: 
Chain 2: 
Chain 3: Gradient evaluation took 0.000108 seconds
Chain 2Chain : 3Gradient evaluation took 9.8e-05 seconds: 
1000 transitions using 10 leapfrog steps per transition would take 1.08 seconds.Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.98 seconds.
Chain 2
: Adjust your expectations accordingly!
Chain Chain 32: : Adjust your expectations accordingly!

Chain 2Chain : 3
: 
Chain 3: 
Chain 4Chain : 2
: WARNING: No variance estimation is
Chain Chain 2Chain 3: : 1         performed for num_warmup < 20WARNING: No variance estimation is
: 
Chain Chain Iteration:   1 / 1000 [  0%]  (Warmup)23: 
: 
         performed for num_warmup < 20
Chain 3Chain : 
4: Gradient evaluation took 9.4e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.94 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: WARNING: No variance estimation is
Chain 4:          performed for num_warmup < 20
Chain 4: 
Chain 1: Iteration:   2 / 1000 [  0%]  (Sampling)
Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 3: Iteration:   2 / 1000 [  0%]  (Sampling)
Chain 2: Iteration:   2 / 1000 [  0%]  (Sampling)
Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 4: Iteration:   2 / 1000 [  0%]  (Sampling)
Chain 3: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 2: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 1: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 4: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 2: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 3: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 1: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 4: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 3: Iteration: 301 / 1000 [ 30%]  (Sampling)
Chain 2: Iteration: 301 / 1000 [ 30%]  (Sampling)
Chain 1: Iteration: 301 / 1000 [ 30%]  (Sampling)
Chain 4: Iteration: 301 / 1000 [ 30%]  (Sampling)
Chain 3: Iteration: 401 / 1000 [ 40%]  (Sampling)
Chain 2: Iteration: 401 / 1000 [ 40%]  (Sampling)
Chain 1: Iteration: 401 / 1000 [ 40%]  (Sampling)
Chain 4: Iteration: 401 / 1000 [ 40%]  (Sampling)
Chain 3: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 4: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 3: Iteration: 601 / 1000 [ 60%]  (Sampling)
Chain 2: Iteration: 601 / 1000 [ 60%]  (Sampling)
Chain 4: Iteration: 601 / 1000 [ 60%]  (Sampling)
Chain 1: Iteration: 601 / 1000 [ 60%]  (Sampling)
Chain 3: Iteration: 701 / 1000 [ 70%]  (Sampling)
Chain 4: Iteration: 701 / 1000 [ 70%]  (Sampling)
Chain 2: Iteration: 701 / 1000 [ 70%]  (Sampling)
Chain 1: Iteration: 701 / 1000 [ 70%]  (Sampling)
Chain 4: Iteration: 801 / 1000 [ 80%]  (Sampling)
Chain 3: Iteration: 801 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 801 / 1000 [ 80%]  (Sampling)
Chain 2: Iteration: 801 / 1000 [ 80%]  (Sampling)
Chain 4: Iteration: 901 / 1000 [ 90%]  (Sampling)
Chain 3: Iteration: 901 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 901 / 1000 [ 90%]  (Sampling)
Chain 2: Iteration: 901 / 1000 [ 90%]  (Sampling)
Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.000103 seconds (Warm-up)
Chain 4:                0.049223 seconds (Sampling)
Chain 4:                0.049326 seconds (Total)
Chain 4: 
Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 8.6e-05 seconds (Warm-up)
Chain 3:                0.050535 seconds (Sampling)
Chain 3:                0.050621 seconds (Total)
Chain 3: 
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.000187 seconds (Warm-up)
Chain 1:                0.051483 seconds (Sampling)
Chain 1:                0.05167 seconds (Total)
Chain 1: 
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.00034 seconds (Warm-up)
Chain 2:                0.051351 seconds (Sampling)
Chain 2:                0.051691 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.00029 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.9 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                7.1e-05 seconds (Sampling)
Chain 1:                7.3e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 399 / 3996 ][ 798 / 3996 ][ 1197 / 3996 ][ 1596 / 3996 ][ 1995 / 3996 ][ 2394 / 3996 ][ 2793 / 3996 ][ 3192 / 3996 ][ 3591 / 3996 ][ 3990 / 3996 ][ 3996 / 3996 ]
Warning messages:
1: There were 3996 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: Examine the pairs() plot to diagnose sampling problems
 
3: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
4: Examine the pairs() plot to diagnose sampling problems
 
5: In map2stan(m, chains = 4, cores = 4, warmup = 1, iter = 1000) :
  There were 3996 divergent iterations during sampling.
Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 
SAMPLING FOR MODEL '3log_gdp ~ dnorm(mu, sigma)).
' NOW (CHAIN 4).
Chain 1: 
Chain 1: Gradient evaluation took 9e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.9 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 2).
Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 3: 
Chain 3: Gradient evaluation took 8.3e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.83 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: WARNING: No variance estimation is
Chain 3:          performed for num_warmup < 20
Chain 3: 
Chain 4: 
Chain 2: 
Chain 4: Gradient evaluation took 0.000116 seconds
Chain 2: Chain Gradient evaluation took 7.8e-05 seconds4
: Chain 1000 transitions using 10 leapfrog steps per transition would take 1.16 seconds.2
: Chain 41000 transitions using 10 leapfrog steps per transition would take 0.78 seconds.: 
Adjust your expectations accordingly!Chain 
2: Chain Adjust your expectations accordingly!
4Chain : 2
: 
Chain Chain 42: : 

Chain 2Chain : WARNING: No variance estimation is4
: Chain WARNING: No variance estimation is2
:          performed for num_warmup < 20Chain 
Chain 42: :     
     performed for num_warmup < 20Chain 
1: Chain 4: 
Chain Iteration:   6 / 1000 [  0%]  (Sampling)
3: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 3: Iteration:   6 / 1000 [  0%]  (Sampling)
Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration:   6 / 1000 [  0%]  (Sampling)
Chain 4: Iteration:   6 / 1000 [  0%]  (Sampling)
Chain 3: Iteration: 105 / 1000 [ 10%]  (Sampling)
Chain 2: Iteration: 105 / 1000 [ 10%]  (Sampling)
Chain 4: Iteration: 105 / 1000 [ 10%]  (Sampling)
Chain 3: Iteration: 205 / 1000 [ 20%]  (Sampling)
Chain 1: Iteration: 105 / 1000 [ 10%]  (Sampling)
Chain 2: Iteration: 205 / 1000 [ 20%]  (Sampling)
Chain 4: Iteration: 205 / 1000 [ 20%]  (Sampling)
Chain 3: Iteration: 305 / 1000 [ 30%]  (Sampling)
Chain 2: Iteration: 305 / 1000 [ 30%]  (Sampling)
Chain 4: Iteration: 305 / 1000 [ 30%]  (Sampling)
Chain 1: Iteration: 205 / 1000 [ 20%]  (Sampling)
Chain 3: Iteration: 405 / 1000 [ 40%]  (Sampling)
Chain 2: Iteration: 405 / 1000 [ 40%]  (Sampling)
Chain 4: Iteration: 405 / 1000 [ 40%]  (Sampling)
Chain 3: Iteration: 505 / 1000 [ 50%]  (Sampling)
Chain 2: Iteration: 505 / 1000 [ 50%]  (Sampling)
Chain 1: Iteration: 305 / 1000 [ 30%]  (Sampling)
Chain 4: Iteration: 505 / 1000 [ 50%]  (Sampling)
Chain 3: Iteration: 605 / 1000 [ 60%]  (Sampling)
Chain 2: Iteration: 605 / 1000 [ 60%]  (Sampling)
Chain 4: Iteration: 605 / 1000 [ 60%]  (Sampling)
Chain 1: Iteration: 405 / 1000 [ 40%]  (Sampling)
Chain 3: Iteration: 705 / 1000 [ 70%]  (Sampling)
Chain 2: Iteration: 705 / 1000 [ 70%]  (Sampling)
Chain 4: Iteration: 705 / 1000 [ 70%]  (Sampling)
Chain 3: Iteration: 805 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 505 / 1000 [ 50%]  (Sampling)
Chain 2: Iteration: 805 / 1000 [ 80%]  (Sampling)
Chain 4: Iteration: 805 / 1000 [ 80%]  (Sampling)
Chain 3: Iteration: 905 / 1000 [ 90%]  (Sampling)
Chain 2: Iteration: 905 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 605 / 1000 [ 60%]  (Sampling)
Chain 4: Iteration: 905 / 1000 [ 90%]  (Sampling)Chain 
3: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.000532 seconds (Warm-up)
Chain 3:                0.051362 seconds (Sampling)
Chain 3:                0.051894 seconds (Total)
Chain 3: 
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.000908 seconds (Warm-up)
Chain 2:                0.053571 seconds (Sampling)
Chain 2:                0.054479 seconds (Total)
Chain 2: 
Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.00055 seconds (Warm-up)
Chain 4:                0.05527 seconds (Sampling)
Chain 4:                0.05582 seconds (Total)
Chain 4: 
Chain 1: Iteration: 705 / 1000 [ 70%]  (Sampling)
Chain 1: Iteration: 805 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 905 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.001159 seconds (Warm-up)
Chain 1:                0.08015 seconds (Sampling)
Chain 1:                0.081309 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 6.5e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.65 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                0.000185 seconds (Sampling)
Chain 1:                0.000187 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 398 / 3980 ][ 796 / 3980 ][ 1194 / 3980 ][ 1592 / 3980 ][ 1990 / 3980 ][ 2388 / 3980 ][ 2786 / 3980 ][ 3184 / 3980 ][ 3582 / 3980 ][ 3980 / 3980 ]
Warning messages:
1: There were 3386 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: There were 1 chains where the estimated Bayesian Fraction of Missing Information was low. See
http://mc-stan.org/misc/warnings.html#bfmi-low 
3: Examine the pairs() plot to diagnose sampling problems
 
4: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
5: Examine the pairs() plot to diagnose sampling problems
 
6: In map2stan(m, chains = 4, cores = 4, warmup = 5, iter = 1000) :
  There were 3386 divergent iterations during sampling.
Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 2).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 4).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 3).
Chain 1: 
Chain 1: Gradient evaluation took 9.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.94 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 2: 
Chain 2: Gradient evaluation took 9.1e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.91 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: WARNING: No variance estimation is
Chain 2:          performed for num_warmup < 20
Chain 2: 
Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 4: 
Chain 4: Gradient evaluation took 9.9e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.99 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: WARNING: No variance estimation is
Chain 4:          performed for num_warmup < 20
Chain 4: 
Chain 3: 
Chain 3: Gradient evaluation took 0.000113 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 1.13 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: WARNING: No variance estimation is
Chain 3:          performed for num_warmup < 20
Chain Chain 34: : 
Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 4: Iteration:  11 / 1000 [  1%]  (Sampling)
Chain 1: Iteration:  11 / 1000 [  1%]  (Sampling)
Chain 2: Iteration:  11 / 1000 [  1%]  (Sampling)
Chain 3: Iteration:  11 / 1000 [  1%]  (Sampling)
Chain 2: Iteration: 110 / 1000 [ 11%]  (Sampling)
Chain 2: Iteration: 210 / 1000 [ 21%]  (Sampling)
Chain 2: Iteration: 310 / 1000 [ 31%]  (Sampling)
Chain 2: Iteration: 410 / 1000 [ 41%]  (Sampling)
Chain 2: Iteration: 510 / 1000 [ 51%]  (Sampling)
Chain 2: Iteration: 610 / 1000 [ 61%]  (Sampling)
Chain 2: Iteration: 710 / 1000 [ 71%]  (Sampling)
Chain 2: Iteration: 810 / 1000 [ 81%]  (Sampling)
Chain 3: Iteration: 110 / 1000 [ 11%]  (Sampling)
Chain 2: Iteration: 910 / 1000 [ 91%]  (Sampling)
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.013876 seconds (Warm-up)
Chain 2:                0.045112 seconds (Sampling)
Chain 2:                0.058988 seconds (Total)
Chain 2: 
Chain 3: Iteration: 210 / 1000 [ 21%]  (Sampling)
Chain 3: Iteration: 310 / 1000 [ 31%]  (Sampling)
Chain 1: Iteration: 110 / 1000 [ 11%]  (Sampling)
Chain 3: Iteration: 410 / 1000 [ 41%]  (Sampling)
Chain 3: Iteration: 510 / 1000 [ 51%]  (Sampling)
Chain 4: Iteration: 110 / 1000 [ 11%]  (Sampling)
Chain 1: Iteration: 210 / 1000 [ 21%]  (Sampling)
Chain 3: Iteration: 610 / 1000 [ 61%]  (Sampling)
Chain 3: Iteration: 710 / 1000 [ 71%]  (Sampling)
Chain 3: Iteration: 810 / 1000 [ 81%]  (Sampling)
Chain 1: Iteration: 310 / 1000 [ 31%]  (Sampling)
Chain 4: Iteration: 210 / 1000 [ 21%]  (Sampling)
Chain 3: Iteration: 910 / 1000 [ 91%]  (Sampling)
Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.01751 seconds (Warm-up)
Chain 3:                0.228766 seconds (Sampling)
Chain 3:                0.246276 seconds (Total)
Chain 3: 
Chain 1: Iteration: 410 / 1000 [ 41%]  (Sampling)
Chain 4: Iteration: 310 / 1000 [ 31%]  (Sampling)
Chain 1: Iteration: 510 / 1000 [ 51%]  (Sampling)
Chain 4: Iteration: 410 / 1000 [ 41%]  (Sampling)
Chain 1: Iteration: 610 / 1000 [ 61%]  (Sampling)
Chain 4: Iteration: 510 / 1000 [ 51%]  (Sampling)
Chain 1: Iteration: 710 / 1000 [ 71%]  (Sampling)
Chain 4: Iteration: 610 / 1000 [ 61%]  (Sampling)
Chain 1: Iteration: 810 / 1000 [ 81%]  (Sampling)
Chain 4: Iteration: 710 / 1000 [ 71%]  (Sampling)
Chain 1: Iteration: 910 / 1000 [ 91%]  (Sampling)
Chain 4: Iteration: 810 / 1000 [ 81%]  (Sampling)
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.003251 seconds (Warm-up)
Chain 1:                0.601762 seconds (Sampling)
Chain 1:                0.605013 seconds (Total)
Chain 1: 
Chain 4: Iteration: 910 / 1000 [ 91%]  (Sampling)
Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.001466 seconds (Warm-up)
Chain 4:                0.677012 seconds (Sampling)
Chain 4:                0.678478 seconds (Total)
Chain 4: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000812 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 8.12 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 1e-06 seconds (Warm-up)
Chain 1:                7.8e-05 seconds (Sampling)
Chain 1:                7.9e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 396 / 3960 ][ 792 / 3960 ][ 1188 / 3960 ][ 1584 / 3960 ][ 1980 / 3960 ][ 2376 / 3960 ][ 2772 / 3960 ][ 3168 / 3960 ][ 3564 / 3960 ][ 3960 / 3960 ]
Warning messages:
1: There were 990 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: There were 1 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See
http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded 
3: There were 3 chains where the estimated Bayesian Fraction of Missing Information was low. See
http://mc-stan.org/misc/warnings.html#bfmi-low 
4: Examine the pairs() plot to diagnose sampling problems
 
5: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
6: Examine the pairs() plot to diagnose sampling problems
 
7: In map2stan(m, chains = 4, cores = 4, warmup = 10, iter = 1000) :
  There were 990 divergent iterations during sampling.
Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1
).
SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 2).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 4).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 3).
Chain 1: 
Chain 1: Gradient evaluation took 0.000119 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.19 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: There aren't enough warmup iterations to fit the
Chain 1:          three stages of adaptation as currently configured.
Chain 1Chain :          Reducing each adaptation stage to 15%/75%/10% of4
: 
Chain 1:          the given number of warmup iterations:
Chain 1:            init_buffer = 7
Chain Chain 14: :            adapt_window = 38
Gradient evaluation took 0.000131 seconds
Chain 1Chain : 4           term_buffer = 5: 
1000 transitions using 10 leapfrog steps per transition would take 1.31 seconds.Chain 
1Chain : 4
: Adjust your expectations accordingly!
Chain 4: 
Chain 4: Chain 
2: 
Chain 2: Chain 4Gradient evaluation took 8.2e-05 seconds: 
WARNING: There aren't enough warmup iterations to fit the
Chain 2Chain : 4:          three stages of adaptation as currently configured.
Chain 4:          Reducing each adaptation stage to 15%/75%/10% of
Chain 4:          the given number of warmup iterations:1000 transitions using 10 leapfrog steps per transition would take 0.82 seconds.
Chain 
4: Chain            init_buffer = 72
: Adjust your expectations accordingly!Chain 
4Chain : 2:            adapt_window = 38

Chain 2Chain : 
4:            term_buffer = 5
Chain 4: 
Chain 2: WARNING: There aren't enough warmup iterations to fit the
Chain 2:          three stages of adaptation as currently configured.
Chain 2:          Reducing each adaptation stage to 15%/75%/10% of
Chain 2: Chain          the given number of warmup iterations:
1: Chain 2Iteration:   1 / 1000 [  0%]  (Warmup): 
           init_buffer = 7
Chain 2:            adapt_window = 38
Chain 2:            term_buffer = 5
Chain 2: 
Chain 3: 
Chain 3: Gradient evaluation took 7.8e-05 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.78 seconds.Chain Chain 
42Chain : : 3Iteration:   1 / 1000 [  0%]  (Warmup)Iteration:   1 / 1000 [  0%]  (Warmup): 

Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: WARNING: There aren't enough warmup iterations to fit the
Chain 3:          three stages of adaptation as currently configured.
Chain 3:          Reducing each adaptation stage to 15%/75%/10% of
Chain 3:          the given number of warmup iterations:
Chain 3:            init_buffer = 7
Chain 3:            adapt_window = 38
Chain 3:            term_buffer = 5
Chain 3: 
Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration:  51 / 1000 [  5%]  (Sampling)
Chain 3: Iteration:  51 / 1000 [  5%]  (Sampling)
Chain 1: Iteration:  51 / 1000 [  5%]  (Sampling)
Chain 2: Iteration: 150 / 1000 [ 15%]  (Sampling)
Chain 3: Iteration: 150 / 1000 [ 15%]  (Sampling)
Chain 4: Iteration:  51 / 1000 [  5%]  (Sampling)
Chain 2: Iteration: 250 / 1000 [ 25%]  (Sampling)
Chain 1: Iteration: 150 / 1000 [ 15%]  (Sampling)
Chain 3: Iteration: 250 / 1000 [ 25%]  (Sampling)
Chain 4: Iteration: 150 / 1000 [ 15%]  (Sampling)
Chain 1: Iteration: 250 / 1000 [ 25%]  (Sampling)
Chain 2: Iteration: 350 / 1000 [ 35%]  (Sampling)
Chain 3: Iteration: 350 / 1000 [ 35%]  (Sampling)
Chain 4: Iteration: 250 / 1000 [ 25%]  (Sampling)
Chain 1: Iteration: 350 / 1000 [ 35%]  (Sampling)
Chain 2: Iteration: 450 / 1000 [ 45%]  (Sampling)
Chain 4: Iteration: 350 / 1000 [ 35%]  (Sampling)
Chain 3: Iteration: 450 / 1000 [ 45%]  (Sampling)
Chain 1: Iteration: 450 / 1000 [ 45%]  (Sampling)
Chain 2: Iteration: 550 / 1000 [ 55%]  (Sampling)
Chain 4: Iteration: 450 / 1000 [ 45%]  (Sampling)
Chain 3: Iteration: 550 / 1000 [ 55%]  (Sampling)
Chain 1: Iteration: 550 / 1000 [ 55%]  (Sampling)
Chain 2: Iteration: 650 / 1000 [ 65%]  (Sampling)
Chain 4: Iteration: 550 / 1000 [ 55%]  (Sampling)
Chain 3: Iteration: 650 / 1000 [ 65%]  (Sampling)
Chain 1: Iteration: 650 / 1000 [ 65%]  (Sampling)
Chain 2: Iteration: 750 / 1000 [ 75%]  (Sampling)
Chain 4: Iteration: 650 / 1000 [ 65%]  (Sampling)
Chain 3: Iteration: 750 / 1000 [ 75%]  (Sampling)
Chain 1: Iteration: 750 / 1000 [ 75%]  (Sampling)
Chain 4: Iteration: 750 / 1000 [ 75%]  (Sampling)
Chain 2: Iteration: 850 / 1000 [ 85%]  (Sampling)
Chain 1: Iteration: 850 / 1000 [ 85%]  (Sampling)
Chain 3: Iteration: 850 / 1000 [ 85%]  (Sampling)
Chain 4: Iteration: 850 / 1000 [ 85%]  (Sampling)
Chain 2: Iteration: 950 / 1000 [ 95%]  (Sampling)
Chain 1: Iteration: 950 / 1000 [ 95%]  (Sampling)
Chain 3: Iteration: 950 / 1000 [ 95%]  (Sampling)
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.021067 seconds (Warm-up)
Chain 2:                0.242226 seconds (Sampling)
Chain 2:                0.263293 seconds (Total)
Chain 2: 
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.047291 seconds (Warm-up)
Chain 1:                0.221 seconds (Sampling)
Chain 1:                0.268291 seconds (Total)
Chain 1: 
Chain 4: Iteration: 950 / 1000 [ 95%]  (Sampling)
Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.020908 seconds (Warm-up)
Chain 3:                0.257042 seconds (Sampling)
Chain 3:                0.27795 seconds (Total)
Chain 3: 
Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.057722 seconds (Warm-up)
Chain 4:                0.222342 seconds (Sampling)
Chain 4:                0.280064 seconds (Total)
Chain 4: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000757 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 7.57 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                6.6e-05 seconds (Sampling)
Chain 1:                6.8e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 380 / 3800 ][ 760 / 3800 ][ 1140 / 3800 ][ 1520 / 3800 ][ 1900 / 3800 ][ 2280 / 3800 ][ 2660 / 3800 ][ 3040 / 3800 ][ 3420 / 3800 ][ 3800 / 3800 ]
Warning messages:
1: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: Examine the pairs() plot to diagnose sampling problems

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 2).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 4).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 3).
Chain 2: 
Chain 2: Gradient evaluation took 0.000134 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.34 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain Chain 21: : WARNING: There aren't enough warmup iterations to fit the

Chain 2:          three stages of adaptation as currently configured.
Chain 2:          Reducing each adaptation stage to 15%/75%/10% of
Chain 2:          the given number of warmup iterations:
Chain 2:            init_buffer = 15
Chain 2:            adapt_window = 75Chain 
Chain 12: :            term_buffer = 10Gradient evaluation took 0.000155 seconds

Chain 2: 
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.55 seconds.
Chain 1Chain : Adjust your expectations accordingly!4
: 
Chain 1: 
Chain 1: 
Chain 4: Gradient evaluation took 0.000112 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 1.12 seconds.
Chain 4Chain : Adjust your expectations accordingly!1
: Chain WARNING: There aren't enough warmup iterations to fit the4
: Chain 
1Chain : 4         three stages of adaptation as currently configured.: 

Chain 1:          Reducing each adaptation stage to 15%/75%/10% of
Chain Chain Chain 124: : :          the given number of warmup iterations:WARNING: There aren't enough warmup iterations to fit the

Chain Iteration:   1 / 1000 [  0%]  (Warmup)
3Chain : 1
:            init_buffer = 15
Chain Chain 41: :          three stages of adaptation as currently configured.
           adapt_window = 75
Chain 4Chain : Chain 3         Reducing each adaptation stage to 15%/75%/10% of1: 
: Chain            term_buffer = 104Gradient evaluation took 9.3e-05 seconds: 

         the given number of warmup iterations:Chain 
Chain 1Chain 3: 4: 
:            init_buffer = 151000 transitions using 10 leapfrog steps per transition would take 0.93 seconds.

Chain Chain 43: :            adapt_window = 75Adjust your expectations accordingly!

Chain Chain 34: : 
           term_buffer = 10Chain 
3Chain : 4
: 
Chain 3: WARNING: There aren't enough warmup iterations to fit the
Chain 3:          three stages of adaptation as currently configured.
Chain 3:          Reducing each adaptation stage to 15%/75%/10% ofChain Chain 
41: : Chain Iteration:   1 / 1000 [  0%]  (Warmup)3
Iteration:   1 / 1000 [  0%]  (Warmup)
:          the given number of warmup iterations:
Chain 3:            init_buffer = 15
Chain 3:            adapt_window = 75
Chain 3:            term_buffer = 10
Chain 3: 
Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 2: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 4: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 3: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 2: Iteration: 200 / 1000 [ 20%]  (Sampling)
Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)Chain 
4: Iteration: 200 / 1000 [ 20%]  (Sampling)
Chain 1: Iteration: 101 / 1000 [ 10%]  (Sampling)
Chain 3: Iteration: 200 / 1000 [ 20%]  (Sampling)
Chain 4: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 2: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 1: Iteration: 200 / 1000 [ 20%]  (Sampling)
Chain 3: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 2: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 4: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 1: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 3: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 2: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 4: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 1: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 3: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 1: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.04071 seconds (Warm-up)
Chain 4:                0.218312 seconds (Sampling)
Chain 4:                0.259022 seconds (Total)
Chain 4: 
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.042726 seconds (Warm-up)
Chain 2:                0.220972 seconds (Sampling)
Chain 2:                0.263698 seconds (Total)
Chain 2: 
Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.052381 seconds (Warm-up)
Chain 3:                0.230176 seconds (Sampling)
Chain 3:                0.282557 seconds (Total)
Chain 3: 
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.065918 seconds (Warm-up)
Chain 1:                0.23167 seconds (Sampling)
Chain 1:                0.297588 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000705 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 7.05 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                7.3e-05 seconds (Sampling)
Chain 1:                7.5e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 360 / 3600 ][ 720 / 3600 ][ 1080 / 3600 ][ 1440 / 3600 ][ 1800 / 3600 ][ 2160 / 3600 ][ 2520 / 3600 ][ 2880 / 3600 ][ 3240 / 3600 ][ 3600 / 3600 ]
Warning messages:
1: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: Examine the pairs() plot to diagnose sampling problems

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 3).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 2).
Chain 1: 
Chain 1: Gradient evaluation took 0.000118 seconds
Chain Chain 31: : 
1000 transitions using 10 leapfrog steps per transition would take 1.18 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain Chain 31: : Gradient evaluation took 0.000108 seconds

Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 1.08 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 2: 
Chain 2: Gradient evaluation took 0.000107 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.07 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 4).
Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 4: 
Chain 4: Gradient evaluation took 8.2e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.82 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 3: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 2: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 4: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 3: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 2: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 1: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 4: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 4: Iteration: 201 / 1000 [ 20%]  (Sampling)
Chain 2: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 3: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 1: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 4: Iteration: 300 / 1000 [ 30%]  (Sampling)
Chain 2: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 3: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 1: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 4: Iteration: 400 / 1000 [ 40%]  (Sampling)
Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 1: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 4: Iteration: 500 / 1000 [ 50%]  (Sampling)
Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 4: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 4: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 4: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.060654 seconds (Warm-up)
Chain 2:                0.214667 seconds (Sampling)
Chain 2:                0.275321 seconds (Total)
Chain 2: 
Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.058267 seconds (Warm-up)
Chain 3:                0.220595 seconds (Sampling)
Chain 3:                0.278862 seconds (Total)
Chain 3: 
Chain 4: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.094021 seconds (Warm-up)
Chain 1:                0.22299 seconds (Sampling)
Chain 1:                0.317011 seconds (Total)
Chain 1: 
Chain 4: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.09787 seconds (Warm-up)
Chain 4:                0.217986 seconds (Sampling)
Chain 4:                0.315856 seconds (Total)
Chain 4: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 0.000798 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 7.98 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                8.3e-05 seconds (Sampling)
Chain 1:                8.5e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 320 / 3200 ][ 640 / 3200 ][ 960 / 3200 ][ 1280 / 3200 ][ 1600 / 3200 ][ 1920 / 3200 ][ 2240 / 3200 ][ 2560 / 3200 ][ 2880 / 3200 ][ 3200 / 3200 ]
Warning messages:
1: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
2: Examine the pairs() plot to diagnose sampling problems

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 
SAMPLING3 FOR MODEL ').
log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 2).
Chain 2: 
Chain 3: 
Chain 2: Gradient evaluation took 7.9e-05 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.79 seconds.
Chain Chain 2: 3Adjust your expectations accordingly!: 
Chain Gradient evaluation took 9.1e-05 seconds2
: 
Chain Chain 23: : 
1000 transitions using 10 leapfrog steps per transition would take 0.91 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 1: 
Chain 1: Gradient evaluation took 8.6e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.86 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 4).
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: 
Chain 4: Gradient evaluation took 6.8e-05 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.68 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.234609 seconds (Warm-up)
Chain 3:                0.254201 seconds (Sampling)
Chain 3:                0.48881 seconds (Total)
Chain 3: 
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.239729 seconds (Warm-up)
Chain 4:                0.250852 seconds (Sampling)
Chain 4:                0.490581 seconds (Total)
Chain 4: 
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.249077 seconds (Warm-up)
Chain 2:                0.285494 seconds (Sampling)
Chain 2:                0.534571 seconds (Total)
Chain 2: 
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.24049 seconds (Warm-up)
Chain 1:                0.306096 seconds (Sampling)
Chain 1:                0.546586 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'log_gdp ~ dnorm(mu, sigma)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 4.3e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.43 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                7e-05 seconds (Sampling)
Chain 1:                7.2e-05 seconds (Total)
Chain 1: 
Computing WAIC
Constructing posterior predictions
[ 400 / 4000 ][ 800 / 4000 ][ 1200 / 4000 ][ 1600 / 4000 ][ 2000 / 4000 ][ 2400 / 4000 ][ 2800 / 4000 ][ 3200 / 4000 ][ 3600 / 4000 ][ 4000 / 4000 ]
Warning messages:
1: In map2stan(m, chains = 4, cores = 4, warmup = 1000, iter = 1000) :
  'iter' less than or equal to 'warmup'. Setting 'iter' to sum of 'iter' and 'warmup' instead (2000).
2: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help. See
http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup 
3: Examine the pairs() plot to diagnose sampling problems

       Mean StdDev lower 0.89 upper 0.89 n_eff         Rhat
a     -0.16  52.96     -90.51      39.87     2 3.439500e+14
bR     9.67   4.74       3.48      15.88     2 1.368092e+14
bA     1.43   7.41      -7.83      12.07     2 2.730022e+14
bAR   -7.01   4.64     -10.96       0.75     2 1.185151e+14
sigma 12.51  13.04       0.07      33.86   NaN 2.422987e+14
Warning message:
In precis(m.warmup1) :
  There were 3996 divergent iterations during sampling.
Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.
#+end_example

** 8H1

#+BEGIN_SRC R :results output
mp <- map2stan(
    alist(
        a ~ dnorm(0,1),
        b ~ dcauchy(0,1)
    ),
    data=list(y=1),
    start=list(a=0,b=0),
    iter=1e4, warmup=100 , WAIC=FALSE )

#+END_SRC

#+RESULTS:
#+begin_example

recompiling to avoid crashing R session

SAMPLING FOR MODEL 'a ~ dnorm(0, 1)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: There aren't enough warmup iterations to fit the
Chain 1:          three stages of adaptation as currently configured.
Chain 1:          Reducing each adaptation stage to 15%/75%/10% of
Chain 1:          the given number of warmup iterations:
Chain 1:            init_buffer = 15
Chain 1:            adapt_window = 75
Chain 1:            term_buffer = 10
Chain 1: 
Chain 1: Iteration:    1 / 10000 [  0%]  (Warmup)
Chain 1: Iteration:  101 / 10000 [  1%]  (Sampling)
Chain 1: Iteration: 1100 / 10000 [ 11%]  (Sampling)
Chain 1: Iteration: 2100 / 10000 [ 21%]  (Sampling)
Chain 1: Iteration: 3100 / 10000 [ 31%]  (Sampling)
Chain 1: Iteration: 4100 / 10000 [ 41%]  (Sampling)
Chain 1: Iteration: 5100 / 10000 [ 51%]  (Sampling)
Chain 1: Iteration: 6100 / 10000 [ 61%]  (Sampling)
Chain 1: Iteration: 7100 / 10000 [ 71%]  (Sampling)
Chain 1: Iteration: 8100 / 10000 [ 81%]  (Sampling)
Chain 1: Iteration: 9100 / 10000 [ 91%]  (Sampling)
Chain 1: Iteration: 10000 / 10000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.001857 seconds (Warm-up)
Chain 1:                0.252914 seconds (Sampling)
Chain 1:                0.254771 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'a ~ dnorm(0, 1)' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 8e-06 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.08 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: WARNING: No variance estimation is
Chain 1:          performed for num_warmup < 20
Chain 1: 
Chain 1: Iteration: 1 / 1 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 2e-06 seconds (Warm-up)
Chain 1:                5.8e-05 seconds (Sampling)
Chain 1:                6e-05 seconds (Total)
Chain 1: 
Warning messages:
1: There were 15 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See
http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded 
2: Examine the pairs() plot to diagnose sampling problems
#+end_example

#+BEGIN_SRC R :results output graphics :height 300 :width 500 :file 8h1.png
plot(mp)
#precis(mp)
#+END_SRC

#+RESULTS:
[[file:8h1.png]]

The plot for Cauchy is not as stable, more extreme values. Rhat is also 1.01 and effective
samples lower. 

** 8H2
#+BEGIN_SRC R
options(mc.cores = parallel::detectCores())
data(WaffleDivorce)
d <- WaffleDivorce

d$MedianAgeMarriage_s <- (d$MedianAgeMarriage-mean(d$MedianAgeMarriage))/
    sd(d$MedianAgeMarriage)

d$Marriage_s <- (d$Marriage - mean(d$Marriage))/sd(d$Marriage)

d_trim <- d[, c("Divorce", "MedianAgeMarriage_s", "Marriage_s")]


m5.1 <- map2stan(
    alist(
        Divorce ~ dnorm( mu , sigma ) ,
        mu <- a + bA * MedianAgeMarriage_s ,
        a ~ dnorm( 10 , 10 ) ,
        bA ~ dnorm( 0 , 1 ) ,
        sigma ~ dunif( 0 , 10 )
) , data = d_trim, chains=4, cores=4 )

m5.2 <- map2stan(
    alist(
        Divorce ~ dnorm( mu , sigma ) ,
        mu <- a + bR * Marriage_s ,
        a ~ dnorm( 10 , 10 ) ,
        bR ~ dnorm(0, 1),
        sigma ~ dunif(0, 10)
    ), data =d_trim, chains=4, cores=4)

m5.3 <- map2stan(
    alist(
        Divorce ~ dnorm( mu , sigma ) ,
        mu <- a + bR*Marriage_s + bA*MedianAgeMarriage_s ,
        a ~ dnorm( 10 , 10 ) ,
        bR ~ dnorm( 0 , 1 ) ,
        bA ~ dnorm( 0 , 1 ) ,
        sigma ~ dunif( 0 , 10 )
),
    data = d_trim, chains=4, cores=4)
#+END_SRC

#+RESULTS:
: org_babel_R_eoe

#+BEGIN_SRC R
compare(m5.1, m5.2, m5.3)

#+END_SRC

M5.1 best, than 5.2, most weight

#+BEGIN_SRC R
rstan_options(auto_write =TRUE)

N <- 100
height <- rnorm(N,10,2)
leg_prop <- runif(N,0.4,0.5)
leg_left <- leg_prop*height +
    rnorm( N , 0 , 0.02 )
leg_right <- leg_prop*height +
    rnorm( N , 0 , 0.02 )
d <- data.frame(height,leg_left,leg_right)

m5.8s <- map2stan(
    alist(
        height ~ dnorm( mu , sigma ) ,
        mu <- a + bl*leg_left + br*leg_right ,
        a ~ dnorm( 10 , 100 ) ,
        bl ~ dnorm( 2 , 10 ) ,
        br ~ dnorm( 2 , 10 ) ,
        sigma ~ dcauchy( 0 , 1 )
),
data=d, chains=4, cores=4, start=list(a=10,bl=0,br=0,sigma=1) )

#+END_SRC

#+RESULTS:

#+BEGIN_SRC R
m5.8s2 <- map2stan(
    alist(
        height ~ dnorm( mu , sigma ) ,
        mu <- a + bl*leg_left + br*leg_right ,
        a ~ dnorm( 10 , 100 ) ,
        bl ~ dnorm( 2 , 10 ) ,
        br ~ dnorm( 2 , 10 ) & T[0,] ,
        sigma ~ dcauchy( 0 , 1 )
),
data=d, chains=4, cores=4, start=list(a=10,bl=0,br=0,sigma=1) )
#+END_SRC

#+BEGIN_SRC R :results output graphics :file pairs1.png
pairs(m5.8s)
#+END_SRC

#+RESULTS:
[[file:pairs1.png]]

#+BEGIN_SRC R :results output graphics :file pairs2.png
pairs(m5.8s2)
#+END_SRC

#+RESULTS:
[[file:pairs2.png]]

BL is pushed to the right and br to the left, due to to directed prior. 

** 8H4
#+BEGIN_SRC R :results output
compare(m5.8s, m5.8s2)
#+END_SRC

#+RESULTS:
:         WAIC pWAIC dWAIC weight    SE   dSE
: m5.8s2 199.0   3.1   0.0      1 10.37    NA
: m5.8s  211.7   3.3  12.7      0 11.43 15.81

#+BEGIN_SRC R :results output 
precis(m5.8s)

#+END_SRC

#+RESULTS:
:        Mean StdDev lower 0.89 upper 0.89 n_eff Rhat
: a      0.82   0.35       0.24       1.35  2130    1
: bl     5.35   2.53       1.36       9.44  1413    1
: br    -3.31   2.51      -7.38       0.62  1419    1
: sigma  0.69   0.05       0.61       0.77  2166    1

#+BEGIN_SRC R :results output
precis(m5.8s2)

#+END_SRC

#+RESULTS:
:        Mean StdDev lower 0.89 upper 0.89 n_eff Rhat
: a      0.63   0.33       0.08       1.11  1459 1.00
: bl    -1.29   1.91      -3.89       1.98   659 1.01
: br     3.35   1.91       0.10       5.97   653 1.01
: sigma  0.65   0.05       0.58       0.72  1805 1.00
: Warning message:
: In precis(m5.8s2) : There were 720 divergent iterations during sampling.
: Check the chains (trace plots, n_eff, Rhat) carefully to ensure they are valid.

Less effective parameters, because of the split enforced by the directed prior.
However, the rhat is too high for m5.8s2

** 8H5
#+BEGIN_SRC R :results output
num_weeks <- 1e5
positions <- rep(0,num_weeks)

islands <- data.frame(id=1:10, pop=sample(1:10, 10, replace=F))

current <- 10
for ( i in 1:num_weeks ) {
    # record current position
    positions[i] <- current
    # flip coin to generate proposal
    proposal <- current + sample( c(-1,1) , size=1 )
    # now make sure he loops around the archipelago
    if ( proposal < 1 ) proposal <- 10
    if ( proposal > 10 ) proposal <- 1
    # move?
    prob_move <- islands$pop[proposal]/islands$pop[current]
    current <- ifelse( runif(1) < prob_move , proposal , current )
}
#+END_SRC

#+RESULTS:
