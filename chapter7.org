#+AUTHOR: Melvin Wevers
#+TITLE: Chapter 7. Interactions
#+PROPERTY: header-args :session :results value :cache no :exports both

#+BEGIN_SRC R
library(rethinking)

#+END_SRC

#+RESULTS:
| rethinking  |
| parallel    |
| rstan       |
| StanHeaders |
| ggplot2     |
| stats       |
| graphics    |
| grDevices   |
| utils       |
| datasets    |
| methods     |
| base        |

*Conditioning* is one of the most important principles of statistical inference. Data are
 conditional on how they get into our sample. Posterior distributions are conditional on
 the data. all model-based inference is conditional on the model. 

Linear models give us a way to describe conditionality. However, they frequently fail to
provide enough conditioning. Thus far we assumed that each predictor has an *independent*
association with the mean of the outcome. 

*Interaction* is a kind of conditioning of allowing posterior distributions to be
 conditional on aspects of the data. 

Multilevel models are massive interaction models in which estimates (intercepts and
slopes) are conditional on clusters (person, village, etc) in the data. 

* 7.1 Building an interaction

#+BEGIN_SRC R 
data(rugged)
d <- rugged

                                        #make log version of outcome
d$log_gdp <- log(d$rgdppc_2000)

                                        #extract countries with GDP data
dd <- d[complete.cases(d$rgdppc_2000),]

                                        #split into africa and not-africa
d.A1 <- dd[dd$cont_africa==1, ] #africa
d.A0 <- dd[dd$cont_africa==0, ] # not Africa

#+END_SRC

#+RESULTS:
| ALB |   8 | Albania                                              | 3.427 | 1.597 | 10.451 | 1.006 | 62.133 |    2740 |  41.143 |    20.07 | 68.088 |      0 |      0 | 0.048 | 94.6919 |      0 |  3703.113 |  1001.339 |  2289.472 |   2741.42 |  1931.784 |  -0.82 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   200000 |    100 | 8.21692909624602 |
| ARE | 784 | United Arab Emirates                                 | 0.769 | 0.316 |  2.112 | 0.191 |  6.142 |    8360 |  23.913 |   54.331 |      0 |  77.28 |      0 | 0.065 | 75.7464 |      0 |  20604.46 | 15797.558 | 25465.002 | 17567.883 | 20119.992 |  0.913 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    19200 |      0 | 9.93326283619825 |
| ARG |  32 | Argentina                                            | 0.775 |  0.22 |  2.268 | 0.226 |  9.407 |  273669 | -35.396 |   -65.17 | 35.678 |      0 |      0 | 0.352 | 13.0167 |      0 |  12173.68 |  4986.725 |  8122.497 |  8543.558 |   6926.81 |  0.033 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   276632 | 89.889 | 9.40703152318187 |
| ARM |  51 | Armenia                                              | 2.688 | 0.934 |  8.178 | 0.799 | 50.556 |    2820 |  40.294 |   44.938 | 30.148 |      0 |      0 | 0.348 |       0 |      0 |  2421.985 |       nil |       nil |  4565.035 |       nil | -0.453 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   105743 |    0.5 | 7.79234273086512 |
| ATG |  28 | Antigua and Barbuda                                  | 0.006 | 0.003 |  0.012 | 0.003 |      0 |      44 |  17.271 |    -61.8 |    100 |      0 |    100 | 0.001 |     100 |      0 |  10022.03 |       nil |       nil |       nil |       nil |   0.99 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |      747 |    nil | 9.21254094892968 |
| AUS |  36 | Australia                                            | 0.143 | 0.183 |  0.405 | 0.045 |  0.685 |  768230 | -25.733 |  134.487 | 14.248 | 10.889 |  14.68 | 0.336 | 20.9399 | 264154 |  25417.44 |  7411.577 |  13169.83 | 21605.334 | 13184.232 |  1.773 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   200000 | 89.954 | 10.1431908315682 |
| AUT |  40 | Austria                                              | 3.513 | 1.152 | 11.095 | 1.008 | 54.307 |    8245 |  47.589 |    14.14 | 55.098 |      0 |      0 | 0.242 | 2.25634 |      0 |  28987.84 |  3706.075 | 11646.408 | 20691.416 | 11601.704 |  1.853 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1250000 |   98.4 | 10.2746317106886 |
| AZE |  31 | Azerbaijan                                           | 1.672 | 0.534 |   5.08 |  0.49 | 27.713 |  8260.5 |  40.288 |   47.528 | 60.957 |      0 |      0 | 0.584 |       0 |      0 |  2570.944 |       nil |       nil |   2538.14 |       nil | -1.007 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   226250 |      4 | 7.85202842562066 |
| BEL |  56 | Belgium                                              | 0.388 | 0.261 |  1.239 | 0.109 |  0.178 |    3023 |  50.642 |    4.661 | 48.967 |      0 |      0 | 0.113 | 45.9637 |      0 |  27302.99 |  5462.205 | 12440.785 | 20656.459 | 12223.306 |  1.413 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   773466 |     98 | 10.2147514989853 |
| BGD |  50 | Bangladesh                                           | 0.186 | 0.065 |  0.502 | 0.053 |  1.817 |   13017 |  23.848 |    90.27 | 41.883 |      0 | 75.038 | 0.071 | 71.3844 |      0 |  1479.086 |   539.544 |   528.607 |     861.7 |   599.122 | -0.807 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  9103705 |      0 |  7.2991796084172 |
| BGR | 100 | Bulgaria                                             | 1.479 | 0.711 |  4.498 | 0.427 | 20.196 |   11063 |  42.765 |   25.239 | 82.101 |      0 |      0 | 0.149 | 31.4395 |      0 |  5979.171 |  1651.031 |  5830.809 |  5349.921 |  4567.501 |  -0.16 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   894427 |  98.85 | 8.69603720857228 |
| BHR |  48 | Bahrain                                              | 0.231 | 0.163 |  0.627 | 0.063 |      0 |      71 |  26.025 |   50.565 |      0 |      0 |      0 | 0.002 |     100 |      0 |  15928.09 |  2104.454 |  3922.257 |  5058.844 |  3776.897 |  0.457 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    31897 |      0 | 9.67583949615499 |
| BHS |  44 | Bahamas                                              | 0.055 |   0.1 |  0.144 | 0.017 |      0 |    1001 |  24.255 |   -76.61 | 13.924 |      0 |    100 | 0.003 |     100 |      0 |   16977.2 |       nil |       nil |       nil |       nil |  1.063 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |     1276 |    nil | 9.73962654638564 |
| BIH |  70 | Bosnia and Herzegovina                               | 2.311 | 1.288 |  7.075 | 0.665 | 40.253 |    5120 |  44.175 |   17.784 | 76.888 |      0 |      0 | 0.117 | 42.7623 |      0 |  5294.975 |       nil |       nil |  5572.282 |       nil |  -0.44 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   366341 |    100 | 8.57451353658904 |
| BLR | 112 | Belarus                                              | 0.164 | 0.208 |   0.54 | 0.046 |      0 |   20748 |  53.542 |   28.054 | 50.611 |      0 |      0 | 0.598 |       0 |      0 |   4802.11 |       nil |       nil |  6264.544 |       nil |   -0.9 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   487364 |    100 | 8.47681068364087 |
| BLZ |  84 | Belize                                               | 0.607 | 0.226 |  1.616 | 0.174 |  6.568 |    2281 |  17.205 |  -88.687 |  35.49 |      0 |    100 | 0.026 |     100 |      0 |  5869.233 |       nil |       nil |       nil |       nil |  0.257 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |     5326 |  39.91 | 8.67747923988958 |
| BOL |  68 | Bolivia                                              | 0.853 | 0.911 |  2.343 | 0.258 |  13.57 |  108438 |  -16.71 |  -64.662 | 31.807 |      0 | 64.878 | 0.655 |       0 |      0 |  2398.855 |  1919.359 |  2515.915 |  2574.755 |  2153.277 | -0.327 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   829897 | 26.732 | 7.78274681916224 |
| BRA |  76 | Brazil                                               |  0.24 |  0.25 |  0.654 | 0.076 |  0.558 |  845942 | -10.775 |  -53.085 | 18.783 |      0 | 88.567 | 0.642 | 9.68309 |  12159 |  7300.865 |  1671.723 |  4189.509 |  5556.415 |  3761.573 | -0.257 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   931150 |  74.43 | 8.89574811326741 |
| BRB |  52 | Barbados                                             | 0.963 | 0.695 |  2.581 | 0.289 |  3.823 |      43 |  13.167 |  -59.555 | 30.588 |      0 |    100 | 0.002 |     100 |      0 | 15290.579 |       nil |       nil |       nil |       nil |   0.76 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |     3403 |    nil | 9.63499216609365 |
| CAN | 124 | Canada                                               | 0.775 |  0.37 |  2.695 |  0.23 |  9.122 |  909351 |  61.495 |  -98.334 | 16.794 |      0 |      0 |  1.43 |  4.4433 |   5166 |  27289.26 |   7291.48 | 14316.263 | 22360.119 | 14002.496 |  1.757 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   174110 |  85.33 |  10.214248497175 |
| CHE | 756 | Switzerland                                          | 4.761 |  1.45 | 14.999 | 1.388 |  66.06 |    4000 |  46.806 |    8.226 | 39.341 |      0 |      0 | 0.278 |       0 |      0 |  30161.29 |  9063.698 | 17224.018 | 22474.859 | 16696.838 |  2.023 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   600000 |   98.5 | 10.3143145930905 |
| CHL | 152 | Chile                                                | 2.481 | 0.677 |  7.365 | 0.731 | 38.199 |   74880 | -37.937 |  -71.384 | 22.158 | 15.489 |      0 | 0.074 | 68.3825 |      0 |  9115.475 |  3669.742 |  4273.292 | 10310.834 |  5636.808 |  1.183 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   553265 |  59.19 | 9.11772879765844 |
| CHN | 156 | China                                                | 1.878 | 0.708 |  5.493 | 0.537 | 28.648 |  932748 |  36.564 |  103.836 | 22.836 |   5.77 |  0.301 | 0.987 | 5.76513 |   4410 |  3928.315 |   448.022 |   871.181 |  3420.866 |  1268.328 | -0.357 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil | 80943756 |      0 | 8.27596585974172 |
| COL | 170 | Colombia                                             | 0.885 |  0.89 |  2.376 | 0.277 | 14.366 |  110950 |   3.838 |  -72.866 | 30.444 |      0 | 89.763 | 0.379 | 16.7275 |      0 |  6243.656 |  2152.841 |  3622.226 |  5095.796 |  3661.919 | -0.767 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   902880 |   45.6 | 8.73932118722848 |
| CRI | 188 | Costa Rica                                           | 2.112 | 1.044 |  5.708 | 0.623 |  36.61 |    5106 |   9.969 |  -84.199 | 52.082 |      0 | 94.017 | 0.031 |     100 |      0 |  8621.291 |  1963.132 |  4396.007 |  6173.734 |  3955.164 |  0.637 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    74647 |  60.39 | 9.06199012042507 |
| CYP | 196 | Cyprus                                               | 2.718 | 0.909 |  7.867 | 0.706 | 44.072 |     924 |  35.049 |   33.235 | 26.866 |      0 |      0 | 0.012 |     100 |      0 |     20318 |       nil |       nil |       nil |       nil |  0.817 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   150000 |      1 | 9.91926247165149 |
| CZE | 203 | Czech Republic                                       | 0.884 | 0.578 |  2.845 | 0.252 |  4.154 |    7727 |  49.739 |   15.334 | 88.653 |      0 |      0 | 0.426 |       0 |      0 |  15373.23 |       nil |       nil |  9155.582 |       nil |  0.793 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1801067 |    100 | 9.64038296409646 |
| DEU | 276 | Germany                                              | 0.597 | 0.405 |  1.906 | 0.168 |  3.001 |   34877 |   51.11 |   10.392 | 61.338 |      0 |      0 | 0.246 | 19.7358 |      0 |  25481.43 |  3880.887 | 12040.607 | 18943.516 | 11932.706 |   1.71 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  6500000 |   97.6 | 10.1457052305603 |
| DMA | 212 | Dominica                                             | 0.003 | 0.008 |  0.005 | 0.001 |      0 |      75 |  15.427 |  -61.356 | 36.405 |      0 |    100 | 0.003 |     100 |      0 |  5931.715 |       nil |       nil |       nil |       nil |  0.495 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |      824 |    nil | 8.68806865759927 |
| DNK | 208 | Denmark                                              | 0.189 | 0.191 |  0.611 | 0.054 |      0 |    4243 |  55.987 |   10.027 | 56.165 |      0 |      0 | 0.019 |     100 |      0 |  28750.61 |  6943.104 | 13621.125 | 22975.162 | 13991.603 |  1.837 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   600000 |   99.2 | 10.2664142633917 |
| DOM | 214 | Dominican Republic                                   | 1.641 | 0.519 |  4.495 | 0.484 | 26.179 |    4838 |  18.895 |  -70.493 | 39.479 |      0 | 87.817 | 0.029 |     100 |      0 |  6410.803 |  1026.788 |  2111.321 |  3649.014 |  1989.486 |  -0.52 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    39145 |     52 | 8.76573981507963 |
| ECU | 218 | Ecuador                                              | 1.278 | 0.766 |  3.446 | 0.405 |  20.09 |   27684 |  -1.434 |   -78.77 | 44.308 |      0 | 73.165 | 0.157 | 37.3544 |      0 |  3373.415 |  1862.933 |  3459.407 |  3203.386 |  3209.836 | -0.587 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   553265 | 31.976 | 8.12368086336647 |
| ESP | 724 | Spain                                                | 1.689 |  0.81 |  5.062 | 0.472 | 23.372 |   49900 |  40.231 |   -3.644 | 64.134 |      0 |      0 | 0.131 | 42.9055 |      0 |  21764.83 |   2188.97 |  8346.302 |  15621.72 |  7811.794 |  1.333 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  5500000 |  99.24 | 9.98805064325063 |
| EST | 233 | Estonia                                              | 0.123 | 0.188 |  0.414 | 0.035 |      0 |    4239 |  58.673 |   25.549 | 62.517 |      0 |      0 | 0.135 | 37.0373 |      0 |   9762.76 |       nil |       nil |  11710.01 |       nil |  0.527 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    69282 |    100 | 9.18633042631571 |
| FIN | 246 | Finland                                              | 0.328 | 0.268 |  1.202 | 0.092 |  0.137 |   30459 |  64.481 |    26.24 |  2.097 |      0 |      0 | 0.324 | 8.79128 |      0 |  25553.88 |  4253.287 | 11441.303 | 19770.363 | 11059.542 |  1.897 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   100000 |    100 | 10.1485444432022 |
| FJI | 242 | Fiji                                                 | 1.396 | 0.582 |  3.723 | 0.421 | 14.011 |    1827 | -17.447 |  161.988 | 98.293 |      0 |    100 | 0.009 |     100 |      0 |  4949.898 |       nil |       nil |       nil |       nil | -0.093 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   139322 |    2.2 | 8.50712224928982 |
| FRA | 250 | France                                               | 1.098 | 0.496 |  3.406 | 0.313 |  12.07 |   55010 |   46.56 |    2.551 | 59.939 |      0 |      0 | 0.172 | 34.6184 |      0 |  25698.01 |  5271.312 | 13251.077 | 21025.375 | 12907.095 |  1.397 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil | 11000000 |   93.4 | 10.1541688359787 |
| GBR | 826 | United Kingdom of Great Britain and Northern Ireland | 0.568 |  0.21 |  1.878 | 0.175 |  3.643 |   24269 |   54.15 |   -2.901 | 48.239 |      0 |      0 | 0.034 | 96.3607 |      0 |  26332.05 |  6939.374 | 11847.087 | 20352.869 | 12332.872 |  1.783 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  3306643 |   94.6 | 10.1785421074163 |
| GEO | 268 | Georgia                                              | 3.659 | 0.859 | 11.258 | 1.067 |  59.17 |    6949 |  42.179 |   43.513 | 34.021 |      0 |      0 | 0.181 | 33.1835 |      0 |   1880.45 |       nil |       nil |  3243.627 |       nil | -1.033 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   275547 |      3 | 7.53926638888368 |
| GRC | 300 | Greece                                               | 3.103 | 1.295 |  9.166 | 0.867 | 52.841 |   12890 |  39.043 |   22.989 | 48.588 |      0 |      0 | 0.029 | 96.2131 |      0 |  17391.74 |  1915.007 |  7721.514 | 12110.869 |  6959.675 |   0.81 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1118034 |    100 | 9.76375065984722 |
| GRD | 308 | Grenada                                              | 2.088 | 1.538 |  5.655 | 0.606 | 39.913 |      34 |  12.157 |  -61.654 | 67.646 |      0 |    100 | 0.001 |     100 |      0 |  7536.395 |       nil |       nil |       nil |       nil |   0.27 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |     1237 |    nil | 8.92749922995689 |
| GTM | 320 | Guatemala                                            | 1.807 | 1.369 |  4.893 | 0.538 |  30.85 |   10843 |  15.697 |  -90.356 | 58.058 |      0 | 78.376 | 0.099 | 48.2159 |      0 |  3974.407 |  2084.894 |  3683.875 |  4096.941 |  3228.048 | -0.897 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   243109 | 21.965 |  8.2876308335697 |
| GUY | 328 | Guyana                                               | 0.273 | 0.052 |  0.744 | 0.089 |   0.36 |   19685 |   4.794 |  -58.976 | 19.594 |      0 |    100 | 0.215 |  28.642 |   1023 |  4072.166 |       nil |       nil |       nil |       nil |  -0.23 | 0 | 0 | 0 | 0 | 0 | 1 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |      nil |    1.3 | 8.31193032360769 |
| HKG | 344 | Hong Kong Special Administrative Region of China     | 2.501 | 1.558 |  6.692 | 0.698 | 51.197 |     110 |  22.381 |  114.134 | 96.076 |      0 |      0 | 0.002 |     100 |      0 |  25795.83 |  2218.149 |  6990.537 | 23328.385 |  9882.841 |  1.037 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    42611 |      0 | 10.1579681299395 |
| HND | 340 | Honduras                                             |  2.15 | 1.207 |  5.824 | 0.631 | 39.971 |   11189 |  14.822 |    -86.6 | 55.945 |      0 | 94.636 | 0.077 | 66.5159 |      0 |  2506.231 |  1313.356 |  1731.909 |  1911.571 |  1690.379 | -0.837 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   114924 |     46 | 7.82653530997876 |
| HRV | 191 | Croatia                                              | 1.267 | 0.678 |  3.842 | 0.366 | 17.588 |    5592 |  45.026 |   16.419 | 48.395 |      0 |      0 | 0.113 | 51.0571 |      0 |  9545.475 |       nil |       nil |  6438.607 |       nil | -0.203 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   530014 |  99.55 | 9.16382249919614 |
| HTI | 332 | Haiti                                                | 2.362 | 1.318 |  6.448 | 0.697 | 42.462 |    2756 |  18.936 |  -72.686 |  42.05 |      0 |    100 | 0.019 |     100 |      0 |  1798.406 |   1050.62 |  1034.517 |   796.162 |  1007.399 | -1.463 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    51954 |    2.5 | 7.49465599599274 |
| HUN | 348 | Hungary                                              | 0.346 | 0.289 |   1.09 | 0.098 |  0.921 |    8962 |  47.166 |   19.418 | 65.095 |      0 |      0 | 0.467 |       0 |      0 |  13223.63 |  2479.958 |  5804.766 |  7132.268 |   5178.71 |    0.8 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1000000 |   99.3 | 9.48976065967809 |
| IDN | 360 | Indonesia                                            | 0.967 | 0.435 |  2.587 | 0.304 | 13.405 |  181157 |  -2.226 |  117.277 | 43.306 |      0 | 99.835 | 0.062 | 77.0687 |    287 |  3028.274 |   839.518 |  1507.126 |  3258.498 |   1752.64 | -0.653 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  6987225 |      0 | 8.01574809923494 |
| IND | 356 | India                                                | 1.013 | 0.237 |  2.842 | 0.295 | 12.824 |  297319 |  22.876 |   79.627 | 51.042 |  4.495 | 39.447 | 0.407 | 18.0434 |    489 |  2415.093 |   619.003 |   897.336 |  1885.008 |  1006.152 |  0.213 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil | 77226807 |      0 | 7.78949307466198 |
| IRL | 372 | Ireland                                              | 0.513 |  0.28 |  1.676 | 0.158 |  2.864 |    6889 |  53.181 |   -8.153 | 59.095 |      0 |      0 | 0.035 | 95.8615 |      0 |  30532.31 |  3452.898 |  7316.275 |  21551.34 |  8281.263 |  1.643 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   193357 | 99.885 | 10.3265407461486 |
| IRN | 364 | Iran; Islamic Republic of                            | 2.445 | 0.929 |  6.962 | 0.651 | 33.616 |  162855 |   32.56 |   54.305 | 21.824 |  0.543 |      0 | 0.461 | 11.4317 |      0 |  5826.672 |  1719.611 |  5862.488 |  4662.057 |  3593.365 |   -0.6 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  3741657 |      0 | 8.67020127587281 |
| ISL | 352 | Iceland                                              | 1.472 | 0.557 |  5.318 | 0.435 | 20.729 |   10025 |   64.99 |  -18.594 |  3.403 |  9.086 |      0 |  0.04 | 93.2095 |      0 |  28929.43 |       nil |       nil |       nil |       nil |  1.753 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    60000 |    nil | 10.2726146950454 |
| ISR | 376 | Israel                                               | 1.705 | 1.002 |  4.808 | 0.439 | 23.277 |    2164 |  31.353 |   34.967 | 27.477 |  0.709 |      0 | 0.052 | 90.3822 |      0 |  23857.94 |  2817.303 | 10147.871 | 16925.594 |   9250.91 |   1.07 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   229955 | 30.698 |  10.079872354959 |
| ITA | 380 | Italy                                                | 2.458 | 0.755 |  7.506 | 0.711 | 38.884 |   29411 |  42.789 |   12.075 |  51.78 |      0 |      0 | 0.058 | 80.9226 |      0 |  24994.66 |    3501.9 | 10741.869 |  18773.57 | 11048.927 |  0.893 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  7000000 |   99.8 | 10.1264174810346 |
| JAM | 388 | Jamaica                                              | 1.788 | 0.934 |  4.837 | 0.528 | 24.278 |    1083 |  18.156 |  -77.311 |  66.97 |      0 |    100 | 0.012 |     100 |      0 |   3650.39 |  1326.785 |  3844.877 |   3598.21 |   3139.55 | -0.377 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    22626 |      8 | 8.20258929018362 |
| JOR | 400 | Jordan                                               | 1.097 | 1.648 |  3.115 | 0.282 | 12.165 |    8824 |   31.25 |   36.788 | 15.479 | 15.332 |      0 | 0.189 | 16.2407 |      0 |  3846.694 |  1663.149 |  2582.962 |  4088.574 |  3248.945 |   0.39 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    86370 |      1 | 8.25496935708797 |
| JPN | 392 | Japan                                                | 2.132 | 0.463 |  6.275 | 0.604 | 37.173 |   36450 |   37.54 |  137.963 | 42.879 |      0 |  0.006 | 0.032 | 97.7372 |      0 |  26219.79 |  1920.721 | 11343.781 | 20742.387 | 11248.286 |  1.477 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil | 12500000 |      0 | 10.1742697481323 |
| KAZ | 398 | Kazakhstan                                           | 0.372 | 0.281 |  1.172 | 0.108 |  2.913 |  269970 |   48.18 |   67.313 |  9.877 |  9.747 |      0 | 2.206 |       0 |      0 |  4594.435 |       nil |       nil |  5648.025 |       nil | -0.877 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1253389 |   41.9 | 8.43260106749077 |
| KGZ | 417 | Kyrgyzstan                                           | 4.287 | 0.948 | 13.105 | 1.246 | 69.767 |   19180 |  41.464 |   74.556 | 12.534 |      0 |      0 | 1.918 |       0 |      0 |      1560 |       nil |       nil |  2167.491 |       nil |  -0.74 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   325361 |     15 | 7.35244110024358 |
| KHM | 116 | Cambodia                                             |  0.54 | 0.146 |  1.421 | 0.154 |  6.094 |   17652 |  12.707 |  104.921 | 22.213 |      0 |    100 |  0.17 |  25.378 |      0 |  1859.063 |   481.977 |   579.707 |      1141 |   766.583 | -1.013 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1383162 |      0 | 7.52782787633495 |
| KNA | 659 | Saint Kitts and Nevis                                | 0.006 |  0.01 |  0.012 | 0.003 |      0 |      26 |  17.274 |  -62.704 |    100 |      0 |    100 | 0.001 |     100 |      0 |   11224.7 |       nil |       nil |       nil |       nil |   0.06 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |      743 |    nil |  9.3258719861954 |
| KOR | 410 | Republic of Korea                                    |  1.96 | 0.747 |  5.807 | 0.546 | 33.976 |    9873 |  36.356 |  127.806 | 43.556 |      0 |      0 | 0.042 | 95.0484 |      0 |  16172.41 |    853.89 |  3161.702 | 14219.083 |  4725.635 |  0.717 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  2308243 |      0 | 9.69106198290034 |
| KWT | 414 | Kuwait                                               | 0.245 | 0.271 |  0.691 | 0.063 |      0 |    1782 |  29.354 |   47.613 |      0 |      0 |      0 |  0.04 | 98.6018 |      0 |  15958.92 | 28878.139 | 18161.664 | 10082.733 | 19359.766 |   0.77 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    42006 |      0 | 9.67777319954121 |
| LAO | 418 | Lao People's Democratic Republic                     | 2.553 | 1.218 |  6.976 | 0.723 | 49.807 |   23080 |  18.495 |  103.774 | 12.068 |      0 | 54.794 | 0.267 |  6.8206 |      0 |  1569.901 |   612.943 |   783.584 |  1203.223 |   826.834 |  -1.15 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   348220 |      0 | 7.35876783902932 |
| LBN | 422 | Lebanon                                              | 4.197 |  2.17 | 12.042 | 1.103 | 71.642 |    1023 |  33.922 |   35.897 | 72.415 |      0 |      0 | 0.027 |     100 |      0 |  4216.305 |   2428.74 |  3461.337 |   3405.22 |  2881.809 | -0.177 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   313584 |    0.5 | 8.34671443105805 |
| LCA | 662 | Saint Lucia                                          | 2.147 | 1.351 |  5.841 |  0.59 | 35.476 |      61 |  13.894 |  -60.965 | 32.527 |      0 |    100 | 0.002 |     100 |      0 |  5620.647 |       nil |       nil |       nil |       nil |   0.06 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |     1335 |    nil | 8.63420206081657 |
| LKA | 144 | Sri Lanka                                            |  0.65 | 0.446 |  1.712 | 0.197 |  7.786 |    6463 |    7.63 |   80.701 | 51.595 |      0 |    100 | 0.035 |     100 |      0 |  3625.534 |  1252.871 |  1540.745 |  3633.984 |  1891.942 | -0.067 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   956352 |      0 |  8.1957568667845 |
| LTU | 440 | Lithuania                                            | 0.175 | 0.229 |  0.578 | 0.049 |      0 |    6268 |  55.336 |   23.905 | 62.064 |      0 |      0 | 0.256 | 13.8029 |      0 |  8767.231 |       nil |       nil |  6346.336 |       nil |   0.33 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   161557 |    100 | 9.07877630004949 |
| LUX | 442 | Luxembourg                                           | 0.881 | 0.581 |  2.844 | 0.242 |  1.654 |     259 |  49.778 |    6.095 | 25.662 |      0 |      0 | 0.259 |       0 |      0 |  57792.09 |       nil |       nil |       nil |       nil |  1.767 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    26534 |   99.2 | 10.9646071940844 |
| LVA | 428 | Latvia                                               | 0.154 | 0.136 |  0.522 | 0.044 |      0 |    6205 |  56.854 |   24.931 | 77.568 |      0 |      0 | 0.265 | 15.7566 |      0 |  7903.728 |       nil |       nil |  7693.585 |       nil |  0.177 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   122643 |    100 |  8.9750898258801 |
| MAC | 446 | Macao Special Administrative Region of China         | 0.732 | 0.527 |  1.921 | 0.185 |  4.168 |       3 |  22.169 |  113.555 |      0 |      0 |      0 |     0 |     100 |      0 |  18581.94 |       nil |       nil |       nil |       nil |  0.195 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    13636 |    nil | 9.82994542026482 |
| MDA | 498 | Republic of Moldova                                  | 0.799 | 0.573 |  2.527 | 0.222 |  0.403 |    3288 |  47.205 |   28.468 | 62.015 |      0 |      0 | 0.197 | 11.0077 |      0 |  1331.461 |       nil |       nil |  2127.236 |       nil | -0.317 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   147311 |   99.1 | 7.19403211455089 |
| MEX | 484 | Mexico                                               | 1.732 | 0.825 |  4.795 | 0.491 | 27.341 |  194395 |  23.941 | -102.536 | 31.934 |  1.704 | 27.928 | 0.183 | 38.4165 |      0 |   9046.27 |  2365.019 |   5158.34 |  7274.678 |  4824.431 | -0.473 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  4514402 |     30 | 9.11010779703875 |
| MKD | 807 | The former Yugoslav Republic of Macedonia            | 2.665 | 0.885 |   8.19 | 0.783 | 49.405 |    2543 |    41.6 |   21.701 | 52.895 |      0 |      0 | 0.135 | 14.0538 |      0 |  6059.698 |       nil |       nil |  3340.784 |       nil | -0.433 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   169275 |  96.31 | 8.70941524283806 |
| MLT | 470 | Malta                                                | 1.527 | 1.171 |  4.292 | 0.381 | 14.699 |      32 |  35.925 |   14.407 |    100 |      0 |      0 | 0.002 |     100 |      0 |  18255.73 |       nil |       nil |       nil |       nil |  1.003 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    10000 |   99.5 | 9.81223428233429 |
| MNG | 496 | Mongolia                                             | 1.057 | 0.765 |  3.352 | 0.309 | 12.623 |  156650 |  46.836 |   103.07 | 44.883 |   1.49 |      0 | 1.694 |       0 |      0 |  1620.436 |   435.422 |   912.424 |  1084.652 |   891.187 |      0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   578516 |      1 | 7.39045052781836 |
| MYS | 458 | Malaysia                                             | 1.009 | 0.374 |  2.684 | 0.316 |  12.87 |   32855 |   3.791 |  109.709 | 49.196 |      0 |    100 | 0.057 | 83.2625 |      0 |  8926.452 |  1559.265 |  2648.422 |   8165.59 |  3467.013 |  0.517 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   296322 |      0 | 9.09677428249104 |
| NCL | 540 | New Caledonia                                        | 1.586 | 0.621 |  4.338 | 0.492 | 24.913 |    1828 | -21.299 |  165.663 | 54.444 |      0 | 94.292 | 0.008 |     100 |      0 |     22140 |       nil |       nil |       nil |       nil |  -0.86 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    31251 |    nil | 10.0051412062626 |
| NIC | 558 | Nicaragua                                            | 0.992 | 0.768 |  2.671 | 0.286 | 11.923 |   12140 |  12.841 |  -85.033 | 33.249 |      0 |    100 | 0.077 | 65.2217 |      0 |   3277.64 |  1615.788 |  3128.881 |  1520.552 |  2131.895 | -0.657 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   100069 |     51 | 8.09487893020994 |
| NLD | 528 | Netherlands                                          | 0.037 | 0.042 |  0.108 | 0.012 |      0 |    3388 |   52.25 |    5.621 | 41.165 |      0 |      0 | 0.042 | 91.6192 |      0 |  28610.12 |  5996.128 | 13373.628 | 22161.445 | 12961.165 |   1.79 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   600000 |  95.95 |  10.261515780373 |
| NOR | 578 | Norway                                               | 2.409 | 1.245 |  8.516 | 0.692 | 37.013 |   30428 |  64.467 |   14.082 |  0.073 |      0 |      0 | 0.053 | 79.6415 |      0 |  34207.82 |   5429.51 | 12271.317 | 25101.949 | 13253.486 |   1.95 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   400000 |    100 | 10.4402095518839 |
| NPL | 524 | Nepal                                                | 5.043 |  1.26 | 14.458 | 1.493 | 75.265 |   14300 |  28.264 |   83.931 | 41.622 |      0 |      0 | 0.697 |       0 |      0 |  1322.873 |   496.334 |   641.508 |   999.145 |   691.527 | -0.177 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1852093 |      0 |  7.1875611655541 |
| NZL | 554 | New Zealand                                          | 2.038 | 0.451 |  6.233 | 0.606 |  31.49 |   26771 | -41.806 |  171.478 | 44.643 |      0 |      0 | 0.039 |  95.685 |      0 |  19614.94 |  8455.649 | 12488.613 | 16170.117 |  11982.21 |   1.87 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    15000 |   80.6 | 9.88404679975547 |
| OMN | 512 | Oman                                                 | 1.109 | 0.896 |  3.012 | 0.283 | 12.216 |   30950 |  20.595 |   56.104 |      0 | 19.027 |      0 | 0.113 | 47.7134 |      0 |  12729.71 |   623.095 |  4267.115 |  7115.765 |  3880.417 |  0.843 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   200000 |      0 | 9.45169391045929 |
| PAK | 586 | Pakistan                                             | 1.949 | 0.341 |  5.665 | 0.559 | 25.078 |   77088 |   29.97 |   69.395 |  6.988 | 11.184 |      0 | 0.589 | 11.0758 |      0 |  1925.391 |    643.02 |   977.667 |  1815.145 |  1110.924 | -0.727 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  7669487 |      0 | 7.56288434297956 |
| PAN | 591 | Panama                                               |  1.54 | 0.546 |  4.128 | 0.457 | 22.956 |    7443 |   8.513 |  -80.109 | 42.843 |      0 |    100 | 0.018 |     100 |      0 |  6164.348 |  1915.962 |  4198.462 |  5675.752 |  3954.735 | -0.143 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    66462 |   45.2 | 8.72653765169258 |
| PER | 604 | Peru                                                 | 1.347 | 0.991 |  3.653 | 0.427 |  20.01 |  128000 |  -9.173 |  -74.361 | 21.743 |   0.54 | 55.788 | 0.325 | 16.7165 |      0 |  4722.525 |  2307.632 |  4325.977 |   3832.72 |  3502.972 | -0.633 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1888175 | 28.043 |  8.4600988931679 |
| PHL | 608 | Philippines                                          | 2.028 | 0.574 |  5.428 | 0.583 | 34.183 |   29817 |  11.739 |  122.868 | 80.137 |      0 | 98.973 |  0.02 |     100 |      0 |  4027.548 |  1070.263 |  2033.298 |  2421.199 |  1893.012 | -0.237 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   362390 |      0 | 8.30091303304343 |
| PNG | 598 | Papua New Guinea                                     | 1.589 |  0.98 |  4.217 | 0.491 | 25.222 |   45286 |  -6.476 |  145.252 | 46.833 |      0 |    100 | 0.071 | 71.2843 |      0 |  2325.738 |       nil |       nil |       nil |       nil |  -0.68 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   866855 |      0 | 7.75179268700943 |
| POL | 616 | Poland                                               | 0.297 | 0.259 |  0.951 | 0.084 |    1.2 |   30436 |  52.124 |   19.401 |  48.41 |      0 |      0 | 0.283 | 14.8703 |      0 |  10401.36 |  2446.893 |   5807.87 |  7308.837 |  4706.412 |  0.643 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  2750000 |    100 | 9.24969184581068 |
| PRI | 630 | Puerto Rico                                          | 1.447 | 0.699 |  3.928 | 0.416 |  19.25 |     887 |  18.225 |  -66.464 | 59.186 |      0 |    100 | 0.012 |     100 |      0 |  22242.23 |  2143.823 |  6946.214 | 14105.683 |  7177.506 |  0.917 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    35772 |   66.3 |  10.009748013122 |
| PRT | 620 | Portugal                                             | 1.304 | 0.967 |  3.937 | 0.369 | 15.522 |    9150 |  39.593 |   -8.531 | 34.264 |      0 |      0 | 0.072 | 70.0621 |      0 |  18255.28 |  2086.406 |  6517.205 | 13813.426 |  6861.499 |  1.167 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   900000 |  98.27 |  9.8122096322356 |
| PRY | 600 | Paraguay                                             | 0.245 | 0.479 |  0.681 | 0.067 |  0.224 |   39730 | -23.245 |  -58.393 | 28.751 |      0 | 57.034 | 0.847 |       0 |      0 |  4553.069 |  1584.366 |  2220.024 |  3013.877 |  2405.144 | -0.817 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   174110 |  52.85 | 8.42355679006291 |
| PYF | 258 | French Polynesia                                     | 2.072 | 1.389 |  5.637 | 0.645 |  40.29 |     366 | -15.346 | -145.232 |  6.284 |      0 | 96.819 | 0.001 |     100 |      0 |  24538.31 |       nil |       nil |       nil |       nil |    nil | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    24449 |    nil | 10.1079908487378 |
| ROU | 642 | Romania                                              | 1.267 | 0.555 |  4.005 | 0.357 |  16.71 |   22971 |  45.843 |   24.986 | 69.642 |      0 |      0 | 0.367 |  6.7651 |      0 |  5889.324 |  1181.952 |   3761.37 |   3005.54 |  2935.706 |  -0.15 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1250000 |  99.43 |   8.680896499261 |
| RUS | 643 | Russian Federation                                   |  0.94 | 0.355 |  3.278 | 0.267 | 11.412 | 1638134 |   61.99 |   96.711 | 17.718 |  0.056 |      0 | 1.841 | 2.76605 | 205550 |  7095.689 |       nil |       nil |  5276.657 |       nil | -0.873 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  6481410 |   99.5 | 8.86724269552051 |
| SAU | 682 | Saudi Arabia                                         | 0.914 | 0.688 |  2.514 | 0.231 |  8.891 |  214969 |  24.097 |   44.562 |      0 | 37.258 |      0 | 0.304 | 13.6641 |      0 |  12374.11 |  2230.766 | 11787.042 |  7647.705 |  7612.613 |  0.343 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  2000000 |      0 | 9.42336166565866 |
| SGP | 702 | Singapore                                            | 0.016 | 0.004 |  0.036 | 0.005 |      0 |      67 |   1.361 |   103.82 |  3.488 |      0 |    100 | 0.003 |     100 |      0 |  23611.61 |  2218.961 |  6430.213 |  22518.17 |  8339.448 |  1.577 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    49570 |    0.5 | 10.0694938191989 |
| SLB |  90 | Solomon Islands                                      |  1.54 | 1.109 |  4.111 | 0.476 | 21.213 |    2799 |  -8.895 |  159.601 | 80.002 |      0 |    100 | 0.003 |     100 |      0 |   1862.47 |       nil |       nil |       nil |       nil | -1.195 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    43289 |    nil | 7.52965884274144 |
| SLV | 222 | El Salvador                                          |  1.75 |     1 |  4.746 | 0.518 | 26.108 |    2072 |  13.724 |  -88.869 | 65.938 |      0 |    100 | 0.039 | 99.6575 |      0 |  4594.274 |  1488.813 |  2503.697 |  2715.551 |  2147.779 | -0.743 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   150732 |     50 | 8.43256602448309 |
| SVK | 703 | Slovakia                                             |  1.56 | 0.672 |  5.043 | 0.442 | 23.419 |    4810 |  48.707 |   19.487 | 60.924 |      0 |      0 | 0.554 |       0 |      0 |  11303.75 |       nil |       nil |  8219.698 |       nil |  0.263 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   698933 |  99.61 | 9.33288980805469 |
| SVN | 705 | Slovenia                                             | 2.496 | 0.746 |  7.713 | 0.711 | 39.108 |    2014 |  46.112 |   14.823 | 67.604 |      0 |      0 | 0.091 | 61.6056 |      0 |  16873.33 |       nil |       nil | 12876.633 |       nil |  0.973 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   202779 |    100 | 9.73348954788061 |
| SWE | 752 | Sweden                                               | 0.715 | 0.343 |   2.53 | 0.207 |  3.868 |   41033 |  62.777 |   16.759 | 15.853 |      0 |      0 | 0.223 | 21.2438 |      0 |  25899.88 |  6739.231 | 14183.347 | 20709.986 | 13259.333 |  1.813 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   800000 |   99.3 | 10.1619936144723 |
| SYR | 760 | Syrian Arab Republic                                 | 0.756 | 0.741 |  2.174 | 0.198 |   6.63 |   18378 |  35.014 |   38.498 | 52.909 |  3.445 |      0 | 0.244 | 16.7091 |      0 |  3242.195 |  2408.502 |  5570.152 |  7368.301 |  4961.027 | -0.367 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1306601 |      0 | 8.08400584854355 |
| THA | 764 | Thailand                                             | 1.051 | 0.189 |  2.826 | 0.302 | 16.408 |   51089 |  15.107 |  101.018 | 20.144 |      0 | 99.546 | 0.193 | 29.3876 |      0 |   6279.51 |   817.049 |   1958.72 |  6397.871 |  2729.121 |  0.477 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1741101 |      0 | 8.74504723094039 |
| TJK | 762 | Tajikistan                                           | 5.301 | 1.033 | 15.976 |  1.54 | 75.473 |   13996 |  38.527 |   71.038 | 17.449 |  0.025 |      0 | 1.505 |       0 |      0 |   785.469 |       nil |       nil |   883.162 |       nil |  -1.61 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   286375 |    3.9 | 6.66628099160818 |
| TKM | 795 | Turkmenistan                                         | 0.284 | 0.248 |  0.834 | 0.082 |  1.426 |   46993 |  39.194 |   59.178 |   3.97 | 55.087 |      0 | 1.286 |       0 |      0 |  3667.555 |       nil |       nil |  2324.556 |       nil |  -1.18 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   226444 |    5.5 | 8.20728050649637 |
| TON | 776 | Tonga                                                | 0.773 |  0.07 |  1.992 | 0.224 |  9.737 |      72 | -19.859 | -174.847 |    100 |      0 |    100 |     0 |     100 |      0 |  6568.724 |       nil |       nil |       nil |       nil |  -0.38 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    19021 |    nil | 8.79007487648232 |
| TTO | 780 | Trinidad and Tobago                                  | 0.603 | 0.521 |  1.611 | 0.184 |  5.099 |     513 |  10.469 |  -61.257 | 50.384 |      0 |    100 | 0.008 |     100 |      0 |  8969.766 |  3674.051 |  9117.805 | 13681.761 |  8591.538 |   0.42 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    10258 |    7.1 | 9.10161486775605 |
| TUR | 792 | Turkey                                               |  2.62 | 1.192 |  7.773 | 0.732 | 40.909 |   76963 |  39.061 |   35.174 | 65.295 |      0 |      0 | 0.152 | 38.9877 |      0 |  6510.354 |  1622.933 |  3894.789 |  6609.014 |  3821.776 |  -0.04 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  6438306 |     10 | 8.78114911160438 |
| UKR | 804 | Ukraine                                              | 0.416 | 0.359 |  1.317 | 0.117 |  1.988 |   57935 |  49.009 |   31.411 | 69.003 |      0 |      0 | 0.365 | 13.6144 |      0 |   4108.69 |       nil |       nil |  2745.334 |       nil | -0.823 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  2347003 |    100 | 8.32085952189036 |
| URY | 858 | Uruguay                                              | 0.435 | 0.391 |  1.283 | 0.114 |  0.136 |   17502 | -32.802 |  -56.013 | 68.979 |      0 |      0 | 0.142 | 37.4727 |      0 |  8781.518 |  4659.398 |  5421.178 |  7883.267 |  5841.658 |   0.55 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |      nil |  91.89 |  9.0804045646234 |
| USA | 840 | United States of America                             | 1.073 | 0.333 |  3.384 | 0.304 | 14.317 |  916192 |  45.718 | -112.982 |   41.6 |  0.278 |  0.358 | 0.677 | 13.1656 |      0 |  33970.17 |  9561.348 | 16283.633 |  28448.85 | 17349.756 |  1.697 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   783496 |  76.02 | 10.4332380655578 |
| UZB | 860 | Uzbekistan                                           | 0.526 | 0.243 |  1.589 | 0.154 |  5.782 |   42540 |  41.633 |   63.341 |  11.72 | 32.152 |      0 | 1.645 |       0 |      0 |  1515.708 |       nil |       nil |  3478.961 |       nil | -1.023 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1180650 |    7.5 | 7.32363793551301 |
| VCT | 670 | Saint Vincent and the Grenadines                     | 3.071 | 1.878 |  8.401 | 0.892 | 61.286 |      39 |  13.185 |  -61.205 | 38.818 |      0 |    100 | 0.001 |     100 |      0 |  5334.509 |       nil |       nil |       nil |       nil |   0.06 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |     1081 |    nil | 8.58195212576103 |
| VEN | 862 | Venezuela (Bolivarian Republic of)                   | 0.634 | 0.594 |  1.716 | 0.202 |  5.994 |   88205 |   7.132 |  -66.153 | 21.567 |      0 | 96.752 | 0.306 | 25.2528 |   5124 |   5685.12 |  7461.959 | 10471.647 |  8414.729 |  9366.497 |  -0.73 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |   377635 |   54.5 | 8.64560751414128 |
| VNM | 704 | Viet Nam                                             | 2.054 | 0.439 |  5.603 | 0.583 | 36.775 |   31106 |  16.643 |  106.306 |  12.15 |      0 | 56.535 | 0.112 | 57.8169 |      0 |  2011.743 |   658.076 |   709.929 |  1808.773 |   932.382 | -0.553 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  1665106 |      0 | 7.60675678946259 |
| VUT | 548 | Vanuatu                                              | 1.729 | 1.041 |  4.709 | 0.545 | 24.993 |    1219 | -16.196 |  167.703 | 79.892 |      0 |    100 | 0.002 |     100 |      0 |   3172.14 |       nil |       nil |       nil |       nil | -0.455 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    22994 |    nil | 8.06216171797244 |
| WSM | 882 | Samoa                                                | 1.677 | 0.968 |  4.644 | 0.549 | 22.244 |     283 | -13.738 | -172.168 |    100 |      0 |    100 | 0.003 |     100 |      0 |  4860.269 |       nil |       nil |       nil |       nil |   0.36 | 0 | 0 | 0 | 1 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |    33072 |    nil | 8.48884906515704 |
| YEM | 887 | Yemen                                                | 2.323 | 2.197 |  6.155 | 0.591 |  33.06 |   52797 |  15.863 |    47.58 |      0 |  10.75 |      0 | 0.148 | 38.1163 |      0 |   787.749 |   911.231 |  1783.548 |  2619.284 |  1703.219 | -1.127 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | nil | nil | nil | nil |  2250000 |      0 |  6.6691795111983 |

#+BEGIN_SRC R 7.2
# african nation

m7.1 <- map(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR * rugged,
        a ~ dnorm(8, 100),
        bR ~ dnorm(0, 1),
        sigma ~ dunif(0, 10)
    ), data=d.A1
)

                                        #non-African

m7.2 <- map(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + bR * rugged,
        a ~ dnorm(8, 100),
        bR ~ dnorm(0, 1),
        sigma ~ dunif(0, 10)
    ), data=d.A0
)


#+END_SRC

#+RESULTS:

#+BEGIN_SRC R :results output graphics :file plot1.png
rugged.seq <- seq(from=-1, to=7, length.out=100)
mu <- link(m7.1, data=data.frame(rugged=rugged.seq))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=.89)
plot(log_gdp ~ rugged, data=d.A1, col=col.alpha(rangi2, 0.5))
lines(rugged.seq, mu.mean)
shade(mu.PI, rugged.seq)
#+END_SRC

#+RESULTS:
[[file:plot1.png]]


#+BEGIN_SRC R :results output graphics :file plot2.png
rugged.seq <- seq(from=-1, to=7, length.out=100)
mu <- link(m7.2, data=data.frame(rugged=rugged.seq))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=.89)

plot(log_gdp ~ rugged, data=d.A0, col=col.alpha(rangi2, 0.5))
lines(rugged.seq, mu.mean)
shade(mu.PI, rugged.seq)
#+END_SRC

#+RESULTS:
[[file:plot2.png]]

It is not a good reasons to split data into two categories.

1. By splitting the data, you are hurting the accuracy of estimates for the parameters
   such as \sigma. 
2. To acquire probability statements about the variable you used to split the data, you
   need to include it in the model. This way you can't quantify the uncertainty about
   predictive value of distinguishing between African and non-african model. 
3. We can't use information criteria to compare models when we split -- we need to use
   the same data. 
4. We cannot borrow information across categories after splitting.

** 7.1.1 Adding a dummy variable doesn't work

#+BEGIN_SRC R :results output

m7.3 <- map(alist(
    log_gdp ~ dnorm(mu, sigma),
    mu <- a + bR * rugged,
    a ~ dnorm(8, 100),
    bR ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
), data= dd)


m7.4 <- map(alist(
    log_gdp ~ dnorm(mu, sigma),
    mu <- a + bR * rugged + bA * cont_africa,
    a ~ dnorm(8, 100),
    bR ~ dnorm(0, 1),
    bA ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
), data= dd)

compare(m7.3, m7.4)
#+END_SRC

#+RESULTS:
: 
:       WAIC pWAIC dWAIC weight    SE  dSE
: m7.4 476.2   4.3   0.0      1 15.33   NA
: m7.3 539.4   2.6  63.2      0 13.24 15.1

#+BEGIN_SRC R :results output graphics :file plts.png
rugged.seq <- seq(from=-1, to=8, by=0.25)

mu.NotAfrica <- link(m7.4, data=data.frame(cont_africa=0, rugged=rugged.seq))
mu.Africa <- link(m7.4, data=data.frame(cont_africa=1, rugged=rugged.seq))

mu.NotAfrica.mean <- apply(mu.NotAfrica, 2, mean)
mu.NotAfrica.PI <- apply(mu.NotAfrica, 2, PI, prob=.97)
mu.Africa.mean <- apply(mu.Africa, 2, mean)
mu.Africa.PI <- apply(mu.Africa, 2, PI, prob=.97)


plot(log_gdp ~ rugged, data=d.A0, col=col.alpha(rangi2, 0.5))
plot(log_gdp ~ rugged, data=d.A1, col=col.alpha(rangi2, 0.8))

lines(rugged.seq, mu.NotAfrica.mean, col=col.alpha(rangi2, 0.5))
shade(mu.NotAfrica.PI, rugged.seq, col=col.alpha(rangi2, 0.5))

lines(rugged.seq, mu.Africa.mean, col=col.alpha(rangi2, 0.8))
shade(mu.Africa.PI, rugged.seq, col=col.alpha(rangi2, 0.8))

#+END_SRC

#+RESULTS:
[[file:plts.png]]

** COMMENT 7.2. Adding a linear interaction does work. 
By defining the relationship between GDP and ruggedness in this way, you are explicitly
modeling the hypothesis that the slope between GDP and ruggedness depends---is
conditional---upon whether or not a nation is in Africa.

#+BEGIN_SRC R :results output

m7.5 <- map(
    alist(
        log_gdp ~ dnorm(mu, sigma),
        mu <- a + gamma * rugged + bA*cont_africa,
        gamma <- bR + bAR*cont_africa,
        a ~ dnorm(8, 100),
        bA ~ dnorm(0, 1),
        bR ~ dnorm(0, 1),
        bAR ~ dnorm(0, 1),
        sigma ~ dunif(0, 10)
    ), data=dd)

compare(m7.3, m7.4, m7.5)

#+END_SRC

#+RESULTS:
: 
:       WAIC pWAIC dWAIC weight    SE   dSE
: m7.5 470.2   5.6   0.0   0.95 15.19    NA
: m7.4 476.1   4.3   5.9   0.05 15.33  6.02
: m7.3 539.7   2.7  69.5   0.00 13.27 15.25

How do IC still make sense in this context?
1. They still give insight into overfitting, even though there will not be new samples to
   be generated (no new African nations). 
2. WAIC is a general measure of a model's flexibility in fitting a sample. It nudges us
   towards conservative inference. 

** 7.1.3 Plotting the interaction

#+BEGIN_SRC R :results output graphics :file 4.11.png
rugged.seq <- seq(from=-1, to=8, by=0.25)

mu.Africa <- link(m7.5, data=data.frame(cont_africa=1, rugged=rugged.seq))
mu.Africa.mean <- apply(mu.Africa, 2, mean)
mu.Africa.PI <- apply(mu.Africa, 2, PI, prob=.97)

mu.NotAfrica <- link(m7.5, data=data.frame(cont_africa=0, rugged=rugged.seq))
mu.NotAfrica.mean <- apply(mu.NotAfrica, 2, mean)
mu.NotAfrica.PI <- apply(mu.NotAfrica, 2, PI, prob=.97)

                                        #plot African nations with regression

d.A1 <- dd[dd$cont_africa==1,]
plot(log(rgdppc_2000) ~ rugged, data=d.A1,
     col=rangi2, ylab="log GDP year 2000",
     xlab="Terrain Ruggedness Index")
mtext("African Nations", 3)
lines(rugged.seq, mu.Africa.mean, col=rangi2)
shade(mu.Africa.PI, rugged.seq, col=col.alpha(rangi2,0.3))

#plot non-African nations with regression
d.A0 <- dd[dd$cont_africa==0,]
plot(log(rgdppc_2000) ~ rugged, data=d.A0,
     col="black", ylab="log GDP year 2000",
     xlab="Terrain Ruggedness Index")
mtext("Non-African Nations", 3)
lines(rugged.seq, mu.NotAfrica.mean)
shade(mu.NotAfrica.PI, rugged.seq)
#+END_SRC

#+RESULTS:
[[file:4.11.png, 411-2.png]]

** 7.1.4 Interpreting an interaction estimate
Two reasons why interpreting interactons from tables can be confusing.
1. When you add an interaction to a model, this changes the meanings of the
   parameters. You cannot compare distributions between model with and without
   interaction effects.
2. Tables don't make it easy to incorporate uncertainty in our thinking. 

*** 7.1.4.1. Parameters change meaning
In regular linear regression model, each slope parameter gives us a direct measure of each
predictor variable's influence. We cannot read the influence of either predictor from the
table of estimates for a model with an interaction effect.

*** 7.1.4.2. Incorporating uncertainty
We can calcuate the \gamma at the MAP level (using posterior means). But we need
distributions of the posterior of gamma to actually compare the uncertainty. We cannot
derive this from a table. 

** 7.2. Symmetry of the linear interaction
   :LOGBOOK:
   CLOCK: [2019-03-14 Thu 10:33]--[2019-03-14 Thu 10:58] =>  0:25
   :END:
Buridan's interaction. > decide between symmetrical interpretation of linear interaction. 
In our mind it is often easier to image one of the two side of the symmetric relationship.

*** 7.2.2. Africa depends upon ruggedness

#+BEGIN_SRC R :results output graphics :file 7.17.png
q.rugged <- range(dd$rugged)

                                        # compute lines and confidence intervals

mu.ruggedlo <- link(m7.5, data=data.frame(rugged=q.rugged[1], cont_africa=0:1))
mu.ruggedlo.mean <- apply(mu.ruggedlo, 2 , mean)
mu.ruggedlo.PI <- apply(mu.ruggedlo, 2, PI)


mu.ruggedhi <- link(m7.5, data=data.frame(rugged=q.rugged[2], cont_africa=0:1))
mu.ruggedhi.mean <- apply(mu.ruggedhi, 2 , mean)
mu.ruggedhi.PI <- apply(mu.ruggedhi, 2, PI)

med.r <- median(dd$rugged)
ox <- ifelse(dd$rugged > med.r, 0.05, -0.05)
plot(dd$cont_africa + ox, log(dd$rgdppc_2000),
     col=ifelse(dd$rugged > med.r, rangi2, "black"),
     xlim=c(-0.25, 1.25), xaxt='n', ylab='log GDP year 2000',
     xlab='Continent')
axis(1, at=c(0,1), labels=c('other', 'africa'))
lines(0:1, mu.ruggedlo.mean, lty=2)
shade(mu.ruggedlo.PI, 0:1)
lines(0:1, mu.ruggedhi.mean, col=rangi2)
shade(mu.ruggedhi.PI, 0:1, col=col.alpha(rangi2,0.25))
#+END_SRC

#+RESULTS:
[[file:7.17.png]]

It is equally true that 
1. the influence of ruggedness depends upon continent
2. the influence of continent depends upon ruggedness

** 7.3. Continous interactions
Interaction effects are difficult to interpret. Nearly impossible only using posterior
means and sd. Interactions among continuous variables are especially opaque. 

Triptych plot -- a way to plot the two-way interaction between two continuous variables.
This example also shows the benefit of centering a variable. 
Two benefits:
1. Centering makes it easier to lean on te coefficients alone in understanding the model,
   especially when comparing interaction estimates.
2. It can improve model fitting. 

Always plot posterior predictions. 

*** 7.3.1. The data
#+BEGIN_SRC R :results output
library(rethinking)
data(tulips)
d <- tulips
str(d)
#+END_SRC

#+RESULTS:
: 
: 'data.frame':	27 obs. of  4 variables:
:  $ bed   : Factor w/ 3 levels "a","b","c": 1 1 1 1 1 1 1 1 1 2 ...
:  $ water : int  1 1 1 2 2 2 3 3 3 1 ...
:  $ shade : int  1 2 3 1 2 3 1 2 3 1 ...
:  $ blooms: num  0 0 111 183.5 59.2 ...

Without a clear mechanistic hypothesis, a simple linear two-way interaction is a good
start. 

*** 7.3.2. The un-centered models
1. The model with both water and shade but no interaction
2. The model with both main effects and the interaction of water with shade. 

#+BEGIN_SRC R

m7.6 <- map(
    alist(
        blooms ~ dnorm(mu, sigma),
        mu <- a + bW * water + bS * shade,
        a ~ dnorm(0, 100),
        bW ~ dnorm(0, 100),
        bS ~ dnorm(0, 100),
        sigma ~ dunif(0, 100)
    ), data=d,
    method="Nelder-Mead",
    control=list(maxit=1e4))

m7.7 <- map(alist(
    blooms ~ dnorm(mu, sigma),
    mu <- a + bW * water + bS * shade + bWS*water*shade,
    a ~ dnorm(0, 100),
    bW ~ dnorm(0, 100),
    bS ~ dnorm(0, 100),
    bWS ~ dnorm(0, 100),
    sigma ~ dunif(0, 100)
), data=d,
method="Nelder-Mead",
control=list(maxit=1e4))

#+END_SRC

#+RESULTS:

#+BEGIN_SRC R
coeftab(m7.6, m7.7)
#+END_SRC

#+RESULTS:

*** 7.3.3. Center and re-estimate
#+BEGIN_SRC R :results output
d$shade.c <- d$shade - mean(d$shade)
d$water.c <- d$water - mean(d$water)

m7.8 <- map(
    alist(
        blooms ~ dnorm(mu, sigma),
        mu <- a + bW * water.c + bS * shade.c,
        a ~ dnorm(130, 100),
        bW ~ dnorm(0, 100),
        bS ~ dnorm(0, 100),
        sigma ~ dunif(0, 100)
    ), data=d,
    start=list(a=mean(d$blooms), bW=0, bS=0, sigma=sd(d$blooms))
               )
m7.9 <- map(alist(
    blooms ~ dnorm(mu, sigma),
    mu <- a + bW * water.c + bS * shade.c + bWS*water.c*shade.c,
    a ~ dnorm(130, 100),
    bW ~ dnorm(0, 100),
    bS ~ dnorm(0, 100),
    bWS ~ dnorm(0, 100),
    sigma ~ dunif(0, 100)
), data=d,
start=list(a=mean(d$blooms), bW=0, bS=0, bWS=0, sigma=sd(d$blooms)) )

coeftab(m7.8, m7.9)
#+END_SRC

#+RESULTS:
: 
:       m7.8    m7.9   
: a      129.00  129.01
: bW      74.22   74.96
: bS     -40.74  -41.14
: sigma   57.35   45.22
: bWS        NA  -51.87
: nobs       27      27

**** 7.3.3.1. Estimation worked better 
With un-centered preictors, the MAP value for \alpha lies a long way from the empirical
mean. 

**** 7.3.3.2. Estimates changes less across models

#+BEGIN_SRC R
precis(m7.9)
#+END_SRC

#+RESULTS:

1. The estimate a is the expected change in blooms when water increases by one and /and/
   shade is at its average vlaue (of zero). 
2. The estimate bW is the expected change in blooms when water increases by one unit /and/
   shade is at its average value (of zero). This estimate suggests that when shade is at
   its average value, increasing water is highly beneficial to blooms.
3. The estimate bS is the expected change in blooms when shade increases by one unit /and/
   water is at its average value (of zero). When water is at its average value, increasing
   shade is highly detrimental to blooms.
4. The estimate bWS is the interaction effect. First, the estimate tells us the expected
   change in the influence of water on blooms when increasing shade by one unit. Second,
   it tells us the expected change in the infleunce of shade on blooms when increasing
   water by one unit. 

*** 7.3.4. Plotting implied predictions. 
Plotting posteriors predictions always tells you what the golem is thinking, on the scale
of the outcome. 

First plot shows the predicted relationship between blooms and shade, holding water
constant at -1. 
Second plot shows same relationship holding water constant at 0.
Third plot holds water constant at 1. 

In each plot only raw data that has the water value appropriate in each case. 

#+BEGIN_SRC R :results output graphics :file 7.28.png
# make a plot window with three panels in a row
par(mfrow=c(1,3)) #1 row, 3 cols

                                        # loop over values of water.c and plot predictions
shade.seq <- -1:1
for (w in -1: 1) {
    dt <- d[d$water.c==w,]
    plot(blooms ~ shade.c, data=dt, col=rangi2,
         main=paste("water.c = ", w), xaxp=c(-1,1,2), ylim=c(0,362),
         xlab="shade (centered)")
    mu <- link(m7.9, data=data.frame(water.c=w, shade.c=shade.seq))
    mu.mean <- apply(mu, 2, mean)
    mu.PI <- apply(mu, 2, PI, prob=.97)
    lines(shade.seq, mu.mean)
    lines(shade.seq, mu.PI[1,], lty=2)
    lines(shade.seq, mu.PI[2,], lty=2)
}
#+END_SRC

#+RESULTS:
[[file:7.28.png]]

Tulips need both water and light to produce blooms. At low water levels, shade can't have
much of an effect, at higher levels there is a strong relationship between the two. 


** 7.4. Interactions in design formulas
#+BEGIN_SRC R
m7.x <- lm(y ~ x + z + x*z, data=d)

#+END_SRC

** 7.6. Practice

*** 7E1
1. temperature
2. Age
3. Key in ignition

*** 7E2
1. Interaction between onions drying out and the temperature on the caramelization process
2. No interaction between cylinders and fuel injector
3. Interaction (most) getting from parents or getting from friends. 
4. Interaction between sociability and the number of appendages. 

*** 7E3
1. \mu = \beta_i * heat + \beta_d * dryness + \beta_i_d * heat * dryness
2. \mu = \beta_c * no_cylinders + \beta_i * fuelinjector 
3. \mu = \beta_b1 * parents + \beta_b2 * friends + \beta_b1_b2 * friends * parents
4. \mu = \beta_s * sociability + beta_a * appendages + b_s_a * sociability * appendages

*** 7M1
There might be an interaction effect between temperature, shade, and water, as well as
water and shade, water and temperature, and temperature and shade. 

*** 7M2
\mu = \alpha + \beta_w * W_i + \beta_s * S_i + \beta_t * T_i + \beta_w_s_t * (W_i * S_i *
T_i) + \beta_w_s * (W_i * S_i) + beta_w_t * (W_i * T_i) + beta_t_s (T_i * S_i)

Figure out when effect of temperature is hot negates other effects. 

*** 7M3
Amount of food consumed ravens and number of wolves in an area

Without wolves, ravens would not have food, but with addition of wolves this would
increase, the effect however is not linear as the first step makes huge dent but this
effect decreases as number of wolves increases. 

*** 7H1
#+BEGIN_SRC R :results output
data(tulips)
d <- tulips

d$water.c <- d$water - mean(d$water)
d$shade.c <- d$shade - mean(d$shade)
d$bed.id <- coerce_index(d$bed)


m_7h1 <- map(
    alist(
        blooms ~ dnorm(mu, sigma),
        mu <- a[bed.id] + bW*water.c + bS*shade.c + bWS*water.c*shade.c,
        a[bed.id] ~ dnorm(130, 100),
        bW ~ dnorm(0, 100),
        bS ~ dnorm(0, 100),
        bWS ~ dnorm(0, 100),
        sigma ~ dunif(0, 150)
    ),
    data = d,
    start=list(a=mean(d$blooms), bW=0, bS=0, bWS=0, sigma=sd(d$blooms)))

precis(m_7h1, depth=2)   
#+END_SRC

#+RESULTS:
: 
:         Mean StdDev   5.5%  94.5%
: a[1]   97.77  12.95  77.07 118.47
: a[2]  142.49  12.95 121.79 163.18
: a[3]  147.02  12.95 126.33 167.72
: bW     75.19   9.20  60.49  89.88
: bS    -41.26   9.20 -55.96 -26.57
: bWS   -52.19  11.24 -70.15 -34.22
: sigma  39.18   5.33  30.66  47.70

*** 7h2
#+BEGIN_SRC R :results output

m_7h2 <- map(
    alist(
        blooms ~ dnorm(mu, sigma),
        mu <- a + bW*water.c + bS*shade.c + bWS*water.c*shade.c,
        a ~ dnorm(130, 100),
        bW ~ dnorm(0, 100),
        bS ~ dnorm(0, 100),
        bWS ~ dnorm(0, 100),
        sigma ~ dunif(0, 100)
    ),
    data = d,
    start=list(a=mean(d$blooms), bW=0, bS=0, bWS=0, sigma=sd(d$blooms)))

compare(m_7h1, m_7h2)

#+END_SRC

#+RESULTS:
: 
:        WAIC pWAIC dWAIC weight    SE  dSE
: m_7h2 295.9   6.5   0.0   0.81 10.32   NA
: m_7h1 298.8  11.8   2.9   0.19 11.18 8.71

The model without bed variable had better WAI score and .78 percent of the weight. A lot of
variation in the coefficients related to bed. 

#+BEGIN_SRC R :results output graphics :file 7h2.png
post <- extract.samples(m_7h1)
post.a <- post$a[,1]
post.b <- post$a[,2]
post.c <- post$a[,3]
dens(post.a, col = "red", xlim = c(50, 200), ylim = c(0, 0.035))
dens(post.b, col = "blue", add = TRUE)
dens(post.c, col = "black", add = TRUE)

#+END_SRC

#+RESULTS:
[[file:7h2.png]]

*** 7H3_a
#+BEGIN_SRC R :results output 
data(rugged)
d <- rugged
d <- d[complete.cases(d$rgdppc_2000), ]
d$log_gdp <- log(d$rgdppc_2000)
d_without_seychelles <- dd[dd$country != "Seychelles", ]

m_with <- map(alist(
    log_gdp ~ dnorm(mu, sigma),
    mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
    a ~ dnorm(8, 100),
    bA ~ dnorm(0, 1),
    bR ~ dnorm(0, 1),
    bAR ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
), data= d)


m_without <- map(alist(
    log_gdp ~ dnorm(mu, sigma),
    mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa,
    a ~ dnorm(8, 100),
    bA ~ dnorm(0, 1),
    bR ~ dnorm(0, 1),
    bAR ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
), data= d_without_seychelles)

coeftab(m_with, m_without)

#+END_SRC

#+RESULTS:
:       m_with  m_without
: a        9.18    9.19  
: bA      -1.85   -1.78  
: bR      -0.18   -0.19  
: bAR      0.35    0.25  
: sigma    0.93    0.93  
: nobs      170     169

Removing Seychelles has little effect on the effect of ruggedness (bR). However, there
seems to be an interaction between as expressed by bAR. 

*** 7h3_b

#+BEGIN_SRC R :results output graphics :file 7h3_b.png
par(mfrow = c(2, 2))
rugged.seq <- seq(from=-1, to=8, by=0.25)

#prediction with seychelles
mu.Africa <- link(m_with, data=data.frame(cont_africa=1, rugged=rugged.seq))
mu.Africa.mean <- apply(mu.Africa, 2, mean)
mu.Africa.PI <- apply(mu.Africa, 2, PI, prob=.97)


mu.NotAfrica <- link(m_with, data=data.frame(cont_africa=0, rugged=rugged.seq))
mu.NotAfrica.mean <- apply(mu.NotAfrica, 2, mean)
mu.NotAfrica.PI <- apply(mu.NotAfrica, 2, PI, prob=.97)


#plot 
d.A1 <- d[d$cont_africa==1, ]
plot(log_gdp ~ rugged, data = d.A1, col = rangi2)
mtext("African nations, with Seychelles", 3)
lines(rugged.seq, mu.Africa.mean, col=rangi2)
shade(mu.Africa.PI, rugged.seq, col=col.alpha(rangi2,0.3))


#plot 
d.A0 <- d[d$cont_africa==0, ]
plot(log_gdp ~ rugged, data = d.A0, col = rangi2)
mtext("Non-African nations, with Seychelles", 3)
lines(rugged.seq, mu.NotAfrica.mean, col=rangi2)
shade(mu.NotAfrica.PI, rugged.seq, col=col.alpha(rangi2,0.3))


#prediction without seychelles
mu.Africa <- link(m_without, data=data.frame(cont_africa=1, rugged=rugged.seq))
mu.Africa.mean <- apply(mu.Africa, 2, mean)
mu.Africa.PI <- apply(mu.Africa, 2, PI, prob=.97)


mu.NotAfrica <- link(m_without, data=data.frame(cont_africa=0, rugged=rugged.seq))
mu.NotAfrica.mean <- apply(mu.NotAfrica, 2, mean)
mu.NotAfrica.PI <- apply(mu.NotAfrica, 2, PI, prob=.97)

#plot 
d.A1 <- d_without_seychelles[d_without_seychelles$cont_africa==1, ]
plot(log_gdp ~ rugged, data = d.A1, col = rangi2)
mtext("African nations, without Seychelles", 3)
lines(rugged.seq, mu.Africa.mean, col=rangi2)
shade(mu.Africa.PI, rugged.seq, col=col.alpha(rangi2,0.3))


#plot 
d.A0 <- d_without_seychelles[d_without_seychelles$cont_africa==0, ]
plot(log_gdp ~ rugged, data = d.A0, col = rangi2)
mtext("African nations, without Seychelles", 3)
lines(rugged.seq, mu.NotAfrica.mean, col=rangi2)
shade(mu.NotAfrica.PI, rugged.seq, col=col.alpha(rangi2,0.3))


#+END_SRC

#+RESULTS:
[[file:7h3_b.png]]

The slope is not as steep in african nation without Seychelles, and there is also more
uncertainty on higher values or ruggedness. However, these plots do not give info on
interaction. Wrong approach

#+BEGIN_SRC R :results output graphics :file 7h3_triptych_with.png
d$rugged.c = d$rugged - mean(d$rugged)

par(mfrow=c(1,2))

for (africa_yes in 0:1) {
    dt <- d[d$cont_africa==africa_yes,]
    plot(log_gdp ~ rugged, data=dt, col=rangi2,
         main=paste("cont_africa =", africa_yes), xlim=c(0,8), ylim=c(6,10), xlab="rugged (centered)")
    mu <- link(m_with, data=data.frame(cont_africa=africa_yes, rugged=rugged.seq))
    mu.mean <- apply(mu, 2, mean)
    mu.PI <- apply(mu, 2, PI, prob=.97)
    lines(rugged.seq, mu.mean)
    lines(rugged.seq, mu.PI[1,], lty=2)
    lines(rugged.seq, mu.PI[2,], lty=2)
}

#+END_SRC

#+RESULTS:
[[file:7h3_triptych_with.png]]


#+BEGIN_SRC R :results output graphics :file 7h3_triptych_without.png
d_without_seychelles$rugged.c = d_without_seychelles$rugged - mean(d_without_seychelles$rugged)

par(mfrow=c(1,2))

for (africa_yes in 0:1) {
    dt <- d_without_seychelles[d_without_seychelles$cont_africa==africa_yes,]
    plot(log_gdp ~ rugged, data=dt, col=rangi2,
         main=paste("cont_africa =", africa_yes), xlim=c(0,8), ylim=c(6,10), xlab="rugged (centered)")
    mu <- link(m_without, data=data.frame(cont_africa=africa_yes, rugged=rugged.seq))
    mu.mean <- apply(mu, 2, mean)
    mu.PI <- apply(mu, 2, PI, prob=.97)
    lines(rugged.seq, mu.mean)
    lines(rugged.seq, mu.PI[1,], lty=2)
    lines(rugged.seq, mu.PI[2,], lty=2)
}

#+END_SRC

#+RESULTS:
[[file:7h3_triptych_without.png]]

Rugged and gdp are in a negative relationship when cont_Africa=0 and positive
when 1. However, without seychelles, the slope for cont-africa=1 decreases markedly. So
Seychelles pushed the relationship upwards. You also see this in other graph. 

bAR for coef(m_with) = 0.35
bAR for coef(m_without) = 0.25

#+BEGIN_SRC R :results output


#+END_SRC
#+BEGIN_SRC R :results output

m_without_1 <- map(alist(
    log_gdp ~ dnorm(mu, sigma),
    mu <- a + bR*rugged,
    a ~ dnorm(8, 100),
    bR ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
), data= dd_without_seychelles)


m_without_2 <- map(alist(
    log_gdp ~ dnorm(mu, sigma),
    mu <- a + bA*cont_africa + bR * rugged,
    a ~ dnorm(8, 100),
    bA ~ dnorm(0, 1),
    bR ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
), data= dd_without_seychelles)


m_without_3 <- map(alist(
    log_gdp ~ dnorm(mu, sigma),
    mu <- a + bA * cont_africa + bR*rugged + bAR*rugged*cont_africa,
    a ~ dnorm(8, 100),
    bA ~ dnorm(0, 1),
    bR ~ dnorm(0, 1),
    bAR ~ dnorm(0, 1),
    sigma ~ dunif(0, 10)
), data= dd_without_seychelles)


compare(m_without_1, m_without_2, m_without_3)


#+END_SRC

#+RESULTS:
: 
:              WAIC pWAIC dWAIC weight    SE   dSE
: m_without_3 463.3   4.6   0.0   0.81 15.04    NA
: m_without_2 466.3   4.0   3.0   0.19 14.24  3.38
: m_without_1 536.5   2.8  73.2   0.00 13.36 15.30

Model 3 has best WAIC score with .79 of the weight. 

#+BEGIN_SRC R :results output graphics :file 7h3_c.png
rugged.seq <- seq(from=-1, to=8, by=0.25)

d.predict <- list(
    log_gdp = rep(0, length(rugged.seq)),
    rugged = rugged.seq,
    cont_africa = rep(1, length(rugged.seq))
)

m_without_ensemble <- ensemble(m_without_1, m_without_2, m_without_3, data=d.predict)

mu <- apply(m_without_ensemble$link, 2, mean)
mu.PI <- apply(m_without_ensemble$link, 2, PI, prob=.97)

plot(log_gdp ~ rugged, data = d.A1, col=rangi2)

lines(rugged.seq, mu)
lines(rugged.seq, mu.PI[1,], lty=2)
lines(rugged.seq, mu.PI[2,], lty=2)


#+END_SRC

#+RESULTS:
[[file:7h3_c.png]]

*** 7H4
#+BEGIN_SRC R

data(nettle)
d <- nettle

d$lang.per.cap <- d$num.lang / d$k.pop
d$log.lang.per.cap <- log(d$lang.per.cap)

d$log.area <- log(d$area)
d$log.area.c <- d$log.area - mean(d$log.area)

d$density <- d$k.pop / d$area
d$log.density <- log(d$density)
d$log.density.c <- d$log.density - mean(d$log.density)

d$mean.growing.season.c <- d$mean.growing.season - mean(d$mean.growing.season)
d$sd.growing.season.c <- d$sd.growing.season - mean(d$sd.growing.season)
#+END_SRC

#+RESULTS:
|    0.590810810810811 |
|    0.170810810810811 |
|     2.47081081081081 |
|   -0.969189189189189 |
|   -0.709189189189189 |
|    0.800810810810811 |
| -0.00918918918918932 |
|     4.17081081081081 |
|   -0.629189189189189 |
|   -0.489189189189189 |
|    -1.19918918918919 |
|   0.0508108108108107 |
|    0.110810810810811 |
|   -0.329189189189189 |
| -0.00918918918918932 |
|   0.0808108108108108 |
| -0.00918918918918932 |
|   -0.149189189189189 |
|     1.77081081081081 |
|   -0.809189189189189 |
|     1.40081081081081 |
|   -0.899189189189189 |
|   -0.929189189189189 |
|  -0.0191891891891893 |
|    0.530810810810811 |
|   -0.479189189189189 |
|   -0.479189189189189 |
|    0.830810810810811 |
|    0.220810810810811 |
|    0.120810810810811 |
|     1.91081081081081 |
|    -1.34918918918919 |
|   -0.859189189189189 |
|  -0.0991891891891892 |
|     1.26081081081081 |
|   -0.199189189189189 |
|    -1.32918918918919 |
|    0.270810810810811 |
|   -0.869189189189189 |
|    0.990810810810811 |
|   -0.309189189189189 |
|    0.280810810810811 |
|    0.190810810810811 |
|    0.280810810810811 |
|    0.450810810810811 |
|   -0.419189189189189 |
|    0.460810810810811 |
|    -1.69918918918919 |
|   -0.949189189189189 |
|    0.260810810810811 |
|    0.810810810810811 |
|     2.52081081081081 |
|    0.220810810810811 |
|   -0.779189189189189 |
|   -0.589189189189189 |
|    -1.10918918918919 |
|    -1.69918918918919 |
| -0.00918918918918932 |
|     1.80081081081081 |
|    0.890810810810811 |
|     1.12081081081081 |
|    -1.69918918918919 |
|    0.200810810810811 |
|   -0.129189189189189 |
|   0.0808108108108108 |
|    -1.00918918918919 |
|   -0.529189189189189 |
|    -1.69918918918919 |
|     1.03081081081081 |
|   -0.109189189189189 |
|    -1.69918918918919 |
|    0.200810810810811 |
|    -1.02918918918919 |
|   -0.269189189189189 |
**** A
Hypothesis: log(lang.per.cap) is positively associated with the average length of the
mean.growing.season. Use log(area) as a covariate not an interaction

#+BEGIN_SRC R :results output


m_with <- map(
    alist(
        log.lang.per.cap ~ dnorm(mu,sigma),
        mu <- a + bS * mean.growing.season.c + bA * log.area.c,
        a ~ dnorm(-10, 10),
        bS ~ dnorm(0, 10),
        bA ~ dnorm(-10, 10),
        sigma ~ dunif(0, 10)
),
        data=d)

m_without <- map(
    alist(
        log.lang.per.cap ~ dnorm(mu,sigma),
        mu <- a + bS * mean.growing.season.c,
        a ~ dnorm(-10, 10),
        bS ~ dnorm(0, 10),
        sigma ~ dunif(0, 10)
),
        data=d)

coeftab(m_with, m_without)

#+END_SRC

#+RESULTS:
: 
:       m_with  m_without
: a       -5.46   -5.46  
: bS       0.14    0.17  
: bA       -0.2      NA  
: sigma    1.39    1.41  
: nobs       74      74


#+BEGIN_SRC R :results output graphics :file a_with_area.png

growing.seq <- seq(from = -8, to=8, by=0.25)
mu <- link(m_with, data=data.frame(mean.growing.season.c=growing.seq, log.area.c=0))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=.97)

plot(log.lang.per.cap ~ mean.growing.season.c, data=d, col=rangi2)
mtext("with area", 3)
lines(growing.seq, mu.mean)
shade(mu.PI, growing.seq, col=col.alpha(rangi2, 0.3))

#+END_SRC

#+RESULTS:
[[file:a_with_area.png]]

#+BEGIN_SRC R :results output graphics :file a_without_area.png

growing.seq <- seq(from = -8, to=8, by=0.25)
mu <- link(m_without, data=data.frame(mean.growing.season.c=growing.seq))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=.97)

plot(log.lang.per.cap ~ mean.growing.season.c, data=d, col=rangi2)
mtext("without area", 3)
lines(growing.seq, mu.mean)
shade(mu.PI, growing.seq, col=col.alpha(rangi2, 0.3))


#+END_SRC

#+RESULTS:
[[file:a_without_area.png]]

There is indeed a positive relationhip between length of growing season and number of
languages. Incuding area makes the relationship not as strong, slope decreases.

#+BEGIN_SRC R :results output
compare(m_with, m_without)

#+END_SRC

#+RESULTS:
:            WAIC pWAIC dWAIC weight    SE  dSE
: m_without 268.2   3.9   0.0   0.61 15.40   NA
: m_with    269.1   5.4   0.9   0.39 16.12 3.76
 
WAIC prefers model without area. 

**** B
Hypothesis is that language diversity is negatively associated with sd.growing.season

#+BEGIN_SRC R :results output

mb_with <- map(
    alist(
        log.lang.per.cap ~ dnorm(mu,sigma),
        mu <- a + bSD * sd.growing.season.c + bA * log.area.c,
        a ~ dnorm(-10, 10),
        bA ~ dnorm(-10, 10),
        bSD ~ dnorm(-10, 10),
        sigma ~ dunif(0, 10)
),
        data=d)

mb_without <- map(
    alist(
        log.lang.per.cap ~ dnorm(mu,sigma),
        mu <- a + bSD * sd.growing.season.c,
        a ~ dnorm(-10, 10),
        bSD ~ dnorm(-10, 10),
        sigma ~ dunif(0, 10)
),
        data=d)

coeftab(mb_with, mb_without)
#+END_SRC

#+RESULTS:
: 
:       mb_with mb_without
: a       -5.46   -5.46   
: bA      -0.24      NA   
: bSD     -0.21   -0.36   
: sigma    1.44    1.46   
: nobs       74      74

The SD of growing season indeed has a negative effect (-0.21, -0.36). The role of area increased
slightly after including SD.


#+BEGIN_SRC R :results output
compare(mb_with, mb_without)

#+END_SRC

#+RESULTS:
:             WAIC pWAIC dWAIC weight    SE  dSE
: mb_without 273.8   4.1   0.0    0.6 17.15   NA
: mb_with    274.6   5.8   0.8    0.4 17.32 3.97


More weight assigned to model without area, although difference is slight.


#+BEGIN_SRC R :results output graphics :file b_with_area.png

growing.seq <- seq(from = -8, to=8, by=0.25)
mu <- link(mb_with, data=data.frame(sd.growing.season.c=growing.seq, log.area.c=0))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=.97)

plot(log.lang.per.cap ~ sd.growing.season.c, data=d, col=rangi2)
mtext("with area", 3)
lines(growing.seq, mu.mean)
shade(mu.PI, growing.seq, col=col.alpha(rangi2, 0.3))

#+END_SRC

#+RESULTS:
[[file:b_with_area.png]]

#+BEGIN_SRC R :results output graphics :file b_without_area.png

growing.seq <- seq(from = -8, to=8, by=0.25)
mu <- link(mb_without, data=data.frame(sd.growing.season.c=growing.seq))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=.97)

plot(log.lang.per.cap ~ sd.growing.season.c, data=d, col=rangi2)
mtext("without area", 3)
lines(growing.seq, mu.mean)
shade(mu.PI, growing.seq, col=col.alpha(rangi2, 0.3))


#+END_SRC

#+RESULTS:
[[file:b_without_area.png]]

Effect of including area is greater, also more uncertainty on high SD in growing season. 
However, the akaike weighting is quite similar. Model averaging

#+BEGIN_SRC R :results output graphics :file ensemble.png

d.predict <- list(
  log.lang.per.cap = rep(0, length(growing.seq)),
  sd.growing.season.c = growing.seq,
  log.area.c = rep(0, length(growing.seq))
)
mb_ensemble <- ensemble(mb_without, mb_with, data = d.predict)

mu <- apply(mb_ensemble$link, 2, mean)
mu.PI <- apply(mb_ensemble$link, 2, PI, prob = 0.97)
plot(log.lang.per.cap ~ sd.growing.season.c, data = d, col = rangi2)
lines(growing.seq, mu)
shade(mu.PI, growing.seq)

#+END_SRC

#+RESULTS:
[[file:ensemble.png]]

This still indicates a negative slope between sd.growing season and languages. However,
the error intervals is large and there could also be an almost flat slope. 

**** C
Hypothesis mean.growing.season and sd.growing.season interact to reduce language
diversity. Longer seasons and high variance makes storage even more distribution > people
have to cooperate and thus fewer languages. 

#+BEGIN_SRC R

mc <- map(
    alist(
        log.lang.per.cap ~ dnorm(mu,sigma),
        mu <- a + bSD * sd.growing.season.c + bS * mean.growing.season.c + bSD_S * sd.growing.season.c * mean.growing.season.c,
        a ~ dnorm(-10, 10),
        bS ~ dnorm(-10, 10),
        bSD ~ dnorm(-10, 10),
        bSD_S ~ dnorm(-10, 10),
        sigma ~ dunif(0, 10)
),
        data=d)

#+END_SRC

#+RESULTS:

#+BEGIN_SRC R :results output graphics :file c-1.png

d$mean.growing.season.group <- cut(
  d$mean.growing.season.c, 
  breaks = quantile(d$mean.growing.season.c, probs = c(0, 1/3, 2/3, 1)),
  include.lowest = TRUE, 
  dig.lab = 2
)
d$sd.growing.season.group <- cut(
  d$sd.growing.season.c, 
  breaks = quantile(d$sd.growing.season.c, probs = c(0, 1/3, 2/3, 1)),
  include.lowest = TRUE, 
  dig.lab = 2
)

par(mfrow = c(2, 3))

mean.growing.seq <- seq(from=-10, to=10, by=0.25)
sd.growing.seq <- seq(from=-10, to=10, by=0.25)

#Iterate over mean

for (group in levels(d$mean.growing.season.group)) {
    dt <- d[d$mean.growing.season.group == group, ]
    plot(log.lang.per.cap ~ sd.growing.season.c, data=dt, col=rangi2, xlim=c(-5, 5), ylim=c(-10,2),
         main=paste("Mean Group:", group), xlab="SD growing season")
    mu <- link(mc, data=data.frame(sd.growing.season.c = sd.growing.seq, mean.growing.season.c = mean(dt$mean.growing.season.c)))
    mu.mean <- apply(mu, 2 ,mean)
    mu.PI <- apply(mu, 2, PI, prob=.97)
    lines(mean.growing.seq, mu.mean)
    lines(mean.growing.seq, mu.PI[1,], lty=2)
    lines(mean.growing.seq, mu.PI[2,], lty=2)
}
#+END_SRC

#+RESULTS:
[[file:c-1.png]]

#+BEGIN_SRC R :results output graphics :file c-2.png

#Iterate over sd

par(mfrow = c(2,3))

for (group in levels(d$sd.growing.season.group)) {
    dt <- d[d$sd.growing.season.group == group, ]
    plot(log.lang.per.cap ~ mean.growing.season.c, data=dt, col=rangi2, xlim=c(-5, 5), ylim=c(-10,2),
         main=paste("SD Group:", group), xlab="Mean growing season")
    mu <- link(mc, data=data.frame(mean.growing.season.c = mean.growing.seq, sd.growing.season.c = mean(dt$sd.growing.season.c)))
    mu.mean <- apply(mu, 2 ,mean)
    mu.PI <- apply(mu, 2, PI, prob=.97)
    lines(sd.growing.seq, mu.mean)
    lines(sd.growing.seq, mu.PI[1,], lty=2)
    lines(sd.growing.seq, mu.PI[2,], lty=2)
}

#+END_SRC

#+RESULTS:
[[file:c-2.png]]

Relationship is more positive with smaller variance in growing season. So more growing
season is more language. When variance growing the infleunce of length of season is much
smaller. (c-2). If the length of growing season is larger than variance has bigger impact
(negative). The last triptych.
